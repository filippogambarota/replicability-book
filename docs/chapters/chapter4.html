<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Statistical methods for replication assessment – The three Rs of trustworthy science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter5.html" rel="next">
<link href="../chapters/chapter3.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d536d1a7baed4b06fb80168836a8c311.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/chapter4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">The three Rs of trustworthy science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/filippogambarota/replicability-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is a replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Replicability and reproducibility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability of Replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Improving study robustness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Planning a replication study</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#how-to-assess-the-replication-outcome" id="toc-how-to-assess-the-replication-outcome" class="nav-link active" data-scroll-target="#how-to-assess-the-replication-outcome"><span class="header-section-number">4.1</span> How to assess the replication outcome?</a></li>
  <li><a href="#replication-studies-as-meta-analysis" id="toc-replication-studies-as-meta-analysis" class="nav-link" data-scroll-target="#replication-studies-as-meta-analysis"><span class="header-section-number">4.2</span> Replication studies as meta-analysis</a></li>
  <li><a href="#simulating-data" id="toc-simulating-data" class="nav-link" data-scroll-target="#simulating-data"><span class="header-section-number">4.3</span> Simulating data</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">4.4</span> Methods</a></li>
  <li><a href="#vote-counting-based-on-significance-or-direction" id="toc-vote-counting-based-on-significance-or-direction" class="nav-link" data-scroll-target="#vote-counting-based-on-significance-or-direction"><span class="header-section-number">4.5</span> Vote Counting based on significance or direction</a></li>
  <li>
<a href="#confidenceprediction-interval-methods" id="toc-confidenceprediction-interval-methods" class="nav-link" data-scroll-target="#confidenceprediction-interval-methods"><span class="header-section-number">4.6</span> Confidence/prediction interval methods</a>
  <ul class="collapse">
<li><a href="#replication-effect-within-the-original-ci" id="toc-replication-effect-within-the-original-ci" class="nav-link" data-scroll-target="#replication-effect-within-the-original-ci"><span class="header-section-number">4.6.1</span> Replication effect within the original CI</a></li>
  <li><a href="#original-study-within-replication-ci" id="toc-original-study-within-replication-ci" class="nav-link" data-scroll-target="#original-study-within-replication-ci"><span class="header-section-number">4.6.2</span> Original study within replication CI</a></li>
  </ul>
</li>
  <li><a href="#prediction-interval-pi" id="toc-prediction-interval-pi" class="nav-link" data-scroll-target="#prediction-interval-pi"><span class="header-section-number">4.7</span> Prediction interval PI</a></li>
  <li>
<a href="#mathur-vanderweele--mathur2020-nw-p_orig" id="toc-mathur-vanderweele--mathur2020-nw-p_orig" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-p_orig"><span class="header-section-number">4.8</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(p_{orig}\)</span></a>
  <ul class="collapse">
<li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation"><span class="header-section-number">4.8.1</span> Simulation</a></li>
  <li><a href="#mathur-vanderweele--mathur2020-nw-hat-p_-0" id="toc-mathur-vanderweele--mathur2020-nw-hat-p_-0" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-hat-p_-0"><span class="header-section-number">4.8.2</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(\hat P_{&gt; 0}\)</span></a></li>
  <li><a href="#mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" id="toc-mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q"><span class="header-section-number">4.8.3</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(\hat P_{\gtrless q*}\)</span></a></li>
  </ul>
</li>
  <li>
<a href="#meta-analytic-methods" id="toc-meta-analytic-methods" class="nav-link" data-scroll-target="#meta-analytic-methods"><span class="header-section-number">4.9</span> Meta-analytic methods</a>
  <ul class="collapse">
<li><a href="#fixed-effects-model" id="toc-fixed-effects-model" class="nav-link" data-scroll-target="#fixed-effects-model"><span class="header-section-number">4.9.1</span> Fixed-effects Model</a></li>
  <li><a href="#random-effects-model" id="toc-random-effects-model" class="nav-link" data-scroll-target="#random-effects-model"><span class="header-section-number">4.9.2</span> Random-Effects model</a></li>
  <li><a href="#pooling-replications" id="toc-pooling-replications" class="nav-link" data-scroll-target="#pooling-replications"><span class="header-section-number">4.9.3</span> Pooling replications</a></li>
  <li><a href="#the-q-statistic" id="toc-the-q-statistic" class="nav-link" data-scroll-target="#the-q-statistic"><span class="header-section-number">4.9.4</span> The Q Statistic</a></li>
  </ul>
</li>
  <li><a href="#small-telescopes-simonsohn2015-kg" id="toc-small-telescopes-simonsohn2015-kg" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg"><span class="header-section-number">4.10</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  <li>
<a href="#replication-bayes-factor" id="toc-replication-bayes-factor" class="nav-link" data-scroll-target="#replication-bayes-factor"><span class="header-section-number">4.11</span> Replication Bayes factor</a>
  <ul class="collapse">
<li><a href="#bayesian-inference" id="toc-bayesian-inference" class="nav-link" data-scroll-target="#bayesian-inference"><span class="header-section-number">4.11.1</span> Bayesian inference</a></li>
  <li><a href="#calculating-the-bayes-factor-using-the-sdr" id="toc-calculating-the-bayes-factor-using-the-sdr" class="nav-link" data-scroll-target="#calculating-the-bayes-factor-using-the-sdr"><span class="header-section-number">4.11.2</span> Calculating the Bayes Factor using the SDR</a></li>
  <li><a href="#verhagen2014-tx-model" id="toc-verhagen2014-tx-model" class="nav-link" data-scroll-target="#verhagen2014-tx-model"><span class="header-section-number">4.11.3</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (2014)</span> model</a></li>
  </ul>
</li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">4.12</span> Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/filippogambarota/replicability-book/edit/main/chapters/chapter4.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/filippogambarota/replicability-book/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-statmethodrep" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="how-to-assess-the-replication-outcome" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="how-to-assess-the-replication-outcome">
<span class="header-section-number">4.1</span> How to assess the replication outcome?</h2>
<p>In earlier chapters, we introduced the concept of replication from both statistical and theoretical perspectives. We now focus on analyzing the outcomes of replication experiments. Just as there are many definitions of replication, there are also multiple ways of assessing the outcomes of replication studies.</p>
<p>Much of the discussion will focus on replication metrics, which is a burgeoning area of statistics. <span class="citation" data-cites="Heyard2024-hv">Heyard et al. (<a href="#ref-Heyard2024-hv" role="doc-biblioref">2024</a>)</span> published an extensive systematic review, supported by an online catalog. They also maintain an up-to-date database with more than 50 replication measures organized and classified according to a common scheme.</p>
<p>The database is available at the following link <a href="http://rachelheyard.com/reproducibility_metrics/">http://rachelheyard.com/reproducibility_metrics/</a>. Here, we have selected methods from the database, according to the following criteria:</p>
<ul>
<li>we have included methods not only for answering the question <em>“Has a study been replicated?”</em>, but also methods which instead combine evidence and estimate the size of the effect</li>
<li>we have selected methods that are not linked to a specific research area or topic. (Some methods are specific for a given area of research or type of experiment such as replicating fMRI studies at the voxel level.)</li>
<li>we have included both bayesian and frequentist approaches</li>
<li>where methods are very similar, we have focused on the most recent or general version</li>
</ul>
<p>In general, choosing a single “measure of replicability” is probably not the best approach Typically, large-scale replication projects <span class="citation" data-cites="Collaboration2015-ep Errington2021-fb The-Brazilian-Reproducibility-Initiative2025-iw">(e.g., <a href="#ref-Collaboration2015-ep" role="doc-biblioref">Collaboration &amp; Open Science Collaboration, 2015</a>; <a href="#ref-Errington2021-fb" role="doc-biblioref">Errington et al., 2021</a>; <a href="#ref-The-Brazilian-Reproducibility-Initiative2025-iw" role="doc-biblioref">The Brazilian Reproducibility Initiative et al., 2025</a>)</span> evaluate results across different metrics.</p>
</section><section id="replication-studies-as-meta-analysis" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="replication-studies-as-meta-analysis">
<span class="header-section-number">4.2</span> Replication studies as meta-analysis</h2>
<p><span class="citation" data-cites="Hedges2019-ry">Hedges &amp; Schauer (<a href="#ref-Hedges2019-ry" role="doc-biblioref">2019c</a>)</span> point out that replication studies can be seen — from a statistical point of view — as meta-analyses. Typically, there is a single initial study and one or more attempts to replicate its initial findings. For the simple one-to-one replication design we have a meta-analysis with two studies while in the one-to-many design we have a meta-analysis with <span class="math inline">\(R\)</span> studies. When it comes to evaluating the results of replication studies, we can choose between several methods <span class="citation" data-cites="Heyard2024-hv">(see <a href="#ref-Heyard2024-hv" role="doc-biblioref">Heyard et al., 2024</a>)</span>. Some of these methods will explictly involve meta-analyses, which pool evidence from original and replication studies. While we consider meta-analytic thinking to be crucial for understanding replication, not all methods are (strictly speaking) meta-analyses in the usual sense.</p>
<p>Specifically, the methodology of the initial and/or replication studies is important when it comes to evaluating a single result. However, at the aggregate level, we evaluate how a certain focal parameter (e.g., the difference between two groups or conditions) varies across replications with an eye toward determining whether there is evidence — whatever the criterion — for a successful replication. In this sense, whatever model happens to be used in the original study, we can (without loss of generality) fruitfully model the situation from the aggregative perspective.</p>
</section><section id="simulating-data" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="simulating-data">
<span class="header-section-number">4.3</span> Simulating data</h2>
<p>While real-world examples are important, simulating simplified examples (“toy models”) is useful for understanding replication methods from a statistical point of view. Indeed, in general, simulating data is an important technique for teaching and understanding statistical methods <span class="citation" data-cites="Hardin2015-ss">(<a href="#ref-Hardin2015-ss" role="doc-biblioref">Hardin et al., 2015</a>)</span>. Moreover, in practice, Monte Carlo simulations are necessary for estimating statistical properties (e.g., statistical power or type-1 error rate) of complex models.</p>
<p>For our simulated examples, we adpot the following methodological assumptions:</p>
<ul>
<li>primary studies always compare two independent groups on a certain response variable</li>
<li>within a study, the two groups are assumed to come from two normal distributions with unit variance. For one group <span class="math inline">\(y_0\)</span> the mean is zero and for the other group <span class="math inline">\(y_1\)</span> the mean is the value representing the effect size <span class="math inline">\(\theta_r\)</span> for that specific study.</li>
<li>the sample size can vary between the two groups</li>
</ul>
<p>For example we can simulate a single study:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="va">n0</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">theta</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span> <span class="co"># this is the effect size</span></span>
<span><span class="co">## [1] 0.6266234</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span> <span class="co"># this is the sampling variability</span></span>
<span><span class="co">## [1] 0.07565714</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y0</span>, <span class="va">y1</span><span class="op">)</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n0</span>, <span class="va">n1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dd</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we can simply iterate the process for <span class="math inline">\(R\)</span> studies to create a series of replications with a common true parameter <span class="math inline">\(\mu_{\theta}\)</span>. We can also generate a set of different sample sizes by sampling from a probability distribution (e.g., Poisson). Then, if we want to include variability in the true effects (as would be expected in the case of <em>extensions</em> of an experinent), we can sample <span class="math inline">\(R\)</span> effects from, say, a normal distribution with variance <span class="math inline">\(\tau^2\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># average true effect</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># heterogeneity</span></span>
<span><span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">mu</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="co"># true effects for R studies</span></span>
<span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">n0</span> <span class="op">&lt;-</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">R</span>, <span class="fl">40</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">deltai</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span></span>
<span>    <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span>, <span class="va">yi</span>, <span class="va">vi</span>, <span class="va">n0</span>, <span class="va">n1</span><span class="op">)</span></span>
<span><span class="va">sim</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id          yi         vi n0 n1
1   1  0.48028849 0.07186486 30 30
2   2 -0.09665809 0.04782403 38 38
3   3  0.35324118 0.06579169 29 29
4   4 -0.07702323 0.05382421 40 40
5   5 -0.13602413 0.05129676 47 47
6   6  0.08043836 0.03698153 43 43
7   7  0.13757072 0.03872013 44 44
8   8  0.96331420 0.04830064 37 37
9   9  0.52297997 0.04848564 38 38
10 10  0.94638007 0.06902613 33 33</code></pre>
</div>
</div>
<p>Here, we put everything into a single function, which can be used to simulate different scenarios.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_study</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">n0</span>, <span class="va">n1</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">id</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n0</span></span>
<span>    <span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">theta</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        yi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span>,</span>
<span>        vi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">n0</span> <span class="op">&lt;-</span> <span class="va">n0</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n1</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">id</span>, <span class="va">sim</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rep3data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sim_studies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">tau2</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">n0</span>, <span class="va">n1</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># check input parameters consistency</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">R</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n0</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n0</span>, <span class="va">R</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">R</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n0</span></span>
<span></span>
<span>    <span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">R</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">deltai</span></span>
<span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span><span class="op">(</span><span class="va">sim_study</span>, <span class="va">mu</span>, <span class="va">n0</span>, <span class="va">n1</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sim</span><span class="op">)</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span>, <span class="va">sim</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rep3data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sim_studies</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0</span>, n0 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id         yi         vi       sei n0 n1
1   1 0.73346786 0.06939759 0.2634342 30 30
2   2 0.12739199 0.05924995 0.2434131 30 30
3   3 0.26911091 0.06295699 0.2509123 30 30
4   4 0.06089035 0.07242114 0.2691118 30 30
5   5 0.37396961 0.06160821 0.2482100 30 30
6   6 0.20731260 0.04404100 0.2098595 30 30
7   7 0.29403998 0.06482842 0.2546143 30 30
8   8 0.48189905 0.05869047 0.2422612 30 30
9   9 0.47577042 0.09434638 0.3071586 30 30
10 10 0.53507650 0.07269406 0.2696184 30 30</code></pre>
</div>
</div>
</section><section id="methods" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="methods">
<span class="header-section-number">4.4</span> Methods</h2>
<p>The database available at the following link <a href="http://rachelheyard.com/reproducibility_metrics/">http://rachelheyard.com/reproducibility_metrics/</a> can be consulted for a more complete overview. Among all the available methods, we have selected the following metrics<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, each of which will be illustrated below, with suitable examples.</p>
<ul>
<li>Prediction interval: is the replication effect inside the original 95% prediction interval?</li>
<li>Proportion of population effects agreeing in direction with the original (vote counting)</li>
<li>Confidence interval (CI): original effect in replication 95% CI</li>
<li>Confidence interval (CI): replication effect in original 95% CI</li>
<li>Prediction interval (CI): replication effect in original 95% PI</li>
<li>Replication Bayes Factor (BF)</li>
<li>Small Telescopes</li>
<li>Consistency of original with replications, <span class="math inline">\(P_{\mbox{orig}}\)</span>
</li>
<li>Proportion of population effects agreeing in direction with the original, <span class="math inline">\(\hat{P}_{&gt;0}\)</span>
</li>
<li>Meta-analysis and <span class="math inline">\(Q\)</span> statistics</li>
</ul></section><section id="vote-counting-based-on-significance-or-direction" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="vote-counting-based-on-significance-or-direction">
<span class="header-section-number">4.5</span> Vote Counting based on significance or direction</h2>
<p>The simplest method is called <strong>vote counting</strong> <span class="citation" data-cites="Valentine2011-yq Hedges1980-gd">(<a href="#ref-Hedges1980-gd" role="doc-biblioref">Hedges &amp; Olkin, 1980</a>; <a href="#ref-Valentine2011-yq" role="doc-biblioref">Valentine et al., 2011</a>)</span>. A replication attempt <span class="math inline">\(\theta_{r}\)</span> is considered to be successful if the result is is statistically significant i.e., <span class="math inline">\(p_{\theta_{r}} \leq \alpha\)</span> and has the same direction as the original study <span class="math inline">\(\theta_{0}\)</span>. Similarly, we can count the number of replications with the <em>same sign</em> as the original study. This method has the following <span style="color: green;">pros</span> and <span style="color: red;">cons</span>.</p>
<div class="pros">
<ul>
<li>Easy to understand, communicate and compute</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Does not consider the size of the effect</li>
<li>Depends on the power of <span class="math inline">\(\theta_{rep}\)</span>
</li>
</ul>
</div>
<p>Here is an example which illustrates the vote counting method First, we simulate a replication:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## original study</span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">theta_orig</span> <span class="op">&lt;-</span> <span class="fu">theta_from_z</span><span class="op">(</span><span class="fl">2</span>, <span class="va">n_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">theta_orig</span>,</span>
<span>  vi <span class="op">=</span> <span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_orig</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span><span class="op">$</span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">orig</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu">summary_es</span><span class="op">(</span><span class="va">orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         yi         vi       sei zi       pval      ci.lb    ci.ub
1 0.5163978 0.06666667 0.2581989  2 0.04550026 0.01033725 1.022458</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## replications</span></span>
<span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span>, </span>
<span>                    mu <span class="op">=</span> <span class="va">theta_orig</span>, </span>
<span>                    tau2 <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                    <span class="va">n_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu">summary_es</span><span class="op">(</span><span class="va">reps</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reps</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id        yi         vi       sei n0 n1        zi         pval      ci.lb
1  1 0.4010531 0.07664786 0.2768535 30 30 1.4486111 0.1474462075 -0.1415698
2  2 0.2329089 0.06470826 0.2543782 30 30 0.9156010 0.3598762109 -0.2656632
3  3 0.2925283 0.06973105 0.2640664 30 30 1.1077831 0.2679555037 -0.2250323
4  4 0.8481431 0.05533669 0.2352375 30 30 3.6054755 0.0003115819  0.3870860
5  5 0.5576306 0.05370252 0.2317380 30 30 2.4062971 0.0161151534  0.1034324
6  6 0.2115732 0.05091177 0.2256364 30 30 0.9376734 0.3484122558 -0.2306659
      ci.ub
1 0.9436759
2 0.7314810
3 0.8100889
4 1.3092002
5 1.0118288
6 0.6538124</code></pre>
</div>
</div>
<p>Then, we compute the proportions of replication studies that are statistically significant:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
</div>
<p>And, the proportions of replication studies with the same sign as the original:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">orig</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>At this stage, we could also perform some statistical tests in order to complement the vote counting approach. See <span class="citation" data-cites="Bushman2009-zv">Bushman &amp; Wang (<a href="#ref-Bushman2009-zv" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="Hedges1980-gd">Hedges &amp; Olkin (<a href="#ref-Hedges1980-gd" role="doc-biblioref">1980</a>)</span> for vote-counting methods in meta-analysis.</p>
<p>Here is an extreme example:</p>
<p>Imagine an original experiment with <span class="math inline">\(n_{0} = 30\)</span> and <span class="math inline">\(\hat \theta_{0} = 0.5\)</span> that is statistically significant <span class="math inline">\(p \approx 0.045\)</span>. Now, consider a direct replication study (thus assume <span class="math inline">\(\tau^2 = 0\)</span>) with <span class="math inline">\(n_{1} = 350\)</span> which found <span class="math inline">\(\hat \theta_{1} = 0.15\)</span>, which is statistically significant at <span class="math inline">\(p\approx 0.047\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The most problematic aspect of using only the information about the sign of the effect (or the p value) is that <em>we lose information</em> about the <strong>size of the effect</strong> and the <strong>precision</strong>.</p>
</section><section id="confidenceprediction-interval-methods" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="confidenceprediction-interval-methods">
<span class="header-section-number">4.6</span> Confidence/prediction interval methods</h2>
<p>An advantage of confidence/prediction interval methods is that they take into account the size of the effect and the precision. The confidence interval represents the sampling uncertainty around the estimated value. It is interpreted as the proportion of confidence intervals (under hypothetical repetition of the same sampling procedure) which contain the true value.</p>
<p>The confidence interval around an estimated effect <span class="math inline">\(\theta_r\)</span> can be written as follows:</p>
<p><span class="math display">\[
95\%\;\mbox{CI} = \hat\theta_r \pm t_{\alpha}\sqrt{\sigma^2_{r}}
\]</span></p>
<p>Here, <span class="math inline">\(t_{\alpha}\)</span> is the critical test statistic for significance level <span class="math inline">\(\alpha\)</span>. This version of the confidence interval is symmetric around the estimated value and its width is a function of the estimation precision.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">-</span> <span class="va">se</span> <span class="op">*</span> <span class="va">tc</span></span>
<span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">+</span> <span class="va">se</span> <span class="op">*</span> <span class="va">tc</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">theta</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">lb</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ub</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Sample Size"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta\\;_{r}$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">ub</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lb</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="replication-effect-within-the-original-ci" class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="replication-effect-within-the-original-ci">
<span class="header-section-number">4.6.1</span> Replication effect within the original CI</h3>
<p>We can check whether a replication effect falls within the original study’s confidence interval. That is, whether the following inequalities are satisfied.</p>
<p><span class="math display">\[
\theta_{0} - t_{\alpha} \sqrt{\sigma^2_{0}} &lt; \theta_{r} &lt; \theta_{0} + t_{\alpha} \sqrt{\sigma^2_{0}}
\]</span></p>
<p>The <span style="color: green;">pros</span> and <span style="color: red;">cons</span> of this approach include:</p>
<div class="pros">
<ul>
<li>Takes into account the size of the effect and the precision of <span class="math inline">\(\theta_{0}\)</span>
</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Assumes the original study provides a reliable estimate</li>
<li>Has no extension for <em>many-to-one</em> designs</li>
<li>Original studies with limited precision will tend to lead to higher success rates (i.e., original studies with wide intervals will be easier to replicate)</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">z_orig</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">theta_orig</span> <span class="op">&lt;-</span> <span class="fu">theta_from_z</span><span class="op">(</span><span class="va">z_orig</span>, <span class="va">n_orig</span><span class="op">)</span></span>
<span><span class="va">n_rep</span> <span class="op">&lt;-</span> <span class="fl">350</span></span>
<span><span class="va">theta_rep</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span><span class="va">se_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n_orig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci_orig</span> <span class="op">&lt;-</span> <span class="va">theta_orig</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_orig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">theta_orig</span>, <span class="va">se_orig</span><span class="op">)</span>, </span>
<span>      <span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">"Density"</span>, </span>
<span>      xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ci_orig</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_orig</span>, <span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_rep</span>, <span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Replication"</span><span class="op">)</span>, </span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"firebrick"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here is an illustration of the last <span style="color: red;">con</span> of this method (i.e., that original studies with wide intervals will be easier to replicate).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="original-study-within-replication-ci" class="level3" data-number="4.6.2"><h3 data-number="4.6.2" class="anchored" data-anchor-id="original-study-within-replication-ci">
<span class="header-section-number">4.6.2</span> Original study within replication CI</h3>
<p>A similar approach is checking whether the original effect size is contained within the replication confidence interval, i.e., whether the following inequalities are satisfied.</p>
<p><span class="math display">\[
\theta_{r} - t_{\alpha} \sqrt{\sigma_{r}^2} &lt; \theta_{0} &lt; \theta_{r} + t_{\alpha} \sqrt{\sigma_{r}^2}
\]</span></p>
<p>This method has the same <span style="color: green;">pros</span> and <span style="color: red;">cons</span> as the previous approach. One advantage of this method is that replication studies are usually more precise (because they tend to have higher sample sizes). As a result, the parameter and the %CI tends to be more reliable.</p>
</section></section><section id="prediction-interval-pi" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="prediction-interval-pi">
<span class="header-section-number">4.7</span> Prediction interval PI</h2>
<p>The CI methods described so far only take into account uncertainty from either the original or the replication study. The prediction interval PI allows us to account for uncertainty regarding a future observation (in this case, a future study).</p>
<p>If we compute the difference between the original and the replication study, the sampling distribution of the difference represents the range of values that are expected <em>in the absence of other sources of variability</em>. In other words, assuming that <span class="math inline">\(\tau^2 = 0\)</span>.</p>
<p>If the original and replication studies come from the same population, the sampling distribution of the difference is centered on zero with a certain standard error <span class="math inline">\(\theta_{0} - \theta_{r} \sim \mathcal{N}\left(0, \sqrt{\sigma^2_{\hat \theta_{0} - \hat \theta_{r}}} \right)\)</span> (the subscript <span class="math inline">\(0\)</span> is to indicate that the effect is expected to be sampled from the same population as <span class="math inline">\(\theta_{0}\)</span>)</p>
<p><span class="math display">\[
\hat \theta_{0} \pm t_{\alpha} \sqrt{\sigma^2_{\theta_{0} - \theta_{r}}}
\]</span></p>
<p>The new standard error is the sum (assuming that the two studies are independent) of the two standard errors. Thus, we are taking into account the estimation uncertainty of the original and replication studies.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span></span>
<span><span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># group 1</span></span>
<span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># group 2</span></span>
<span><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span> <span class="co"># effect size</span></span>
<span><span class="va">se_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">/</span><span class="fl">50</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span> <span class="co"># standard error of the difference</span></span>
<span></span>
<span><span class="va">n_r</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size replication</span></span>
<span></span>
<span><span class="va">se_o_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">se_o</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">od</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_o_r</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.325520 1.298378</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">od</span>, <span class="va">se_o_r</span><span class="op">)</span>, <span class="va">od</span> <span class="op">-</span> <span class="va">se_o_r</span><span class="op">*</span><span class="fl">4</span>, <span class="va">od</span> <span class="op">+</span> <span class="va">se_o_r</span><span class="op">*</span><span class="fl">4</span>, lwd <span class="op">=</span> <span class="fl">2</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta$"</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">od</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_o_r</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>The <span style="color: green;">pros</span> and <span style="color: red;">cons</span> of this method include:</p>
<div class="pros">
<ul>
<li>Takes into account uncertainty in both studies</li>
<li>Allows us to plan a replication using the standard deviation of the original study and the expected sample size of the replication study</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Low precision in original studies leads to wider PI. For a replication study, it is difficult to fall outside the PI</li>
<li>Mainly useful for <em>one-to-one</em> replication designs</li>
</ul>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-p_orig" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-p_orig">
<span class="header-section-number">4.8</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(p_{orig}\)</span>
</h2>
<p>Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> proposed a new method based on the prediction interval to calculate a p value <span class="math inline">\(p_{orig}\)</span> representing the probability that <span class="math inline">\(\theta_{0}\)</span> is consistent with the replications. This method is suited for <em>many-to-one</em> replication designs. Formally:</p>
<p><span class="math display">\[
p_{orig} = 2 \left[ 1 - \Phi \left( \frac{|\hat \theta_{0} - \hat \mu_{\theta_{R}}|}{\sqrt{\hat \tau^2 + \sigma^2_{\theta_{0}} + \hat{SE}^2_{\hat \mu_{\theta_{R}}}}} \right) \right]
\]</span></p>
<ul>
<li>
<span class="math inline">\(\hat \mu_{\theta_{R}}\)</span> is the pooled (i.e., meta-analytic) estimation of the <span class="math inline">\(k\)</span> replications</li>
<li>
<span class="math inline">\(\tau^2\)</span> is the variance of effects across replications (i.e., heterogeneity)</li>
</ul>
<p><span class="math inline">\(p_{orig}\)</span> is interpreted as the probability that <span class="math inline">\(\theta_{0}\)</span> is at least as extreme as what is observed. A low <span class="math inline">\(p_{orig}\)</span> suggests that the original study is inconsistent with replications. This method as three key <span style="color: green;">pros</span>.</p>
<div class="pros">
<ul>
<li>Suited for <em>many-to-one</em> designs</li>
<li>Takes into account all sources of uncertainty</li>
<li>Provides a p-value (to gauge consistency of the original study with replications)</li>
</ul>
</div>
<p>The code for this approach is implemented in the <code>Replicate</code> and <code>MetaUtility</code> R packages:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">theta_rep</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">theta_orig</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n_rep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">replications</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="va">k</span>, <span class="va">theta_rep</span>, <span class="va">tau2</span>, <span class="va">n_rep</span>, <span class="va">n_rep</span><span class="op">)</span></span>
<span><span class="va">original</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="fl">1</span>, <span class="va">theta_orig</span>, <span class="fl">0</span>, <span class="va">n_orig</span>, <span class="va">n_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_rep</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">replications</span><span class="op">)</span> <span class="co"># random-effects meta-analysis</span></span>
<span></span>
<span><span class="fu">Replicate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Replicate/man/p_orig.html">p_orig</a></span><span class="op">(</span><span class="va">original</span><span class="op">$</span><span class="va">yi</span>, <span class="va">original</span><span class="op">$</span><span class="va">vi</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">tau2</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06692786</code></pre>
</div>
</div>
<section id="simulation" class="level3" data-number="4.8.1"><h3 data-number="4.8.1" class="anchored" data-anchor-id="simulation">
<span class="header-section-number">4.8.1</span> Simulation</h3>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># standard errors assuming same n and variance 1</span></span>
<span><span class="va">se_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_orig</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_rep</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_theta_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">se_rep</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="co"># standard error of the random-effects estimate</span></span>
<span></span>
<span><span class="va">sep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span> <span class="op">+</span> <span class="va">se_orig</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">se_theta_rep</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># z of p-orig denominator</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">theta_rep</span>, <span class="va">sep</span><span class="op">)</span>, <span class="va">theta_rep</span> <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="va">sep</span>, <span class="va">theta_rep</span> <span class="op">+</span> <span class="fl">4</span><span class="op">*</span><span class="va">sep</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\theta"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_orig</span>, <span class="fl">0.02</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="va">theta_rep</span>, <span class="va">sep</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-hat-p_-0" class="level3" data-number="4.8.2"><h3 data-number="4.8.2" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-hat-p_-0">
<span class="header-section-number">4.8.2</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(\hat P_{&gt; 0}\)</span>
</h3>
<p>Another related metric is the <span class="math inline">\(\hat P_{&gt; 0}\)</span>, which represents the proportion of replications having the same direction as the original effect. Note: before computing the proportions, they adjust the estimated <span class="math inline">\(\theta_{r}\)</span> (<span class="math inline">\(r = 1, \dots, R\)</span>) with a shrinkage factor (to account for regression to the mean):</p>
<p><span class="math display">\[
\tilde{\theta}_{r} = (\theta_{r} - \mu_{\theta_{r}}) \sqrt{\frac{\hat \tau^2}{\hat \tau^2 + \sigma^2_{r}}}
\]</span></p>
<p>Here <span class="math inline">\(\sigma^2_r\)</span> is the sampling variance for the replication effect size <span class="math inline">\(r\)</span>. This method is similar to vote counting; but, we are adjusting the effects with a shrinkage factor based on <span class="math inline">\(\tau^2\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute calibrated estimation for the replications</span></span>
<span><span class="co"># use restricted maximum likelihood to estimate tau2 under the hood</span></span>
<span><span class="va">theta_sh</span> <span class="op">&lt;-</span> <span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/calib_ests.html">calib_ests</a></span><span class="op">(</span><span class="va">replications</span><span class="op">$</span><span class="va">yi</span>, <span class="va">replications</span><span class="op">$</span><span class="va">sei</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">theta_sh</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.85</code></pre>
</div>
</div>
<p>The authors suggest a bootstrapping approach for inference on <span class="math inline">\(\hat P_{&gt; 0}\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">1e3</span></span>
<span><span class="va">theta_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">nboot</span>, ncol <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nboot</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">replications</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">replications</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">replications_boot</span> <span class="op">&lt;-</span> <span class="va">replications</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span>
<span>  <span class="va">theta_cal</span> <span class="op">&lt;-</span> <span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/calib_ests.html">calib_ests</a></span><span class="op">(</span><span class="va">replications_boot</span><span class="op">$</span><span class="va">yi</span>, </span>
<span>                                       <span class="va">replications_boot</span><span class="op">$</span><span class="va">sei</span>, </span>
<span>                                       method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span>  <span class="va">theta_boot</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_cal</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calculate</span></span>
<span><span class="va">p_greater_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">theta_boot</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" class="level3" data-number="4.8.3"><h3 data-number="4.8.3" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q">
<span class="header-section-number">4.8.3</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(\hat P_{\gtrless q*}\)</span>
</h3>
<p>Instead of using 0 as threshold, we can use a practically meaningful effect size, considered to be low but different from 0. <span class="math inline">\(\hat P_{\gtrless q*}\)</span> is the proportion of (calibrated) replications greater or lower than the <span class="math inline">\(q*\)</span> value. This framework is similar to equivalence and minimum effect size testing <span class="citation" data-cites="Lakens2018-ri">(<a href="#ref-Lakens2018-ri" role="doc-biblioref">Lakens et al., 2018</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># minimum non zero effect</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see ?MetaUtility::prop_stronger</span></span>
<span><span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/prop_stronger.html">prop_stronger</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>,</span>
<span>                           M <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                           t2 <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">tau2</span>,</span>
<span>                           tail <span class="op">=</span> <span class="st">"above"</span>,</span>
<span>                           estimate.method <span class="op">=</span> <span class="st">"calibrated"</span>,</span>
<span>                           ci.method <span class="op">=</span> <span class="st">"calibrated"</span>,</span>
<span>                           dat <span class="op">=</span> <span class="va">replications</span>,</span>
<span>                           yi.name <span class="op">=</span> <span class="st">"yi"</span>,</span>
<span>                           vi.name <span class="op">=</span> <span class="st">"vi"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   est        se lo  hi   bt.mn shapiro.pval
1 0.35 0.1756669  0 0.6 0.35375    0.8137044</code></pre>
</div>
</div>
</section></section><section id="meta-analytic-methods" class="level2" data-number="4.9"><h2 data-number="4.9" class="anchored" data-anchor-id="meta-analytic-methods">
<span class="header-section-number">4.9</span> Meta-analytic methods</h2>
<p>Another approach is to combine the original and replication results using a meta-analysis model. This is applicable to both <em>one-to-one</em> and <em>many-to-one</em> designs. In this case, we can test whether the pooled estimate is different from 0 (or another practically relevant value). The meta-analytic approach has the following <span style="color: green;">pros</span> and <span style="color: red;">cons</span>.</p>
<div class="pros">
<ul>
<li>Uses all the available information, especially when fitting a random-effects model</li>
<li>Takes into account the precision of individual studies (e.g., via inverse-variance weighting)</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Does not take into account publication bias</li>
<li>For <em>one-to-one</em> designs, only a fixed-effects model can be used</li>
</ul>
</div>
<section id="fixed-effects-model" class="level3" data-number="4.9.1"><h3 data-number="4.9.1" class="anchored" data-anchor-id="fixed-effects-model">
<span class="header-section-number">4.9.1</span> Fixed-effects Model</h3>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fixed-effects</span></span>
<span><span class="va">fit_fixed</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, method <span class="op">=</span> <span class="st">"FE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_fixed</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Fixed-Effects Model (k = 20)

  logLik  deviance       AIC       BIC      AICc   
 20.7415   -0.0000  -39.4829  -38.4872  -39.2607   

I^2 (total heterogeneity / total variability):   0.00%
H^2 (total variability / sampling variability):  0.00

Test for Heterogeneity:
Q(df = 19) = 0.0000, p-val = 1.0000

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.2000  0.0316  6.3246  &lt;.0001  0.1380  0.2620  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="random-effects-model" class="level3" data-number="4.9.2"><h3 data-number="4.9.2" class="anchored" data-anchor-id="random-effects-model">
<span class="header-section-number">4.9.2</span> Random-Effects model</h3>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fixed-effects</span></span>
<span><span class="va">fit_random</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_random</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Random-Effects Model (k = 20; tau^2 estimator: REML)

  logLik  deviance       AIC       BIC      AICc   
 19.7044  -39.4088  -35.4088  -33.5199  -34.6588   

tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0065)
tau (square root of estimated tau^2 value):      0
I^2 (total heterogeneity / total variability):   0.00%
H^2 (total variability / sampling variability):  1.00

Test for Heterogeneity:
Q(df = 19) = 0.0000, p-val = 1.0000

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.2000  0.0316  6.3246  &lt;.0001  0.1380  0.2620  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="pooling-replications" class="level3" data-number="4.9.3"><h3 data-number="4.9.3" class="anchored" data-anchor-id="pooling-replications">
<span class="header-section-number">4.9.3</span> Pooling replications</h3>
<p>The previous approach can also incorporate the combination/pooling of replications into a single effect (then comparing the original study and the combined/pooled replication study).</p>
<p>This is similar to using the CI or PI approaches; but, the replication effect is likely to be more precise, since we are pooling multiple replication studies.</p>
</section><section id="the-q-statistic" class="level3" data-number="4.9.4"><h3 data-number="4.9.4" class="anchored" data-anchor-id="the-q-statistic">
<span class="header-section-number">4.9.4</span> The Q Statistic</h3>
<p>An interesting proposal involves the use of the Q statistic <span class="citation" data-cites="Hedges2019-pr Hedges2019-ar Hedges2021-of Schauer2022-mj Schauer2021-ja Schauer2020-tw Hedges2019-ry">(<a href="#ref-Hedges2019-pr" role="doc-biblioref">Hedges &amp; Schauer, 2019a</a>, <a href="#ref-Hedges2019-ar" role="doc-biblioref">2019b</a>, <a href="#ref-Hedges2019-ry" role="doc-biblioref">2019c</a>, <a href="#ref-Hedges2021-of" role="doc-biblioref">2021</a>; <a href="#ref-Schauer2022-mj" role="doc-biblioref">Schauer, 2022</a>; <a href="#ref-Schauer2020-tw" role="doc-biblioref">Schauer &amp; Hedges, 2020</a>; <a href="#ref-Schauer2021-ja" role="doc-biblioref">Schauer &amp; Hedges, 2021</a>)</span>, which is commonly applied in meta-analysis to assess the presence of heterogeneity. Formally:</p>
<p><span class="math display">\[
Q = \sum_{r = 0}^{R} \frac{(\theta_r - \bar \theta_R)^2}{\sigma^2_r}
\]</span></p>
<p>where <span class="math inline">\(\bar \theta_R\)</span> is the inverse-variance weighted average (e.g., from a fixed-effect model). The <span class="math inline">\(Q\)</span> statistic is a weighted sum of squares. Under the null hypothesis where all studies are equal <span class="math inline">\(\theta_0 = \theta_1, ... = \theta_R\)</span>, the <span class="math inline">\(Q\)</span> statistic has a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(R - 1\)</span> degrees of freedom. Under the alternative hypothesis the distribution is a non-central <span class="math inline">\(\chi^2\)</span> with non centrality parameter <span class="math inline">\(\lambda\)</span>. The expected value of <span class="math inline">\(Q\)</span> is <span class="math inline">\(E(Q) = \nu + \lambda\)</span>, where <span class="math inline">\(\nu\)</span> are the degrees of freedom.</p>
<p>Hedges &amp; Schauer proposed the use of <span class="math inline">\(Q\)</span> to evaluate the consistency of a series of replications:</p>
<ul>
<li>In case of a <strong>replication</strong>, <span class="math inline">\(\lambda = 0\)</span> because <span class="math inline">\(\theta_0 = \theta_1, ... = \theta_R\)</span>.</li>
<li>In case of an <strong>extension</strong>, <span class="math inline">\(\lambda &lt; \lambda_0\)</span> where <span class="math inline">\(\lambda_0\)</span> is the maximum value considered equivalent to zero. In other words, <span class="math inline">\(\lambda_0\)</span> is the threshold above which the variability is too high to be considered negligible for a replication <span class="citation" data-cites="Machery2020-sv">(in the sense of <a href="#ref-Machery2020-sv" role="doc-biblioref">Machery, 2020</a>)</span>.</li>
</ul>
<p>This approach is testing the consistency (i.e., homogeneity) of replications. A successful replication should minimize the heterogeneity and the presence of a significant <span class="math inline">\(Q\)</span> statistic would suggest a failed replication attempt. <span class="citation" data-cites="Hedges2019-pr">Hedges &amp; Schauer (<a href="#ref-Hedges2019-pr" role="doc-biblioref">2019a</a>)</span> and <span class="citation" data-cites="Mathur2019-vh">Mathur &amp; VanderWeele (<a href="#ref-Mathur2019-vh" role="doc-biblioref">2019</a>)</span> discuss this approach in detail. Their discussion addresses various issues surrounding the proper use of this method, including:</p>
<ul>
<li>variations of the apporoach, which cover different replication setups (burden of proof on replicating vs non-replicating, many-to-one and one-to-one, etc.)</li>
<li>the choice (and interpretation) of the <span class="math inline">\(\lambda_0\)</span> parameter</li>
<li>evaluating the power and statistical properties under different replication scenarios</li>
</ul>
<p>When evaluating a replication, we can use the <code>Qrep()</code> function which calculates the p-value based on the Q sampling distribution.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Qrep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, <span class="va">lambda0</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">k</span></span>
<span>  <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">QE</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">Qp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">Q</span>, df <span class="op">=</span> <span class="va">df</span>, ncp <span class="op">=</span> <span class="va">lambda0</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Qp</span> <span class="op">&lt;</span> <span class="fl">0.001</span>, <span class="st">"p &lt; 0.001"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"p = %.3f"</span>, <span class="va">Qp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">Q</span> <span class="op">-</span> <span class="va">df</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">(</span><span class="va">Q</span> <span class="op">-</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="va">Q</span>, lambda <span class="op">=</span> <span class="va">lambda</span>, pval <span class="op">=</span> <span class="va">Qp</span>, df <span class="op">=</span> <span class="va">df</span>, k <span class="op">=</span> <span class="va">k</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, lambda0 <span class="op">=</span> <span class="va">lambda0</span><span class="op">)</span></span>
<span>  <span class="va">H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">lambda0</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"H0: lambda &lt;"</span>, <span class="va">lambda0</span><span class="op">)</span>, <span class="st">"H0: lambda = 0"</span><span class="op">)</span></span>
<span>  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">lambda0</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="st">"Q test for Approximate Replication"</span>, <span class="st">"Q test for Exact Replication"</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_rule.html">cli_rule</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_blue</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">style_bold</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Q = %.3f (df = %s), lambda = %.3f, %s"</span>, <span class="va">res</span><span class="op">$</span><span class="va">Q</span>, <span class="va">res</span><span class="op">$</span><span class="va">df</span>, <span class="va">lambda</span>, <span class="va">pval</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">H0</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_rule.html">cli_rule</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Qrep"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Q test for Exact Replication 

Q = 509.539 (df = 99), lambda = 410.539, p &lt; 0.001 
H0: lambda = 0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Qres</span> <span class="op">&lt;-</span> <span class="fu">Qrep</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q test for Exact Replication 

Q = 509.539 (df = 99), lambda = 410.539, p &lt; 0.001 
H0: lambda = 0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot.Qrep</span><span class="op">(</span><span class="va">Qres</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="q-statistic-for-an-extension-study" class="level4" data-number="4.9.4.1"><h4 data-number="4.9.4.1" class="anchored" data-anchor-id="q-statistic-for-an-extension-study">
<span class="header-section-number">4.9.4.1</span> Q Statistic for an extension study</h4>
<p>In the case of an extension of an intial experiment, we will need to set <span class="math inline">\(\lambda_0\)</span> to a meaningful value. The critical <span class="math inline">\(Q\)</span> is no longer evaluated with a central <span class="math inline">\(\chi^2\)</span> but is now a non-central <span class="math inline">\(\chi^2\)</span> with non-centrality parameter <span class="math inline">\(\lambda_0\)</span>.</p>
<p><span class="citation" data-cites="Hedges2019-ry">Hedges &amp; Schauer (<a href="#ref-Hedges2019-ry" role="doc-biblioref">2019c</a>)</span> provide different strategies for choosing <span class="math inline">\(\lambda_0\)</span>. They found that (under some mild assumptions), <span class="math inline">\(\lambda = (R - 1) \frac{\tau^2}{\tilde{v}}\)</span> seems to be a suitable choice.</p>
<p>Similarly to a meta-analysis, in a many-to-one replication design we have mainly two sources of variability: the true heterogeneity <span class="math inline">\(\tau^2\)</span> and the within-studies veriability <span class="math inline">\(\sigma_i^2\)</span>. The sum of these two quantities is the total variability and the proportion of total variability due to heterogeneity is a relative index of (in)consistency among effects. This proportion is called <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#ref-Higgins2002-fh" role="doc-biblioref">Higgins &amp; Thompson, 2002</a>)</span> in the meta-analysis literature is calculated as: <span class="math display">\[
I^2 = 100\% \times \frac{\hat{\tau}^2}{\hat{\tau}^2 + \tilde{v}}
\]</span></p>
<p>Where <span class="math inline">\(\tilde{v}\)</span> can be considered as a typical within-study variance value.</p>
<p><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2},
\]</span></p>
<p>Having introduced the <span class="math inline">\(I^2\)</span> statistic, we can derive a <span class="math inline">\(\lambda_0\)</span> based on <span class="math inline">\(I^2\)</span>. <span class="citation" data-cites="Schmidt2014-kw">Schmidt &amp; Hunter (<a href="#ref-Schmidt2014-kw" role="doc-biblioref">2014</a>)</span> proposed that when <span class="math inline">\(\tilde{v}\)</span> is at least 75% of the total variance <span class="math inline">\(\tilde{v} + \tau^2\)</span>, <span class="math inline">\(\tau^2\)</span> can be considered to be negligible. This corresponds to a <span class="math inline">\(I^2 = 25%\)</span> and a ratio <span class="math inline">\(\frac{\tau^2}{\tilde{v}} = 1/3\)</span>. Hence, <span class="math inline">\(\lambda_0 = \frac{(R - 1)}{3}\)</span> can be considered to be a negligible amount of heterogeneity.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="va">k</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu">Qrep</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>, lambda0 <span class="op">=</span> <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q test for Approximate Replication 

Q = 93.881 (df = 99), lambda = 0.000, p = 0.989 
H0: lambda &lt; 33 </code></pre>
</div>
</div>
</section></section></section><section id="small-telescopes-simonsohn2015-kg" class="level2" data-number="4.10"><h2 data-number="4.10" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg">
<span class="header-section-number">4.10</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<p>The idea is simple but quite powerful and insightful. An original study <span class="math inline">\(\theta_{0}\)</span> is conducted estimating a certain effect size with a certain sample size. This study has a certain statistical power level assuming a plausible effect size. Then we estimate the effect size that would have a certain low power level (e.g., 33%, <span class="math inline">\(d_{33\%}\)</span>). Then we run the replication study <span class="math inline">\(\theta_r\)</span> testing if the replication effect size is lower (one-sided test) than <span class="math inline">\(d_{33\%}\)</span>. If upper bound of the confidence interval of the replication study is lower this means that the original study is probably seriously underpowered suggesting evidence of non-replication.</p>
<p>As a practical example, let’s assume that an original study found an effect of <span class="math inline">\(\theta_{0} = 0.7\)</span> on a two-sample design with <span class="math inline">\(n = 20\)</span> per group. We define a threshold as the effect size that is associated with a certain low statistical power level e.g., <span class="math inline">\(33\%\)</span> given the sample size i.e.&nbsp;<span class="math inline">\(d_{33\%} = 0.5\)</span>. The replication study found an effect of <span class="math inline">\(\theta_{r} = 0.2\)</span> with <span class="math inline">\(n = 100\)</span> subjects.</p>
<p>If the <span class="math inline">\(\theta_{r}\)</span> is statistically significantly lower than <span class="math inline">\(d_{33\%} = 0.5\)</span> we conclude that the effect is probably so small that could not have been detected by the original study.</p>
<p>We can use the custom <code>small_telescope()</code> function on simulated data:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">small_telescope</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">or_d</span>,</span>
<span>                            <span class="va">or_se</span>,</span>
<span>                            <span class="va">rep_d</span>,</span>
<span>                            <span class="va">rep_se</span>,</span>
<span>                            <span class="va">small</span>,</span>
<span>                            <span class="va">ci</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># quantile for the ci</span></span>
<span>  <span class="va">qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ci</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ci</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># original confidence interval</span></span>
<span>  <span class="va">or_ci</span> <span class="op">&lt;-</span> <span class="va">or_d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span> <span class="op">*</span> <span class="va">or_se</span></span>
<span></span>
<span>  <span class="co"># replication confidence interval</span></span>
<span>  <span class="va">rep_ci</span> <span class="op">&lt;-</span> <span class="va">rep_d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span> <span class="op">*</span> <span class="va">rep_se</span></span>
<span></span>
<span>  <span class="co"># small power</span></span>
<span>  <span class="va">is_replicated</span> <span class="op">&lt;-</span> <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">small</span></span>
<span></span>
<span>  <span class="va">msg_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Original Study: d = %.3f %s CI = [%.3f, %.3f]"</span>,</span>
<span>                          <span class="va">or_d</span>, <span class="va">ci</span>, <span class="va">or_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">or_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">msg_replicated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Replication Study: d = %.3f %s CI = [%.3f, %.3f]"</span>,</span>
<span>                            <span class="va">rep_d</span>, <span class="va">ci</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">is_replicated</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"The replicated effect is not smaller than the small effect (%.3f), (probably) replication!"</span>, <span class="va">small</span><span class="op">)</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_green</a></span><span class="op">(</span><span class="va">msg_res</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"The replicated effect is smaller than the small effect (%.3f), no replication!"</span>, <span class="va">small</span><span class="op">)</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_red</a></span><span class="op">(</span><span class="va">msg_res</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"replication"</span><span class="op">)</span>,</span>
<span>                    d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_d</span>, <span class="va">rep_d</span><span class="op">)</span>,</span>
<span>                    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    small <span class="op">=</span> <span class="va">small</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># nice message</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="va">msg_original</span>,</span>
<span>    <span class="va">msg_replicated</span>,</span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/rule.html">rule</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="va">msg_res</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># real effect</span></span>
<span></span>
<span><span class="co"># original study</span></span>
<span><span class="va">or_n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">or_d</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">or_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">20</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">d_small</span> <span class="op">&lt;-</span> <span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span><span class="va">or_n</span>, power <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span></span>
<span><span class="co"># replication</span></span>
<span><span class="va">rep_n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size of replication study</span></span>
<span><span class="va">g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">rep_n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">rep_n</span>, <span class="va">d</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rep_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g0</span><span class="op">)</span></span>
<span><span class="va">rep_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">rep_n</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g0</span><span class="op">)</span><span class="op">/</span><span class="va">rep_n</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we are using the <code><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr::pwr.t.test()</a></code> to compute the effect size <span class="math inline">\(\theta_{small}\)</span> (in code <code>d</code>) associated with 33% power.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">small_telescope</span><span class="op">(</span><span class="va">or_d</span>, <span class="va">or_se</span>, <span class="va">rep_d</span>, <span class="va">rep_se</span>, <span class="va">d_small</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original Study: d = 0.700 0.95 CI = [0.080, 1.320]
Replication Study: d = 0.214 0.95 CI = [-0.061, 0.490]
────────────────────────────────────────────────────────────────────────────────
The replicated effect is smaller than the small effect (0.493), no replication!</code></pre>
</div>
</div>
<p>And a plot:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="replication-bayes-factor" class="level2" data-number="4.11"><h2 data-number="4.11" class="anchored" data-anchor-id="replication-bayes-factor">
<span class="header-section-number">4.11</span> Replication Bayes factor</h2>
<p><span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> proposed a method to estimate the evidence of a <em>replication</em> study. The core topics to understand the method are:</p>
<ul>
<li>Bayesian hypothesis testing using the Bayes Factor <span class="citation" data-cites="Rouder2009-jh">(see, <a href="#ref-Rouder2009-jh" role="doc-biblioref">Rouder et al., 2009</a>)</span>
</li>
<li>Bayes Factor using the Savage-Dickey density ratio <span class="citation" data-cites="Wagenmakers2010-fj">(SDR, <a href="#ref-Wagenmakers2010-fj" role="doc-biblioref">Wagenmakers et al., 2010</a>)</span>
</li>
</ul>
<section id="bayesian-inference" class="level3" data-number="4.11.1"><h3 data-number="4.11.1" class="anchored" data-anchor-id="bayesian-inference">
<span class="header-section-number">4.11.1</span> Bayesian inference</h3>
<p>Bayesian inference is a statistical procedure where <strong>prior beliefs</strong> about a phenomenon are combined, using Bayes’s theorem, with <strong>evidence from data</strong> to obtain <strong>posterior beliefs</strong>.</p>
<p>If the researcher can express their prior beliefs in probabilistic terms, then evidence from the experiment is taken into account (via Bayesian conditionalization), thus increasing or decreasing the plausibility of prior beliefs.</p>
<p>Let’s consider a simple example. We need to evaluate the fairness of a coin. The parameter is the probability <span class="math inline">\(\pi\)</span> of success (i.e., heads). We have our prior belief about the coin (e.g., fair but with some uncertainty). We toss the coin <span class="math inline">\(k\)</span> times, and we observe <span class="math inline">\(x\)</span> heads. How should we update our prior beliefs? We apply Bayes’s Theorem, which, in this case, is:</p>
<p><span class="math display">\[
p(\pi|D) = \frac{p(D|\pi) \; p(\pi)}{p(D)}
\]</span></p>
<p>Here, <span class="math inline">\(\pi\)</span> is our parameter and <span class="math inline">\(D\)</span> is our data. <span class="math inline">\(p(\pi|D)\)</span> is the posterior distribution, which is the normalized product of <span class="math inline">\(p(D|\pi)\)</span> — which is called the <strong>likelihood</strong> of the hypothesis <span class="math inline">\(\pi\)</span>, relative to the data <span class="math inline">\(D\)</span> — and the prior <span class="math inline">\(p(\pi)\)</span>. <span class="math inline">\(p(D)\)</span> is the prior probability of the data (aka marginal likelihood) and is necessary for the posterior to be a (proper) probability distribution.</p>
<p>We can “read” the formula as: <em>The probability of the parameter given the data is the product of the probability of the data given the parameter and the prior probability of the parameter</em>.</p>
<p>Let’s express our <strong>prior</strong> belief in probabilistic terms:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we collect data and we observe <span class="math inline">\(x = 40\)</span> tails out of <span class="math inline">\(k = 50\)</span> trials thus <span class="math inline">\(\hat{\pi} = 0.8\)</span> and compute the <em>likelihood</em>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally we combine, using the Bayes rule, <strong>prior</strong> and <strong>likelihood</strong> to obtain the <strong>posterior</strong> distribution:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <strong>Bayes Factor</strong> (BF) — also called the <strong>likelihood ratio</strong>, for obvious reasons — is a measure of the relative support that the evidence provides for two competing hypotheses, <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> (~ <span class="math inline">\(\pi\)</span> in our previous example). It plays a key role in the following <em>odds form</em> of Bayes’s theorem.</p>
<p><span class="math display">\[
\frac{p(H_0|D)}{p(H_1|D)} = \frac{p(D|H_0)}{p(D|H_1)} \times \frac{p(H_0)}{p(H_1)}
\]</span></p>
<p>The ratio of the priors <span class="math inline">\(\frac{p(H_0)}{p(H_1)}\)</span> is called the <strong>prior odds</strong> of the hypotheses; and, the ratio of the poosteriors <span class="math inline">\(\frac{p(H_0| D)}{p(H_1 | D)}\)</span> is called the <strong>posterior odds</strong> of the hypotheses. Thus, the above (odds form) of Bayes’s Theorem can be paraphrased as follows</p>
<p><span class="math display">\[
\text{posterior odds} = \text{Bayes Factor} \times \text{prior odds}
\]</span> In this way, it can be seen that the Bayes Factor captures the relative empirical support that the evidence <span class="math inline">\(D\)</span> provides in favor of <span class="math inline">\(H_0\)</span> over <span class="math inline">\(H_1\)</span>. If the Bayes Factor is greater than 1, then <span class="math inline">\(D\)</span> favors <span class="math inline">\(H_0\)</span> over <span class="math inline">\(H_1\)</span>. If the BF is less than one, then <span class="math inline">\(D\)</span> favors <span class="math inline">\(H_1\)</span> over <span class="math inline">\(H_0\)</span>. If the BF is 1, then <span class="math inline">\(D\)</span> is neutral regarding <span class="math inline">\(H_0\)</span> vs <span class="math inline">\(H_1\)</span> <span class="citation" data-cites="Royall1997-ye">(<a href="#ref-Royall1997-ye" role="doc-biblioref">Royall, 1997</a>)</span>. For this reason, the BF is also sometimes called the <strong>weight of evidence</strong> in favor of <span class="math inline">\(H_0\)</span> (<em>vs</em> <span class="math inline">\(H_1\)</span>) <span class="citation" data-cites="Good1950-go">(<a href="#ref-Good1950-go" role="doc-biblioref">Good, 1950</a>)</span>.</p>
</section><section id="calculating-the-bayes-factor-using-the-sdr" class="level3" data-number="4.11.2"><h3 data-number="4.11.2" class="anchored" data-anchor-id="calculating-the-bayes-factor-using-the-sdr">
<span class="header-section-number">4.11.2</span> Calculating the Bayes Factor using the SDR</h3>
<p>The Savage-Dickey density ratio (SDR) is a convenient shortcut to calculate the Bayes Factor <span class="citation" data-cites="Wagenmakers2010-fj Marin2010-oh">(<a href="#ref-Marin2010-oh" role="doc-biblioref">Marin &amp; Robert, 2010</a>; see <a href="#ref-Wagenmakers2010-fj" role="doc-biblioref">Wagenmakers et al., 2010</a>)</span> in a situation where the null hypothesis (<span class="math inline">\(H_0\)</span>) is a single parameter value (e.g., <span class="math inline">\(H_0: \theta = 0\)</span>). With SDR the Bayes Factor can be calculated as the ratio between the prior and posterior density distribution under the alternative hypothesis <span class="math inline">\(H_1\)</span>.</p>
<p><span class="math display">\[
BF_{01} = \frac{p(D|H_0)}{p(D|H_1)} \approx \frac{p(\pi = x|D, H_1)}{p(\pi = x | H_1)}
\]</span></p>
<p>Where <span class="math inline">\(\pi\)</span> is the parameter of interest and <span class="math inline">\(x\)</span> is the null value under <span class="math inline">\(H_0\)</span> (e.g., 0). and <span class="math inline">\(D\)</span> are the data.</p>
<p>When there are multiple parameters in play and the null hypothesis is expressed in terms of only one of them, this representation is valid only under the assumption that the prior for any of the other parameters under the null is the same as the conditional prior for those parameters under the alternative.</p>
<p>Following the previous example <span class="math inline">\(H_0: \pi = 0.5\)</span>. Under <span class="math inline">\(H_1\)</span> we use a vague prior by setting <span class="math inline">\(\pi \sim Beta(1, 1)\)</span>.</p>
<p>Say we flipped the coin 20 times and we found that <span class="math inline">\(\hat \pi = 0.75\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The ratio between the two black dots is the Bayes Factor.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="verhagen2014-tx-model" class="level3" data-number="4.11.3"><h3 data-number="4.11.3" class="anchored" data-anchor-id="verhagen2014-tx-model">
<span class="header-section-number">4.11.3</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> model<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</h3>
<p>The idea is using the posterior distribution of the original study as prior for a Bayesian hypothesis testing where:</p>
<ul>
<li>
<span class="math inline">\(H_0: \theta_{r} = 0\)</span> meaning that there is no effect in the replication study</li>
<li>
<span class="math inline">\(H_1: \theta_{r} \neq 0\)</span> and in particular is distributed as <span class="math inline">\(\delta \sim \mathcal{N}(\theta_{0}, \sigma^2_{0})\)</span> where <span class="math inline">\(\theta_{0}\)</span> and <span class="math inline">\(\sigma^2_{0}\)</span> are the mean and standard error of the original study</li>
</ul>
<p>If <span class="math inline">\(H_0\)</span> is more likely after seeing the data, there is evidence against the replication (i.e., <span class="math inline">\(BF_{r0} &gt; 1\)</span>) otherwise there is evidence for a successful replication (<span class="math inline">\(BF_{r1} &gt; 1\)</span>).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Disclaimer:</strong> The actual implementation of <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> is different (they use the <span class="math inline">\(t\)</span> statistics). We implemented a similar model using a Bayesian linear model with <code>rstanarm</code>.</p>
</div>
</div>
<p>Let’s assume that the original study (<span class="math inline">\(n = 30\)</span>) estimates a <span class="math inline">\(\theta_{0} = 0.4\)</span> and a standard error <span class="math inline">\(\sigma^2/n\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># original study</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">yorig</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The assumption of <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> is that the original study performed a Bayesian analysis with a flat (unform) prior. Thus, the confidence interval is approximately the same as the Bayesian credible interval.</p>
</div>
</div>
<p>For this reason, the posterior distribution of the original study can be approximated as:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s imagine that a new study tried to replicate the original one. They collected <span class="math inline">\(n = 100\)</span> participants with the same protocol and found an effect of <span class="math inline">\(y_{rep} = 0.1\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">yrep</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">nrep</span>, mu <span class="op">=</span> <span class="fl">0.1</span>, Sigma <span class="op">=</span> <span class="fl">1</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">yrep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">yrep</span>, main <span class="op">=</span> <span class="st">"Replication Study (n1 = 100)"</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta_{r}$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yrep</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can analyze these data with an <em>intercept-only regression model</em> setting as prior the posterior distribution of the original study:</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># setting the prior on the intercept parameter</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html">normal</a></span><span class="op">(</span>location <span class="op">=</span> <span class="va">yorig</span>,</span>
<span>                          scale <span class="op">=</span> <span class="va">se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fitting the bayesian linear regression</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">stan_glm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>                data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>                prior_intercept <span class="op">=</span> <span class="va">prior</span>,</span>
<span>                refresh <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      y ~ 1
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 100
 predictors:   1

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 0.2    0.1  0.1   0.2   0.3  
sigma       1.0    0.1  0.9   1.0   1.1  

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 0.2    0.1  0.0   0.2   0.3  

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.0  1.0  2609 
sigma         0.0  1.0  2608 
mean_PPD      0.0  1.0  3185 
log-posterior 0.0  1.0  1693 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<p>We can use the <code><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayestestR::bayesfactor_pointnull()</a></code> to calculate the BF using the Savage-Dickey density ratio.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayesfactor_pointnull</a></span><span class="op">(</span><span class="va">fit</span>, null <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factor (Savage-Dickey density ratio)

Parameter   |    BF
-------------------
(Intercept) | 0.274

* Evidence Against The Null: 0</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can also use the <code>bf_replication()</code> function:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bf_replication</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu_original</span>,</span>
<span>                           <span class="va">se_original</span>,</span>
<span>                           <span class="va">replication</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co"># prior based on the original study</span></span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html">normal</a></span><span class="op">(</span>location <span class="op">=</span> <span class="va">mu_original</span>, scale <span class="op">=</span> <span class="va">se_original</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># to dataframe</span></span>
<span>  <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">replication</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">replication</span>,</span>
<span>                            prior_intercept <span class="op">=</span> <span class="va">prior</span>,</span>
<span>                            refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># avoid printing</span></span>
<span></span>
<span>  <span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayesfactor_pointnull</a></span><span class="op">(</span><span class="va">fit</span>, null <span class="op">=</span> <span class="fl">0</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Bayes Factor Replication Rate"</span></span>
<span>  <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="st">"Posterior Distribution ~ Mean: %.3f, SE: %.3f"</span></span>
<span>  <span class="va">replication</span> <span class="op">&lt;-</span> <span class="st">"Evidence for replication: %3f (log %.3f)"</span></span>
<span>  <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="st">"Evidence for non replication: %3f (log %.3f)"</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_green</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">replication</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">non_replication</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="op">-</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">replication</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span></span>
<span>    <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_red</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">non_replication</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="op">-</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">outlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">fit</span>,</span>
<span>    bf <span class="op">=</span> <span class="va">bf</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_blue</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span>,</span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/rule.html">rule</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">posterior</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n"</span>,</span>
<span>    <span class="va">replication</span>,</span>
<span>    <span class="va">non_replication</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">outlist</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bf_replication</span><span class="op">(</span>mu_original <span class="op">=</span> <span class="va">yorig</span>, se_original <span class="op">=</span> <span class="va">se</span>, replication <span class="op">=</span> <span class="va">yrep</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A better custom plot:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="va">yorig</span>, <span class="va">se</span><span class="op">)</span>,</span>
<span>  posterior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>                <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Original Study (Prior)"</span><span class="op">)</span>,</span>
<span>                linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">yorig</span>, sd <span class="op">=</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>                linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Replication Study (Posterior)"</span><span class="op">)</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, sd <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yorig</span>, sd <span class="op">=</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, sd <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\delta"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="conclusions" class="level2" data-number="4.12"><h2 data-number="4.12" class="anchored" data-anchor-id="conclusions">
<span class="header-section-number">4.12</span> Conclusions</h2>
<p>We hope to have provided a useful overview of statistical approaches to different definitions of replication. The meta-analytic and <span class="math inline">\(Q\)</span> methods are more focused on accumulating evidence combining original and replication studies. The CI and PI methods are more interested in comparing the original and replication(s) study. The BF method constitutes a kind of compromise between these perspectives, by evaluating the weight of evidence in favor of the null — from the point of view of the posterior distribution of the replication study.</p>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Bushman2009-zv" class="csl-entry" role="listitem">
Bushman, B. J., &amp; Wang, M. C. (2009). Vote-counting procedures in meta-analysis. In <em><em>The handbook of research synthesis and meta-analysis</em></em> (pp. 207–220). Russell Sage Foundation.
</div>
<div id="ref-Collaboration2015-ep" class="csl-entry" role="listitem">
Collaboration, O. S., &amp; Open Science Collaboration. (2015). Estimating the reproducibility of psychological science. In <em>Science</em> (Vol. 349). <a href="https://doi.org/10.1126/science.aac4716">https://doi.org/10.1126/science.aac4716</a>
</div>
<div id="ref-Errington2021-fb" class="csl-entry" role="listitem">
Errington, T. M., Mathur, M., Soderberg, C. K., Denis, A., Perfito, N., Iorns, E., &amp; Nosek, B. A. (2021). Investigating the replicability of preclinical cancer biology. <em>eLife</em>, <em>10</em>. <a href="https://doi.org/10.7554/eLife.71601">https://doi.org/10.7554/eLife.71601</a>
</div>
<div id="ref-Good1950-go" class="csl-entry" role="listitem">
Good, I. J. (1950). <em>Probability and the weighing of evidence</em>. Charles Griffin &amp; Co., Ltd., London; Hafner Publishing Co., New York.
</div>
<div id="ref-Hardin2015-ss" class="csl-entry" role="listitem">
Hardin, J., Hoerl, R., Horton, N. J., Nolan, D., Baumer, B., Hall-Holt, O., Murrell, P., Peng, R., Roback, P., Temple Lang, D., &amp; Ward, M. D. (2015). Data science in statistics curricula: Preparing students to <span>“think with data.”</span> <em>The American Statistician</em>, <em>69</em>, 343–353. <a href="https://doi.org/10.1080/00031305.2015.1077729">https://doi.org/10.1080/00031305.2015.1077729</a>
</div>
<div id="ref-Hedges1980-gd" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Olkin, I. (1980). Vote-counting methods in research synthesis. <em>Psychological Bulletin</em>, <em>88</em>, 359–369. <a href="https://doi.org/10.1037/0033-2909.88.2.359">https://doi.org/10.1037/0033-2909.88.2.359</a>
</div>
<div id="ref-Hedges2019-pr" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019a). Consistency of effects is important in replication: Rejoinder to mathur and VanderWeele (2019). <em>Psychological Methods</em>, <em>24</em>, 576–577. <a href="https://doi.org/10.1037/met0000237">https://doi.org/10.1037/met0000237</a>
</div>
<div id="ref-Hedges2019-ar" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019b). More than one replication study is needed for unambiguous tests of replication. <em>Journal of Educational and Behavioral Statistics: A Quarterly Publication Sponsored by the American Educational Research Association and the American Statistical Association</em>, <em>44</em>, 543–570. <a href="https://doi.org/10.3102/1076998619852953">https://doi.org/10.3102/1076998619852953</a>
</div>
<div id="ref-Hedges2019-ry" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019c). Statistical analyses for studying replication: Meta-analytic perspectives. <em>Psychological Methods</em>, <em>24</em>, 557–570. <a href="https://doi.org/10.1037/met0000189">https://doi.org/10.1037/met0000189</a>
</div>
<div id="ref-Hedges2021-of" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2021). The design of replication studies. <em>Journal of the Royal Statistical Society. Series A, (Statistics in Society)</em>, <em>184</em>, 868–886. <a href="https://doi.org/10.1111/rssa.12688">https://doi.org/10.1111/rssa.12688</a>
</div>
<div id="ref-Heyard2024-hv" class="csl-entry" role="listitem">
Heyard, R., Pawel, S., Frese, J., Voelkl, B., Würbel, H., McCann, S., Held, L., Wever, K. E., Hartmann, H., Townsin, L., &amp; Zellers, S. (2024). <em>A scoping review on metrics to quantify reproducibility: A multitude of questions leads to a multitude of metrics</em>. <a href="https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC">https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC</a>
</div>
<div id="ref-Higgins2002-fh" class="csl-entry" role="listitem">
Higgins, J. P. T., &amp; Thompson, S. G. (2002). Quantifying heterogeneity in a meta-analysis. <em>Statistics in Medicine</em>, <em>21</em>, 1539–1558. <a href="https://doi.org/10.1002/sim.1186">https://doi.org/10.1002/sim.1186</a>
</div>
<div id="ref-Lakens2018-ri" class="csl-entry" role="listitem">
Lakens, D., Scheel, A. M., &amp; Isager, P. M. (2018). Equivalence testing for psychological research: A tutorial. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>, 259–269. <a href="https://doi.org/10.1177/2515245918770963">https://doi.org/10.1177/2515245918770963</a>
</div>
<div id="ref-Ly2019-ow" class="csl-entry" role="listitem">
Ly, A., Etz, A., Marsman, M., &amp; Wagenmakers, E.-J. (2019). Replication bayes factors from evidence updating. <em>Behavior Research Methods</em>, <em>51</em>, 2498–2508. <a href="https://doi.org/10.3758/s13428-018-1092-x">https://doi.org/10.3758/s13428-018-1092-x</a>
</div>
<div id="ref-Machery2020-sv" class="csl-entry" role="listitem">
Machery, E. (2020). What is a replication? <em>Philosophy of Science</em>, <em>87</em>, 545–567. <a href="https://doi.org/10.1086/709701">https://doi.org/10.1086/709701</a>
</div>
<div id="ref-Marin2010-oh" class="csl-entry" role="listitem">
Marin, J.-M., &amp; Robert, C. P. (2010). On resolving the savage–dickey paradox. <em>Electronic Journal of Statistics</em>, <em>4</em>, 643–654. <a href="https://doi.org/10.1214/10-EJS564">https://doi.org/10.1214/10-EJS564</a>
</div>
<div id="ref-Mathur2019-vh" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2019). Challenges and suggestions for defining replication "success" when effects may be heterogeneous: Comment on hedges and schauer (2019). <em>Psychological Methods</em>, <em>24</em>, 571–575. <a href="https://doi.org/10.1037/met0000223">https://doi.org/10.1037/met0000223</a>
</div>
<div id="ref-Mathur2020-nw" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2020). New statistical metrics for multisite replication projects. <em>Journal of the Royal Statistical Society. Series A, (Statistics in Society)</em>, <em>183</em>, 1145–1166. <a href="https://doi.org/10.1111/rssa.12572">https://doi.org/10.1111/rssa.12572</a>
</div>
<div id="ref-Rouder2009-jh" class="csl-entry" role="listitem">
Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G. (2009). Bayesian t tests for accepting and rejecting the null hypothesis. <em>Psychonomic Bulletin &amp; Review</em>, <em>16</em>, 225–237. <a href="https://doi.org/10.3758/PBR.16.2.225">https://doi.org/10.3758/PBR.16.2.225</a>
</div>
<div id="ref-Royall1997-ye" class="csl-entry" role="listitem">
Royall, R. M. (1997). <em>Statistical evidence: A likelihood paradigm</em> (Vol. 71). Chapman &amp; Hall, London.
</div>
<div id="ref-Schauer2022-mj" class="csl-entry" role="listitem">
Schauer, J. M. (2022). Replicability and meta-analysis. In W. O’Donohue, A. Masuda, &amp; S. Lilienfeld (Eds.), <em>Avoiding questionable research practices in applied psychology</em> (pp. 301–342). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-031-04968-2_14">https://doi.org/10.1007/978-3-031-04968-2_14</a>
</div>
<div id="ref-Schauer2020-tw" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2020). Assessing heterogeneity and power in replications of psychological experiments. <em>Psychological Bulletin</em>, <em>146</em>, 701–719. <a href="https://doi.org/10.1037/bul0000232">https://doi.org/10.1037/bul0000232</a>
</div>
<div id="ref-Schauer2021-ja" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2021). Reconsidering statistical methods for assessing replication. <em>Psychological Methods</em>, <em>26</em>, 127–139. <a href="https://doi.org/10.1037/met0000302">https://doi.org/10.1037/met0000302</a>
</div>
<div id="ref-Schmidt2014-kw" class="csl-entry" role="listitem">
Schmidt, F. L., &amp; Hunter, J. E. (2014). <em>Methods of meta-analysis: Correcting error and bias in research findings</em> (3rd ed.). SAGE Publications. <a href="https://doi.org/10.4135/9781483398105">https://doi.org/10.4135/9781483398105</a>
</div>
<div id="ref-Simonsohn2015-kg" class="csl-entry" role="listitem">
Simonsohn, U. (2015). Small telescopes: Detectability and the evaluation of replication results: Detectability and the evaluation of replication results. <em>Psychological Science</em>, <em>26</em>, 559–569. <a href="https://doi.org/10.1177/0956797614567341">https://doi.org/10.1177/0956797614567341</a>
</div>
<div id="ref-The-Brazilian-Reproducibility-Initiative2025-iw" class="csl-entry" role="listitem">
The Brazilian Reproducibility Initiative, Amaral, O. B., Carneiro, C. F. D., Neves, K., Sampaio, A. P. W., Gomes, B. V., Abreu, M. B. de, Tan, P. B., Mota, G. P. S., Goulart, R. N., Fernandes, N. R. de S., Linhares, J. H., Ibelli, A. M. G., Sebollela, A., Andricopulo, A. D., Carvalho, A. A. V. de, Silva, A. P. e., Souza, A. S. O., Lima, A. C. C. de, … Altei, W. F. (2025). Estimating the replicability of brazilian biomedical science. <em>bioRxiv</em>, 2025.04.02.645026. <a href="https://doi.org/10.1101/2025.04.02.645026">https://doi.org/10.1101/2025.04.02.645026</a>
</div>
<div id="ref-Valentine2011-yq" class="csl-entry" role="listitem">
Valentine, J. C., Biglan, A., Boruch, R. F., Castro, F. G., Collins, L. M., Flay, B. R., Kellam, S., Mościcki, E. K., &amp; Schinke, S. P. (2011). Replication in prevention science. <em>Prevention Science: The Official Journal of the Society for Prevention Research</em>, <em>12</em>, 103–117. <a href="https://doi.org/10.1007/s11121-011-0217-6">https://doi.org/10.1007/s11121-011-0217-6</a>
</div>
<div id="ref-Verhagen2014-tx" class="csl-entry" role="listitem">
Verhagen, J., &amp; Wagenmakers, E.-J. (2014). Bayesian tests to quantify the result of a replication attempt. <em>Journal of Experimental Psychology. General</em>, <em>143</em>, 1457–1475. <a href="https://doi.org/10.1037/a0036731">https://doi.org/10.1037/a0036731</a>
</div>
<div id="ref-Wagenmakers2010-fj" class="csl-entry" role="listitem">
Wagenmakers, E.-J., Lodewyckx, T., Kuriyal, H., &amp; Grasman, R. (2010). Bayesian hypothesis testing for psychologists: A tutorial on the savage–dickey method. <em>Cognitive Psychology</em>, <em>60</em>, 158–189. <a href="https://doi.org/10.1016/j.cogpsych.2009.12.001">https://doi.org/10.1016/j.cogpsych.2009.12.001</a>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The name of the method corresponds to the first column of the online table<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>see also <span class="citation" data-cites="Ly2019-ow">Ly et al. (<a href="#ref-Ly2019-ow" role="doc-biblioref">2019</a>)</span> for an improvement<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/chapter3.html" class="pagination-link" aria-label="Probability of Replication">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability of Replication</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter5.html" class="pagination-link" aria-label="Meta-analysis and publication bias">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/filippogambarota/replicability-book/edit/main/chapters/chapter4.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/filippogambarota/replicability-book/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>