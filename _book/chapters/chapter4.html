<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Statistical methods for replication assessment – The three Rs of trustworthy science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter5.html" rel="next">
<link href="../chapters/chapter3.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d536d1a7baed4b06fb80168836a8c311.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/chapter4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">The three Rs of trustworthy science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is a replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Replicability and reproducibility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability of Replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Improving study robustness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Planning a replication study</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">4.2</span> Methods</a></li>
  <li><a href="#worth-mentioning" id="toc-worth-mentioning" class="nav-link" data-scroll-target="#worth-mentioning"><span class="header-section-number">4.3</span> Worth mentioning</a></li>
  <li><a href="#for-me-to-check" id="toc-for-me-to-check" class="nav-link" data-scroll-target="#for-me-to-check"><span class="header-section-number">4.4</span> for me to check</a></li>
  <li><a href="#simulating-data" id="toc-simulating-data" class="nav-link" data-scroll-target="#simulating-data"><span class="header-section-number">4.5</span> Simulating data</a></li>
  <li><a href="#what-is-considered-a-successful-or-unsuccessful-replication" id="toc-what-is-considered-a-successful-or-unsuccessful-replication" class="nav-link" data-scroll-target="#what-is-considered-a-successful-or-unsuccessful-replication"><span class="header-section-number">5</span> What is considered a successful or unsuccessful replication?</a></li>
  <li>
<a href="#some-random-concepts" id="toc-some-random-concepts" class="nav-link" data-scroll-target="#some-random-concepts"><span class="header-section-number">6</span> Some (random) concepts</a>
  <ul class="collapse">
<li><a href="#some-random-concepts-1" id="toc-some-random-concepts-1" class="nav-link" data-scroll-target="#some-random-concepts-1"><span class="header-section-number">6.1</span> Some (random) concepts</a></li>
  <li><a href="#difficulty-in-drawing-conclusions-from-replications" id="toc-difficulty-in-drawing-conclusions-from-replications" class="nav-link" data-scroll-target="#difficulty-in-drawing-conclusions-from-replications"><span class="header-section-number">6.2</span> Difficulty in drawing conclusions from replications</a></li>
  <li><a href="#exact-and-conceptual-replications" id="toc-exact-and-conceptual-replications" class="nav-link" data-scroll-target="#exact-and-conceptual-replications"><span class="header-section-number">6.3</span> Exact and Conceptual replications</a></li>
  <li><a href="#direct-and-conceptual-replications-schmidt2009-mq" id="toc-direct-and-conceptual-replications-schmidt2009-mq" class="nav-link" data-scroll-target="#direct-and-conceptual-replications-schmidt2009-mq"><span class="header-section-number">6.4</span> Direct and Conceptual replications <span class="citation" data-cites="Schmidt2009-mq">(S. Schmidt, 2009)</span></a></li>
  <li><a href="#exact-replications-are-often-impossible-schmidt2009-mq" id="toc-exact-replications-are-often-impossible-schmidt2009-mq" class="nav-link" data-scroll-target="#exact-replications-are-often-impossible-schmidt2009-mq"><span class="header-section-number">6.5</span> Exact replications are (often) impossible <span class="citation" data-cites="Schmidt2009-mq">(S. Schmidt, 2009)</span></a></li>
  <li><a href="#as-exact-as-possible" id="toc-as-exact-as-possible" class="nav-link" data-scroll-target="#as-exact-as-possible"><span class="header-section-number">6.6</span> As Exact as possible…</a></li>
  </ul>
</li>
  <li>
<a href="#what-we-are-going-to-do" id="toc-what-we-are-going-to-do" class="nav-link" data-scroll-target="#what-we-are-going-to-do"><span class="header-section-number">7</span> What we are going to do?</a>
  <ul class="collapse">
<li><a href="#what-we-are-not-going-to-do" id="toc-what-we-are-not-going-to-do" class="nav-link" data-scroll-target="#what-we-are-not-going-to-do"><span class="header-section-number">7.1</span> What we are (not) going to do?</a></li>
  </ul>
</li>
  <li>
<a href="#overall-model-and-notation" id="toc-overall-model-and-notation" class="nav-link" data-scroll-target="#overall-model-and-notation"><span class="header-section-number">8</span> Overall model and notation</a>
  <ul class="collapse">
<li><a href="#overall-model-and-notation-1" id="toc-overall-model-and-notation-1" class="nav-link" data-scroll-target="#overall-model-and-notation-1"><span class="header-section-number">8.1</span> Overall model and notation</a></li>
  <li><a href="#overall-model-and-notation-2" id="toc-overall-model-and-notation-2" class="nav-link" data-scroll-target="#overall-model-and-notation-2"><span class="header-section-number">8.2</span> Overall model and notation</a></li>
  <li><a href="#simulating-for-learning" id="toc-simulating-for-learning" class="nav-link" data-scroll-target="#simulating-for-learning"><span class="header-section-number">8.3</span> Simulating for learning</a></li>
  <li><a href="#simulating-for-learning-1" id="toc-simulating-for-learning-1" class="nav-link" data-scroll-target="#simulating-for-learning-1"><span class="header-section-number">8.4</span> Simulating for learning</a></li>
  <li><a href="#simulating-for-learning-2" id="toc-simulating-for-learning-2" class="nav-link" data-scroll-target="#simulating-for-learning-2"><span class="header-section-number">8.5</span> Simulating for learning</a></li>
  <li><a href="#simulating-for-learning-an-example" id="toc-simulating-for-learning-an-example" class="nav-link" data-scroll-target="#simulating-for-learning-an-example"><span class="header-section-number">8.6</span> Simulating for learning, an example</a></li>
  <li><a href="#exact-vs-approximate-replication" id="toc-exact-vs-approximate-replication" class="nav-link" data-scroll-target="#exact-vs-approximate-replication"><span class="header-section-number">8.7</span> Exact vs Approximate replication</a></li>
  <li><a href="#types-of-agreement" id="toc-types-of-agreement" class="nav-link" data-scroll-target="#types-of-agreement"><span class="header-section-number">8.8</span> Types of agreement</a></li>
  <li><a href="#falsification-vs-consistency" id="toc-falsification-vs-consistency" class="nav-link" data-scroll-target="#falsification-vs-consistency"><span class="header-section-number">8.9</span> Falsification vs Consistency</a></li>
  <li><a href="#the-big-picture" id="toc-the-big-picture" class="nav-link" data-scroll-target="#the-big-picture"><span class="header-section-number">8.10</span> The big picture</a></li>
  </ul>
</li>
  <li>
<a href="#statistical-methods" id="toc-statistical-methods" class="nav-link" data-scroll-target="#statistical-methods"><span class="header-section-number">9</span> Statistical Methods</a>
  <ul class="collapse">
<li><a href="#statistical-methods-disclaimer-schauer2021-ja" id="toc-statistical-methods-disclaimer-schauer2021-ja" class="nav-link" data-scroll-target="#statistical-methods-disclaimer-schauer2021-ja"><span class="header-section-number">9.1</span> Statistical Methods, disclaimer <span class="citation" data-cites="Schauer2021-ja">(Schauer &amp; Hedges, 2021)</span></a></li>
  </ul>
</li>
  <li>
<a href="#frequentists-methods" id="toc-frequentists-methods" class="nav-link" data-scroll-target="#frequentists-methods"><span class="header-section-number">10</span> Frequentists Methods</a>
  <ul class="collapse">
<li><a href="#vote-counting-based-on-significance-or-direction" id="toc-vote-counting-based-on-significance-or-direction" class="nav-link" data-scroll-target="#vote-counting-based-on-significance-or-direction"><span class="header-section-number">10.1</span> Vote Counting based on significance or direction</a></li>
  <li><a href="#example-with-simulated-data" id="toc-example-with-simulated-data" class="nav-link" data-scroll-target="#example-with-simulated-data"><span class="header-section-number">10.2</span> Example with simulated data</a></li>
  <li><a href="#example-with-simulated-data-1" id="toc-example-with-simulated-data-1" class="nav-link" data-scroll-target="#example-with-simulated-data-1"><span class="header-section-number">10.3</span> Example with simulated data</a></li>
  <li><a href="#vote-counting-extreme-example" id="toc-vote-counting-extreme-example" class="nav-link" data-scroll-target="#vote-counting-extreme-example"><span class="header-section-number">10.4</span> Vote Counting, extreme example</a></li>
  <li><a href="#confidence-interval-replication-within-original" id="toc-confidence-interval-replication-within-original" class="nav-link" data-scroll-target="#confidence-interval-replication-within-original"><span class="header-section-number">10.5</span> Confidence Interval, replication within original</a></li>
  <li><a href="#confidence-interval-replication-within-original-1" id="toc-confidence-interval-replication-within-original-1" class="nav-link" data-scroll-target="#confidence-interval-replication-within-original-1"><span class="header-section-number">10.6</span> Confidence Interval, replication within original</a></li>
  <li><a href="#confidence-interval-original-within-replication" id="toc-confidence-interval-original-within-replication" class="nav-link" data-scroll-target="#confidence-interval-original-within-replication"><span class="header-section-number">10.7</span> Confidence Interval, original within replication</a></li>
  <li><a href="#prediction-interval-pi-what-to-expect-from-a-replication" id="toc-prediction-interval-pi-what-to-expect-from-a-replication" class="nav-link" data-scroll-target="#prediction-interval-pi-what-to-expect-from-a-replication"><span class="header-section-number">10.8</span> Prediction interval (PI), what to expect from a replication</a></li>
  <li><a href="#prediction-interval-pi-what-to-expect-from-a-replication-1" id="toc-prediction-interval-pi-what-to-expect-from-a-replication-1" class="nav-link" data-scroll-target="#prediction-interval-pi-what-to-expect-from-a-replication-1"><span class="header-section-number">10.9</span> Prediction interval (PI), what to expect from a replication</a></li>
  <li><a href="#prediction-interval-pi-what-to-expect-from-a-replication-2" id="toc-prediction-interval-pi-what-to-expect-from-a-replication-2" class="nav-link" data-scroll-target="#prediction-interval-pi-what-to-expect-from-a-replication-2"><span class="header-section-number">10.10</span> Prediction interval (PI), what to expect from a replication</a></li>
  <li><a href="#mathur-vanderweele--mathur2020-nw-p_orig" id="toc-mathur-vanderweele--mathur2020-nw-p_orig" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-p_orig"><span class="header-section-number">10.11</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(p_{orig}\)</span></a></li>
  <li><a href="#mathur-vanderweele--mathur2020-nw-hat-p_-0" id="toc-mathur-vanderweele--mathur2020-nw-hat-p_-0" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-hat-p_-0"><span class="header-section-number">10.12</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(\hat P_{&gt; 0}\)</span></a></li>
  <li><a href="#mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" id="toc-mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" class="nav-link" data-scroll-target="#mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q"><span class="header-section-number">10.13</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(2020)</span> <span class="math inline">\(\hat P_{\gtrless q*}\)</span></a></li>
  <li><a href="#combining-original-and-replications" id="toc-combining-original-and-replications" class="nav-link" data-scroll-target="#combining-original-and-replications"><span class="header-section-number">10.14</span> Combining original and replications</a></li>
  <li><a href="#q-statistics" id="toc-q-statistics" class="nav-link" data-scroll-target="#q-statistics"><span class="header-section-number">10.15</span> Q Statistics</a></li>
  <li><a href="#q-statistics-1" id="toc-q-statistics-1" class="nav-link" data-scroll-target="#q-statistics-1"><span class="header-section-number">10.16</span> Q Statistics</a></li>
  <li><a href="#q-statistics-2" id="toc-q-statistics-2" class="nav-link" data-scroll-target="#q-statistics-2"><span class="header-section-number">10.17</span> Q Statistics</a></li>
  <li><a href="#q-statistics-3" id="toc-q-statistics-3" class="nav-link" data-scroll-target="#q-statistics-3"><span class="header-section-number">10.18</span> Q Statistics</a></li>
  <li><a href="#q-statistics-for-approximate-replication" id="toc-q-statistics-for-approximate-replication" class="nav-link" data-scroll-target="#q-statistics-for-approximate-replication"><span class="header-section-number">10.19</span> Q Statistics for approximate replication</a></li>
  <li><a href="#q-statistics-for-approximate-replication-1" id="toc-q-statistics-for-approximate-replication-1" class="nav-link" data-scroll-target="#q-statistics-for-approximate-replication-1"><span class="header-section-number">10.20</span> Q Statistics for approximate replication</a></li>
  <li><a href="#small-telescopes-simonsohn2015-kg" id="toc-small-telescopes-simonsohn2015-kg" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg"><span class="header-section-number">10.21</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  <li><a href="#small-telescopes-simonsohn2015-kg-1" id="toc-small-telescopes-simonsohn2015-kg-1" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg-1"><span class="header-section-number">10.22</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  <li><a href="#small-telescopes-simonsohn2015-kg-2" id="toc-small-telescopes-simonsohn2015-kg-2" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg-2"><span class="header-section-number">10.23</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  <li><a href="#small-telescopes-simonsohn2015-kg-3" id="toc-small-telescopes-simonsohn2015-kg-3" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg-3"><span class="header-section-number">10.24</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  <li><a href="#small-telescopes-simonsohn2015-kg-4" id="toc-small-telescopes-simonsohn2015-kg-4" class="nav-link" data-scroll-target="#small-telescopes-simonsohn2015-kg-4"><span class="header-section-number">10.25</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(Simonsohn, 2015)</span></a></li>
  </ul>
</li>
  <li>
<a href="#bayesian-methods" id="toc-bayesian-methods" class="nav-link" data-scroll-target="#bayesian-methods"><span class="header-section-number">11</span> Bayesian Methods</a>
  <ul class="collapse">
<li><a href="#bayes-factor" id="toc-bayes-factor" class="nav-link" data-scroll-target="#bayes-factor"><span class="header-section-number">11.1</span> Bayes Factor</a></li>
  <li><a href="#bayesian-inference" id="toc-bayesian-inference" class="nav-link" data-scroll-target="#bayesian-inference"><span class="header-section-number">11.2</span> Bayesian inference</a></li>
  <li><a href="#bayesian-inference-1" id="toc-bayesian-inference-1" class="nav-link" data-scroll-target="#bayesian-inference-1"><span class="header-section-number">11.3</span> Bayesian inference</a></li>
  <li><a href="#bayesian-inference-2" id="toc-bayesian-inference-2" class="nav-link" data-scroll-target="#bayesian-inference-2"><span class="header-section-number">11.4</span> Bayesian inference</a></li>
  <li><a href="#bayesian-inference-3" id="toc-bayesian-inference-3" class="nav-link" data-scroll-target="#bayesian-inference-3"><span class="header-section-number">11.5</span> Bayesian inference</a></li>
  <li><a href="#bayesian-inference-4" id="toc-bayesian-inference-4" class="nav-link" data-scroll-target="#bayesian-inference-4"><span class="header-section-number">11.6</span> Bayesian inference</a></li>
  <li><a href="#bayes-factor-1" id="toc-bayes-factor-1" class="nav-link" data-scroll-target="#bayes-factor-1"><span class="header-section-number">11.7</span> Bayes Factor</a></li>
  <li><a href="#bayes-factor-using-the-sdr" id="toc-bayes-factor-using-the-sdr" class="nav-link" data-scroll-target="#bayes-factor-using-the-sdr"><span class="header-section-number">11.8</span> Bayes Factor using the SDR</a></li>
  <li><a href="#bayes-factor-using-the-sdr-example" id="toc-bayes-factor-using-the-sdr-example" class="nav-link" data-scroll-target="#bayes-factor-using-the-sdr-example"><span class="header-section-number">11.9</span> Bayes Factor using the SDR, Example:</a></li>
  <li><a href="#bayes-factor-using-the-sdr-example-1" id="toc-bayes-factor-using-the-sdr-example-1" class="nav-link" data-scroll-target="#bayes-factor-using-the-sdr-example-1"><span class="header-section-number">11.10</span> Bayes Factor using the SDR, Example:</a></li>
  <li><a href="#verhagen2014-tx-model" id="toc-verhagen2014-tx-model" class="nav-link" data-scroll-target="#verhagen2014-tx-model"><span class="header-section-number">11.11</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (2014)</span> model</a></li>
  <li><a href="#verhagen2014-tx-model-1" id="toc-verhagen2014-tx-model-1" class="nav-link" data-scroll-target="#verhagen2014-tx-model-1"><span class="header-section-number">11.12</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (2014)</span> model</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">11.13</span> Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="header-section-number">11.14</span> Example</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span class="header-section-number">11.15</span> Example</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3"><span class="header-section-number">11.16</span> Example</a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4"><span class="header-section-number">11.17</span> Example</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5"><span class="header-section-number">11.18</span> Example</a></li>
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6"><span class="header-section-number">11.19</span> Example</a></li>
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7"><span class="header-section-number">11.20</span> Example</a></li>
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8"><span class="header-section-number">11.21</span> Example</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">11.22</span> References</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- TODO:  table with method (rows), (colums)properties, id exact or extension, bayesian or not, open source code, citation --><p><span class="citation" data-cites="Anderson2024-cx">Anderson &amp; Kelley (<a href="#ref-Anderson2024-cx" role="doc-biblioref">2024</a>)</span> suggests that also the perspective of supporting the null hypothesis should be taken into account especially when we are really skeptical about the initial results. We want to replicate an effect to see the reliability, maybe better estimating the true effect with a larger sample (taking into account the inflation of the original effect) but we could also think that the original effect is a false positive and we want to do the replication to see if the null hypothesis is supported. The bayes factor approach by <span class="citation" data-cites="Ly2019-ow">Ly et al. (<a href="#ref-Ly2019-ow" role="doc-biblioref">2019</a>)</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> is exactly about this. also equivalence testing is useful</p>
<!-- TODO check the final table and the overall structure of the paper because it's great also the references are amazing -->
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Statistical Methods]
    A --&gt; B[Sign/Direction]
    B --&gt; C[Vote Counting]
    A --&gt; D[Confidence/Prediction Interval]
    D --&gt; E[CI/PI original/replication]
    D --&gt; F[Small Telescope]
    A --&gt; G[Meta-analysis]
    G --&gt; H[Equal and Random-effects]
    G --&gt; h[cumulative meta analysis]
    G --&gt; I[Q Statistics]
    A --&gt; J[Bayesian Methods]
    J --&gt; K[Replication Bayes Factor]
    J --&gt; z[Pawel model]
    J --&gt; a[Skeptical p value]
    J --&gt; b[Skeptical prior etz]
</pre>
</div>
<p></p>
</div>
</div>
</div>
<!-- TODO the idea here is also to keep track of the methods providing a clear overview -->
<section id="introduction" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">4.1</span> Introduction</h2>
<p>In the previous chapters we introduced replication from a statistical and theoretical point of view. We purposely omitted defining the outcome of a replication study to dedicate an entire chapter about this part. Similarly to the multiple definitions problem there are several statistical measures for the replication assessment. There are also multiple ways to propose a classification but we could indentify:</p>
<!-- 
propose some kind of classification/taxonomy here. for example:

- linked or not to a definition
- aim of the metric (e.g., testing or estimating)
- statistical approach (bayesian, frequentists, etc.)
- practical limitations (only for one-to-one/many design, only with raw data, etc.)
-->
<p>In addition to the multitude of methods, the field of replication measures is relatively new and keep growing proposing new metrics, simulation studies, and comparisons between methods. A review work could be in principle the best option but this is not feasible and also useful for a very active research area. There is an amazing project proposed by <span class="citation" data-cites="Heyard2024-hv">Heyard et al. (<a href="#ref-Heyard2024-hv" role="doc-biblioref">2024</a>)</span> where an extensive systematic review is supported by an online and keep up-to-date database with all replication measures organized and classified according to a common methodology. The authors reviewed roughly 50 different measures. The database is avaliable at the following link <a href="http://rachelheyard.com/reproducibility_metrics/">http://rachelheyard.com/reproducibility_metrics/</a>.</p>
<p>We decided to make a selection of methods from the database according to the following criteria:</p>
<ul>
<li>for similar methods we keep the most recent and general version. For example, if a method <span class="math inline">\(x\)</span> riginally developed for <em>one-to-one</em> replication designs has been extended to cover also <em>one-to-many</em> designs we will present the latter.</li>
<li>we select both bayesian and frequentist methods</li>
<li>we selected methods more related to inference and also methods more focused on estimation of the effect size</li>
<li>we selected methods that are not linked to a specific research area or topic. For example in the database there are methods for <em>voxels</em> in fMRI research or methods for metrology.</li>
</ul></section><section id="methods" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="methods">
<span class="header-section-number">4.2</span> Methods</h2>
<ul>
<li>Prediction interval: replication effect in original 95% prediction interval</li>
<li>Proportion of population effects agreeing in direction with the original</li>
<li>Bayes Factor: Independent Jeffreys-Zellner-Siow BF test (default BF)</li>
<li>Bayes Factor: Equality-of-effect- size BF test</li>
<li>Bayes Factor: Fixed-effect meta-analysis BF Test (Meta-analytic BF) [this probably just a bayesian meta-analysis]</li>
<li>Bayesian Evidence Synthesis (variant: Meta-Analysis Model-based Assessment of replicability (MAMBA))</li>
<li>Bayesian mixture model for reproducibility rate</li>
<li>Confidence interval: original effect in replication 95% CI (Coverage)</li>
<li>Confidence interval: replication effect in original 95%CI (Capture probability)</li>
<li>Continuously cumulating meta-analytic approach</li>
<li>Correspondence test</li>
<li>Credibility analysis (Reverse-Bayes, probability of credibility, probability of replicating an effect)</li>
<li>Design analysis [type-m/s]</li>
<li>Equivalence testing (TOST (two one-sided tests))</li>
<li>Likelihood-based approach for reproducibility (Likelihood-ratio) [similar to bf?]</li>
<li>Minimum effect testing [similar to small telescope?]</li>
<li>P interval</li>
<li>Prediction interval: replication effect in original 95% prediction interval</li>
<li>Replication Bayes factor [already included]</li>
<li>Sceptical <span class="math inline">\(p\)</span>-value (versions: nominal sceptical <span class="math inline">\(p\)</span>-value, golden sceptical <span class="math inline">\(p\)</span>-value, controlled sceptical <span class="math inline">\(p\)</span>-value)</li>
<li>Sceptical Bayes Factor (Reverse-Bayes)</li>
<li>Small Telescopes</li>
<li>Snapshot hybrid (Bayesian meta-analysis)</li>
<li>Z-curve (Exact replication rate, p-curves)</li>
<li>Consistency of original with replications, <span class="math inline">\(P_{\mbox{orig}}\)</span>
</li>
<li>I squared - <span class="math inline">\(I^2\)</span> (Estimation of effect variance) [this can be togheter with Q and meta-analysis]</li>
<li>Proportion of population effects agreeing in direction with the original, <span class="math inline">\(\hat{P}_{&gt;0}\)</span>
</li>
<li>Bland-Altman Plot (Agreement measures)</li>
<li>Correlation between effects</li>
<li>Difference in effect size (Q-statistic, (meta-analytic) Q-test, difference test, Tukey’s post-hoc honest significant difference test)</li>
<li>Externally standardized residuals [idea di calcolare tipo m su effetto stimato]</li>
<li>Meta-analysis</li>
<li>Significance criterion (vote counting, two-trials rule, regulatory agreement)</li>
</ul></section><section id="worth-mentioning" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="worth-mentioning">
<span class="header-section-number">4.3</span> Worth mentioning</h2>
<ul>
<li>RepliCATS [subjective elicitation]</li>
<li>Text-based machine learning model to estimate reproducibility</li>
</ul></section><section id="for-me-to-check" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="for-me-to-check">
<span class="header-section-number">4.4</span> for me to check</h2>
<ul>
<li>Causal replication framework</li>
</ul></section><section id="simulating-data" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="simulating-data">
<span class="header-section-number">4.5</span> Simulating data</h2>
<p>In light of the formalization presented in Chapter XXX and XXX we can formulate a general method to simulate data from the generative model (<!-- TODO insert citation to figures lavagna e pavel -->).</p>
<!-- TODO introduce here the notation for effect size and sampling variance -->
<p>To simulate a single study we can define the true effect size parameter <span class="math inline">\(\theta_r\)</span> and then generate two independent groups sampled from two normal distributions with variance equal to one. One of the distribution is centered on zero while the other distribution is centered on <span class="math inline">\(\theta_r\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="va">n0</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">theta</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span> <span class="co"># this is the effect size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.02011754</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span> <span class="co"># this is the sampling variability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05565741</code></pre>
</div>
</div>
<p>Now we can simply iterate the process for <span class="math inline">\(R\)</span> studies to create a series of replications with a common true parameter <span class="math inline">\(\theta\)</span>. We can also generate a more realistic set of sample sizes sampling from a probability distribution (e.g., Poisson)</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">n0</span> <span class="op">&lt;-</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">R</span>, <span class="fl">40</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">theta</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span></span>
<span>    <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">R</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">yi</span>, <span class="va">vi</span>, <span class="va">n0</span>, <span class="va">n1</span><span class="op">)</span></span>
<span><span class="va">sim</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id          yi         vi n0 n1
1   0  0.01476904 0.05239931 38 38
2   1 -0.02142140 0.04549403 51 51
3   2  0.36376339 0.03300727 49 49
4   3  0.39667421 0.05930267 44 44
5   4  0.26316570 0.05476932 37 37
6   5  0.14944415 0.04993779 45 45
7   6  0.34185438 0.03761737 46 46
8   7  0.45372498 0.05433267 46 46
9   8  0.50300280 0.05410981 40 40
10  9  0.37954551 0.06210466 40 40</code></pre>
</div>
</div>
<p>Then, if we want to include variability in the true effects as in the extension framework we can simply sample <span class="math inline">\(R\)</span> <span class="math inline">\(\theta\)</span>’s from a normal distribution with variability <span class="math inline">\(\tau^2\)</span>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   id           yi         vi        theta n0 n1
1   0  0.003218650 0.03593693 -0.126228824 48 48
2   1  0.740607983 0.04974657  0.700254299 47 47
3   2  0.901889954 0.03934327  0.897036878 37 37
4   3  0.008334652 0.04281873  0.222999103 38 38
5   4  0.150974265 0.04332951  0.383630820 46 46
6   5  0.414119571 0.05491717  0.444614032 37 37
7   6 -0.374487466 0.06629007 -0.238958229 32 32
8   7  0.201141441 0.05602005  0.216779790 37 37
9   8  0.466078981 0.04478137  0.411308942 49 49
10  9 -0.196622204 0.04875768  0.002872426 37 37</code></pre>
</div>
</div>
<p>Then we can put everything in a function that can be used to simulate different scenarios.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_meta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R</span>, <span class="va">mu</span>, <span class="va">tau2</span>, <span class="va">n0</span>, <span class="va">n1</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">conf.level</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n0</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">!=</span> <span class="va">R</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n0</span><span class="op">)</span> <span class="op">!=</span> <span class="va">R</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n0</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"n1 and n0 need to be of length 1 or R"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">R</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n0</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n0</span>, <span class="va">R</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">mu</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">yi</span> <span class="op">&lt;-</span> <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">R</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span></span>
<span>        <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y0</span><span class="op">)</span><span class="op">/</span><span class="va">n0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">R</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">yi</span>, <span class="va">vi</span>, <span class="va">theta</span>, <span class="va">n0</span>, <span class="va">n1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># compute other statistics</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span> <span class="co"># standard error</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">zi</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">yi</span> <span class="op">/</span> <span class="va">sim</span><span class="op">$</span><span class="va">sei</span> <span class="co"># test statistics</span></span>
<span>    <span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">conf.level</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">ci.lb</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">yi</span> <span class="op">-</span> <span class="va">sim</span><span class="op">$</span><span class="va">sei</span> <span class="op">*</span> <span class="va">tc</span></span>
<span>    <span class="va">sim</span><span class="op">$</span><span class="va">ci.ub</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">yi</span> <span class="op">+</span> <span class="va">sim</span><span class="op">$</span><span class="va">sei</span> <span class="op">*</span> <span class="va">tc</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sim_meta</span><span class="op">(</span>R <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">0.3</span>, tau2 <span class="op">=</span> <span class="fl">0.1</span>, n0 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id          yi         vi       theta n0 n1       sei         zi       ci.lb
1   0  0.12685160 0.06650511 -0.04926811 30 30 0.2578858  0.4918905 -0.37859538
2   1  0.32214536 0.06410597  0.36172305 30 30 0.2531916  1.2723384 -0.17410099
3   2  0.57035399 0.07591139  0.80030468 30 30 0.2755202  2.0700984  0.03034427
4   3 -0.33659132 0.07222032 -0.03667565 30 30 0.2687384 -1.2524869 -0.86330888
5   4  0.88320631 0.07125207  0.62179008 30 30 0.2669308  3.3087460  0.36003149
6   5 -0.08357788 0.06610357  0.02818698 30 30 0.2571061 -0.3250715 -0.58749667
7   6  0.45593954 0.05151685  0.29803240 30 30 0.2269732  2.0087811  0.01108017
8   7  0.16901371 0.06837960  0.22246040 30 30 0.2614949  0.6463364 -0.34350695
9   8  0.03551535 0.04562731  0.02705788 30 30 0.2136055  0.1662661 -0.38314372
10  9  0.05060030 0.05997280  0.02772444 30 30 0.2448934  0.2066217 -0.42938202
       ci.ub
1  0.6322986
2  0.8183917
3  1.1103637
4  0.1901262
5  1.4063811
6  0.4203409
7  0.9007989
8  0.6815344
9  0.4541744
10 0.5305826</code></pre>
</div>
</div>
<p>The function can be easily extended for using different effect size measures or study designs but the overall idea is the same.</p>
</section><section id="what-is-considered-a-successful-or-unsuccessful-replication" class="level1 question smaller" data-number="5"><h1 class="question smaller" data-number="5">
<span class="header-section-number">5</span> What is considered a successful or unsuccessful replication?</h1>
</section><section id="some-random-concepts" class="level1 section" data-number="6"><h1 class="section" data-number="6">
<span class="header-section-number">6</span> Some (random) concepts</h1>
<section id="some-random-concepts-1" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="some-random-concepts-1">
<span class="header-section-number">6.1</span> Some (random) concepts</h2>
<blockquote class="blockquote">
<p>Credibility of scientific claims is established with evidence for their replicability using new data <span class="citation" data-cites="Nosek2020-vh">(<a href="#ref-Nosek2020-vh" role="doc-biblioref">Nosek &amp; Errington, 2020</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>Replication is repeating a study’s procedure and observing whether the prior finding recurs <span class="citation" data-cites="Jeffreys1973-bp">(<a href="#ref-Jeffreys1973-bp" role="doc-biblioref">Jeffreys, 1973</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>Replication is a study for which any outcome would be considered diagnostic evidence about a claim from prior research <span class="citation" data-cites="Nosek2020-vh">(<a href="#ref-Nosek2020-vh" role="doc-biblioref">Nosek &amp; Errington, 2020</a>)</span>.</p>
</blockquote>
</section><section id="difficulty-in-drawing-conclusions-from-replications" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="difficulty-in-drawing-conclusions-from-replications">
<span class="header-section-number">6.2</span> Difficulty in drawing conclusions from replications</h2>
<p>Replication is often intended as <em>conditioned</em> to the original result. The original result could be a false positive or a biased result. Also the replication attempt could be a false positive or a false negative <span class="citation" data-cites="Nosek2020-vh">(<a href="#ref-Nosek2020-vh" role="doc-biblioref">Nosek &amp; Errington, 2020</a>)</span>.</p>
<p>. . .</p>
<blockquote class="blockquote">
<p>To be a replication, two things must be true. Outcomes consistent with a prior claim would increase confidence in the claim, and outcomes inconsistent with a prior claim would decrease confidence in the claim <span class="citation" data-cites="Nosek2020-vh">(<a href="#ref-Nosek2020-vh" role="doc-biblioref">Nosek &amp; Errington, 2020</a>)</span>.</p>
</blockquote>
<p>. . .</p>
<p>This is somehow similar with a Bayesian reasoning where evidence about a phenomenon is updated after collecting more data.</p>
</section><section id="exact-and-conceptual-replications" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="exact-and-conceptual-replications">
<span class="header-section-number">6.3</span> Exact and Conceptual replications</h2>
<p>Exact replications are commonly considered as the <em>gold-standard</em> but in practice (especially in Social Sciences, Psychology, etc.) are rare.</p>
<p>Let’s imagine, an original study <span class="math inline">\(y_{or}\)</span> finding a result.</p>
<ul>
<li>Replication <span class="math inline">\(y_{rep}\)</span> with the <em>exact</em> same method find the same result. <strong>Replication or not?</strong>
</li>
<li>Replication <span class="math inline">\(y_{rep}\)</span> with a <em>similar</em> method find the same result. <strong>Replication or not?</strong>
</li>
<li>Replication <span class="math inline">\(y_{rep}\)</span> with <em>similar</em> method did not find the same result. <strong>Replication or not?</strong>
</li>
</ul></section><section id="direct-and-conceptual-replications-schmidt2009-mq" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="direct-and-conceptual-replications-schmidt2009-mq">
<span class="header-section-number">6.4</span> Direct and Conceptual replications <span class="citation" data-cites="Schmidt2009-mq">(<a href="#ref-Schmidt2009-mq" role="doc-biblioref">S. Schmidt, 2009</a>)</span>
</h2>
<p>A <strong>direct replication</strong> is defined as the repetition of an experimental procedure.</p>
<p>A <strong>conceptual replication</strong> is defined as testing the same hypothesis with different methods.</p>
</section><section id="exact-replications-are-often-impossible-schmidt2009-mq" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="exact-replications-are-often-impossible-schmidt2009-mq">
<span class="header-section-number">6.5</span> Exact replications are (often) impossible <span class="citation" data-cites="Schmidt2009-mq">(<a href="#ref-Schmidt2009-mq" role="doc-biblioref">S. Schmidt, 2009</a>)</span>
</h2>
<p>Let’s imagine an extreme example: <strong>testing the physiological reaction to arousing situation</strong>:</p>
<ul>
<li>The original study: Experiment with prehistoric reacting to an arousing stimulus</li>
<li>The actual replication: It is possible to create the exact situation? Some phenomenon changes overtime, especially people-related phenomenon</li>
</ul>
<p>Exact replication is often not feasible. Even using the same experimental setup (<em>direct replication</em>) does not assure that we are studying the same phenomenon.</p>
</section><section id="as-exact-as-possible" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="as-exact-as-possible">
<span class="header-section-number">6.6</span> As Exact as possible…</h2>
<p>Even when an experiment use almost the same setup of the original study there is a source of unknown uncertainty. Which is the impact of a slightly change in the experimental setup on the actual result?</p>
<ul>
<li>A study on the human visual system: presenting stimuli on different monitors –&gt; small change with a huge impact</li>
<li>A study on consumer behavior: participant answering question using a smartphone or a computer –&gt; small but (maybe) irrelevant change</li>
</ul>
<p>How to evaluate the actual impact?</p>
</section></section><section id="what-we-are-going-to-do" class="level1 section" data-number="7"><h1 class="section" data-number="7">
<span class="header-section-number">7</span> What we are going to do?</h1>
<section id="what-we-are-not-going-to-do" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="what-we-are-not-going-to-do">
<span class="header-section-number">7.1</span> What we are (not) going to do?</h2>
<p>. . .</p>
<ul>
<li>I will not present a strictly theoretical and philosophical approach to replication (<em>what is a replication?</em>, <em>what is the most appropriate definition?</em>, etc.). But we can discuss it together :smile:!</li>
</ul>
<p>. . .</p>
<ul>
<li>According to the replication definitions and problems, we will explore some <strong>statistical</strong> methods to evaluate a replication success</li>
</ul></section></section><section id="overall-model-and-notation" class="level1 section" data-number="8"><h1 class="section" data-number="8">
<span class="header-section-number">8</span> Overall model and notation</h1>
<section id="overall-model-and-notation-1" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="overall-model-and-notation-1">
<span class="header-section-number">8.1</span> Overall model and notation</h2>
<p>For the purpose of notation and simplicity we can define a meta-analytical-based replication model <span class="citation" data-cites="Hedges2019-ry Schauer2021-ja Schauer2022-mj">(<a href="#ref-Hedges2019-ry" role="doc-biblioref">Hedges &amp; Schauer, 2019c</a>; <a href="#ref-Schauer2022-mj" role="doc-biblioref">Schauer, 2022</a>; <a href="#ref-Schauer2021-ja" role="doc-biblioref">Schauer &amp; Hedges, 2021</a>)</span></p>
<p><span class="math display">\[
y_i = \mu_{\theta} + \delta_i + \epsilon_i
\]</span></p>
<p><span class="math display">\[
\delta_i \sim \mathcal{N}(0, \tau^2)
\]</span></p>
<p><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\]</span></p>
</section><section id="overall-model-and-notation-2" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="overall-model-and-notation-2">
<span class="header-section-number">8.2</span> Overall model and notation</h2>
<ul>
<li>Thus each study <span class="math inline">\(i\)</span> out of the number of studies <span class="math inline">\(k\)</span>.</li>
<li>
<span class="math inline">\(\mu_{\theta}\)</span> is the real average effect and <span class="math inline">\(\theta = \mu_{\theta} + \delta_i\)</span> is the real effect of each study</li>
<li>
<span class="math inline">\(\tau^2\)</span> is the real variance among different studies. When <span class="math inline">\(\tau^2 = 0\)</span> there is no variability among studies</li>
<li>
<span class="math inline">\(\epsilon_i\)</span> are the sampling errors that depends on <span class="math inline">\(\sigma^2_i\)</span>, the sampling variability of each study</li>
<li>We define <span class="math inline">\(\theta_{orig}\)</span> (or <span class="math inline">\(\theta_1\)</span>) as the original study and <span class="math inline">\(\theta_{rep_i}\)</span> (with <span class="math inline">\(i\)</span> from 2 to <span class="math inline">\(k\)</span>) as the replication studies</li>
</ul></section><section id="simulating-for-learning" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="simulating-for-learning">
<span class="header-section-number">8.3</span> Simulating for learning</h2>
<p>For the examples we are going to simulate studies. Each study comes from a two-groups comparison on a continous outcome:</p>
<p><span class="math display">\[
\Delta = \overline{X_1} - \overline{X_2}
\]</span></p>
<p><span class="math display">\[
SE_{\Delta} = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}
\]</span></p>
<p>With <span class="math inline">\(X_{1_j} \sim \mathcal{N}(0, 1)\)</span> and <span class="math inline">\(X_{2_j} \sim \mathcal{N}(\Delta, 1)\)</span></p>
<p>continue…</p>
</section><section id="simulating-for-learning-1" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="simulating-for-learning-1">
<span class="header-section-number">8.4</span> Simulating for learning</h2>
<p>Thus our observed effect sizes <span class="math inline">\(y_i\)</span> is sampled from: <span class="math display">\[
y_i \sim \mathcal{N}(\mu_\theta, \tau^2 + \frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
<p>Where <span class="math inline">\(\frac{1}{n_1} + \frac{1}{n_2}\)</span> is the sampling variability (<span class="math inline">\(\sigma^2_i\)</span>).</p>
<p>The sampling variances are sampled from:</p>
<p><span class="math display">\[
\sigma_i^2 \sim \frac{\chi^2_{n_1 + n_2 - 2}}{n_1 + n_2 - 2} (\frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
</section><section id="simulating-for-learning-2" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="simulating-for-learning-2">
<span class="header-section-number">8.5</span> Simulating for learning</h2>
<p>Everything is implemented into the <code>sim_studies()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_studies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">theta</span>, <span class="va">tau2</span>, <span class="va">n0</span>, <span class="va">n1</span>, <span class="va">summary</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n0</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n0</span> <span class="op">+</span> <span class="va">n1</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n0</span> <span class="op">+</span> <span class="va">n1</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n0</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n1</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, sei <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vi</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">summary</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">summary_es</span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-for-learning-an-example" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="simulating-for-learning-an-example">
<span class="header-section-number">8.6</span> Simulating for learning, an example</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">10</span>, theta <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0.1</span>, n0 <span class="op">=</span> <span class="fl">30</span>, n1 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>          yi         vi       sei
1  0.6306046 0.07040783 0.2653447
2  0.3117390 0.06975489 0.2641115
3  1.3005623 0.06786796 0.2605148
4  0.6860657 0.05444358 0.2333315
5  0.5698951 0.07307152 0.2703174
6  1.1003673 0.08245891 0.2871566
7  1.4643882 0.05544487 0.2354673
8  0.1718634 0.07772710 0.2787958
9  0.3836479 0.06972331 0.2640517
10 0.3877660 0.07604360 0.2757600
</code></pre>
</div>
</section><section id="exact-vs-approximate-replication" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="exact-vs-approximate-replication">
<span class="header-section-number">8.7</span> Exact vs Approximate replication</h2>
<p>This distinction <span class="citation" data-cites="Brandt2014-da">(see <a href="#ref-Brandt2014-da" role="doc-biblioref">Brandt et al., 2014</a> for a different terminology)</span> refers to parameters <span class="math inline">\(\theta_i\)</span>. With <em>exact</em> are considering a case where:</p>
<p><span class="math display">\[
\theta_1 = \theta_2 = \theta_3, \dots, \theta_k
\]</span></p>
<p>Thus the true parameters of <span class="math inline">\(k\)</span> replication studies are the same. Thus the variability among true effects <span class="math inline">\(\tau^2 = 0\)</span>.</p>
<p>Similarly, due to (often not controllable) differences among experiments (i.e., lab, location, sample, etc.) we could expect a certain degree of variability <span class="math inline">\(\tau^2\)</span>. In other terms <span class="math inline">\(\tau^2 &lt; \tau^2_0\)</span> where <span class="math inline">\(\tau^2_0\)</span> is the maximum variability (that need to be defined). In this way studies are replicating:</p>
<p><span class="math display">\[
\theta_i \sim \mathcal{N}(\mu_\theta, \tau^2_0)
\]</span></p>
</section><section id="types-of-agreement" class="level2" data-number="8.8"><h2 data-number="8.8" class="anchored" data-anchor-id="types-of-agreement">
<span class="header-section-number">8.8</span> Types of agreement</h2>
<p>Coarsely, we can define a replication success when two or more studies obtain the “same” result. The definion of <em>sameness</em> it is crucial:</p>
<ul>
<li>same <em>sign</em> or direction: two studies (original and replication) evaluating the efficacy of a treatment have a positive effect <span class="math inline">\(sign(\theta_1) = sign(\theta_2)\)</span> where <span class="math inline">\(sign\)</span> is the sign function.</li>
<li>same <em>magnitude</em>: two studies (original and replication) evaluating the efficacy of a treatment have the same effect in terms <span class="math inline">\(|\theta_1 - \theta_2| = 0\)</span> or similar up to a tolerance factor <span class="math inline">\(|\theta_1 - \theta_2| &lt; \gamma\)</span> where <span class="math inline">\(\gamma\)</span> is the maximum difference considered as null.</li>
</ul>
<p>The different methods that we are going to see are focused on a specific type of aggreement. For example, we could consider <span class="math inline">\(\theta_1 = 3x\)</span> and <span class="math inline">\(\theta_2 = x\)</span> to have the same sign but the replication study is on a completely different scale. Is this considered a successful replication?</p>
</section><section id="falsification-vs-consistency" class="level2" data-number="8.9"><h2 data-number="8.9" class="anchored" data-anchor-id="falsification-vs-consistency">
<span class="header-section-number">8.9</span> Falsification vs Consistency</h2>
<p>. . .</p>
<p>This refers to how the replication setup is formulated. With <span class="math inline">\(k = 2\)</span> studies where <span class="math inline">\(k_1\)</span> is the original study and <span class="math inline">\(k_2\)</span> is the replication we have a <em>one-to-one</em> setup. In this setup we compare the replication with the original and according to the chosen method and expectation we conclude if <span class="math inline">\(k_1\)</span> has been replicated or not.</p>
<p>. . .</p>
<p>When <span class="math inline">\(k &gt; 2\)</span> we could collapse the replication studies into a single value (e.g., using a meta-analysis method) and compare the results using a <em>one-to-one</em> or we can use a method for <em>one-to-many</em> designs.</p>
<p>. . .</p>
<p>Regardless the method, <em>falsification</em> approaches compared the original with the replicate(s) obtaining a yes-no answer or a continuous result. On the other side <em>consistency</em> methods are focused on evaluating the degree of similarity (i.e., consistency) among all studies.</p>
</section><section id="the-big-picture" class="level2" data-number="8.10"><h2 data-number="8.10" class="anchored" data-anchor-id="the-big-picture">
<span class="header-section-number">8.10</span> The big picture</h2>
</section></section><section id="statistical-methods" class="level1 section" data-number="9"><h1 class="section" data-number="9">
<span class="header-section-number">9</span> Statistical Methods</h1>
<section id="statistical-methods-disclaimer-schauer2021-ja" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="statistical-methods-disclaimer-schauer2021-ja">
<span class="header-section-number">9.1</span> Statistical Methods, disclaimer <span class="citation" data-cites="Schauer2021-ja">(<a href="#ref-Schauer2021-ja" role="doc-biblioref">Schauer &amp; Hedges, 2021</a>)</span>
</h2>
<ul>
<li>There are no unique methods to assess replication from a statistical point of view</li>
<li>For available statistical methods, statistical properties (e.g., type-1 error rate, power, bias, etc.) are not always known or extensively examined</li>
<li>Different methods answers to the same question or to different replication definitions</li>
</ul></section></section><section id="frequentists-methods" class="level1 section" data-number="10"><h1 class="section" data-number="10">
<span class="header-section-number">10</span> Frequentists Methods</h1>
<section id="vote-counting-based-on-significance-or-direction" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="vote-counting-based-on-significance-or-direction">
<span class="header-section-number">10.1</span> Vote Counting based on significance or direction</h2>
<p>The simplest method is called <strong>vote counting</strong> <span class="citation" data-cites="Valentine2011-yq Hedges1980-gd">(<a href="#ref-Hedges1980-gd" role="doc-biblioref">Hedges &amp; Olkin, 1980</a>; <a href="#ref-Valentine2011-yq" role="doc-biblioref">Valentine et al., 2011</a>)</span>. A replication attempt <span class="math inline">\(\theta_{rep}\)</span> is considered successful if the result has the same direction of the original study <span class="math inline">\(\theta_{orig}\)</span> and it is statistically significant i.e., <span class="math inline">\(p_{\theta_{rep}} \leq \alpha\)</span>. Similarly we can count the number of replication with the <em>same sign</em> as the original study.</p>
<div class="pros">
<ul>
<li>Easy to understand, communicate and compute</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Did not consider the size of the effect</li>
<li>Depends on the power of <span class="math inline">\(\theta_{rep}\)</span>
</li>
</ul>
</div>
</section><section id="example-with-simulated-data" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="example-with-simulated-data">
<span class="header-section-number">10.2</span> Example with simulated data</h2>
<p>Let’s simulate an exact replication:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## original study</span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">theta_orig</span> <span class="op">&lt;-</span> <span class="fu">theta_from_z</span><span class="op">(</span><span class="fl">2</span>, <span class="va">n_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">theta_orig</span>,</span>
<span>  vi <span class="op">=</span> <span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_orig</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span><span class="op">$</span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">orig</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu">summary_es</span><span class="op">(</span><span class="va">orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>         yi         vi       sei zi       pval      ci.lb    ci.ub
1 0.5163978 0.06666667 0.2581989  2 0.04550026 0.01033725 1.022458
</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## replications</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, theta <span class="op">=</span> <span class="va">theta_orig</span>, tau2 <span class="op">=</span> <span class="fl">0</span>, <span class="va">n_orig</span>, <span class="va">n_orig</span>, summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reps</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>         yi         vi       sei       zi         pval       ci.lb     ci.ub
1 0.8797180 0.06597473 0.2568555 3.424953 0.0006149050  0.37629053 1.3831455
2 0.7245546 0.04843434 0.2200780 3.292262 0.0009938480  0.29320963 1.1558996
3 0.4111667 0.04870422 0.2206903 1.863094 0.0624491032 -0.02137836 0.8437118
4 0.7085433 0.06511996 0.2551861 2.776574 0.0054935065  0.20838765 1.2086989
5 0.8810186 0.05914530 0.2431981 3.622638 0.0002916136  0.40435914 1.3576780
6 0.3968792 0.06680153 0.2584599 1.535554 0.1246477547 -0.10969292 0.9034514
</code></pre>
</div>
</section><section id="example-with-simulated-data-1" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="example-with-simulated-data-1">
<span class="header-section-number">10.3</span> Example with simulated data</h2>
<p>Let’s compute the proportions of replication studies are statistically significant:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>[1] 0.6
</code></pre>
</div>
<p>Let’s compute the proportions of replication studies with the same sign as the original:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">orig</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>[1] 1
</code></pre>
</div>
<p>We could also perform some statistical tests. See <span class="citation" data-cites="Bushman2009-zv">Bushman &amp; Wang (<a href="#ref-Bushman2009-zv" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="Hedges1980-gd">Hedges &amp; Olkin (<a href="#ref-Hedges1980-gd" role="doc-biblioref">1980</a>)</span> for vote-counting methods in meta-analysis.</p>
</section><section id="vote-counting-extreme-example" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="vote-counting-extreme-example">
<span class="header-section-number">10.4</span> Vote Counting, extreme example</h2>
<p>Let’s imagine an original experiment with <span class="math inline">\(n_{orig} = 30\)</span> and <span class="math inline">\(\hat \theta_{orig} = 0.5\)</span> that is statistically significant <span class="math inline">\(p \approx 0.045\)</span>. Now a direct replication (thus assuming <span class="math inline">\(\tau^2 = 0\)</span>) study with <span class="math inline">\(n_{rep} = 350\)</span> found <span class="math inline">\(\hat \theta_{rep_1} = 0.15\)</span>, that is statistically significant <span class="math inline">\(p\approx 0.047\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-17-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="confidence-interval-replication-within-original" class="level2" data-number="10.5"><h2 data-number="10.5" class="anchored" data-anchor-id="confidence-interval-replication-within-original">
<span class="header-section-number">10.5</span> Confidence Interval, replication within original</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Theory</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Plot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Another approach check if the replication attempt <span class="math inline">\(\theta_{rep}\)</span> is contained in the % confidence interval of the original study <span class="math inline">\(\theta_{orig}\)</span>. Formally:</p>
<p><span class="math display">\[
\theta_{orig} - \Phi(\alpha/2) \sqrt{\sigma^2_{orig}} &lt; \theta_{rep} &lt; \theta_{orig} + \Phi(\alpha/2) \sqrt{\sigma^2_{orig}}
\]</span></p>
<p>Where <span class="math inline">\(\Phi\)</span> is the cumulative standard normal distribution, <span class="math inline">\(\alpha\)</span> is the type-1 error rate.</p>
<div class="pros">
<ul>
<li>Take into account the size of the effect and the precision of <span class="math inline">\(\theta_{orig}\)</span>
</li>
</ul>
</div>
<div class="cons">
<ul>
<li>The original study is assumed to be a reliable estimation</li>
<li>No extension for <em>many-to-one</em> designs</li>
<li>Low precise original studies lead to higher success rate</li>
</ul>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">se_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n_orig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci_orig</span> <span class="op">&lt;-</span> <span class="va">theta_orig</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_orig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">theta_orig</span>, <span class="va">se_orig</span><span class="op">)</span>, </span>
<span>      <span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">"Density"</span>, </span>
<span>      xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ci_orig</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_orig</span>, <span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_rep</span>, <span class="fl">0</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Replication"</span><span class="op">)</span>, </span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"firebrick"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="confidence-interval-replication-within-original-1" class="level2" data-number="10.6"><h2 data-number="10.6" class="anchored" data-anchor-id="confidence-interval-replication-within-original-1">
<span class="header-section-number">10.6</span> Confidence Interval, replication within original</h2>
<p>One potential problem of this method regards that low precise original studies are “easier” to replicate due to larger confidence intervals.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="confidence-interval-original-within-replication" class="level2" data-number="10.7"><h2 data-number="10.7" class="anchored" data-anchor-id="confidence-interval-original-within-replication">
<span class="header-section-number">10.7</span> Confidence Interval, original within replication</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Theory</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Plot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The same approach can be applied checking if the original effect size is contained within the replication confidence interval. Clearly these methods depends on the precision of studies. Formally:</p>
<p><span class="math display">\[
\theta_{rep} - \Phi(\alpha/2) \sqrt{\sigma_{rep}^2} &lt; \theta_{orig} &lt; \theta_{rep} + \Phi(\alpha/2) \sqrt{\sigma_{rep}^2}
\]</span></p>
<p>The method has the same pros and cons of the previous approach. One advantage is that usually replication studies are more precise (higher sample size) thus the parameter and the % CI is more reliable.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="prediction-interval-pi-what-to-expect-from-a-replication" class="level2" data-number="10.8"><h2 data-number="10.8" class="anchored" data-anchor-id="prediction-interval-pi-what-to-expect-from-a-replication">
<span class="header-section-number">10.8</span> Prediction interval (PI), what to expect from a replication</h2>
<p>One problem of the previous approaches is taking into account only the uncertainty of the original or the replication study. <span class="citation" data-cites="Patil2016-vc">Patil et al. (<a href="#ref-Patil2016-vc" role="doc-biblioref">2016</a>)</span> and <span class="citation" data-cites="Spence2016-tz">Spence &amp; Stanley (<a href="#ref-Spence2016-tz" role="doc-biblioref">2016</a>)</span> proposed a method to take into account both sources of uncertainty.</p>
<p>If the original and replication studies comes from the same population, the sampling distribution of the difference is centered on 0 with a certain standard error <span class="math inline">\(\theta_{orig} - \theta_{rep_0} \sim \mathcal{N}\left( 0, \sqrt{\sigma^2_{\hat \theta_{orig} - \hat \theta_{rep}}} \right)\)</span> (subscript <span class="math inline">\(0\)</span> to indicate that is expected to be sampled from the same population as <span class="math inline">\(\theta_{orig}\)</span>)</p>
<p><span class="math display">\[
\hat \theta_{orig} \pm z_{95\%} \sqrt{\sigma^2_{\theta_{orig} - \theta_{rep}}}
\]</span></p>
<p>If factors other than standard error influence the replication result, <span class="math inline">\(\theta_{rep_0}\)</span> is not expected to be contained within the 95% prediction interval.</p>
</section><section id="prediction-interval-pi-what-to-expect-from-a-replication-1" class="level2" data-number="10.9"><h2 data-number="10.9" class="anchored" data-anchor-id="prediction-interval-pi-what-to-expect-from-a-replication-1">
<span class="header-section-number">10.9</span> Prediction interval (PI), what to expect from a replication</h2>
<p>In the case of a (un)standardized mean difference we can compute the prediction interval as:</p>
<p><span class="math display">\[
\sqrt{\sigma^2_{\epsilon_{\hat \theta_{orig} - \hat \theta_{rep_0}}}} = \sqrt{\left( \frac{\hat \sigma^2_{o1}}{n_{o1}} +\frac{\hat \sigma^2_{o2}}{n_{o2}}\right) + \left(\frac{\hat \sigma^2_{o1}}{n_{r1}} + \frac{\hat\sigma^2_{o2}}{n_{r2}}\right)}
\]</span></p>
<p>The first term is just the standard error of the difference between the two groups in the original study and the second term is the standard error of the <strong>hypothetical</strong> replication study assuming the same standard deviation of the original but a different <span class="math inline">\(n\)</span>.</p>
<p>In this way we estimate an interval where, combining sampling variance from both studies and assuming that they comes from the same population, the replication should fall.</p>
</section><section id="prediction-interval-pi-what-to-expect-from-a-replication-2" class="level2" data-number="10.10"><h2 data-number="10.10" class="anchored" data-anchor-id="prediction-interval-pi-what-to-expect-from-a-replication-2">
<span class="header-section-number">10.10</span> Prediction interval (PI), what to expect from a replication</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Plot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Pros/Cons</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span></span>
<span><span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># group 1</span></span>
<span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># group 2</span></span>
<span><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span> <span class="co"># effect size</span></span>
<span><span class="va">se_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">/</span><span class="fl">50</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span> <span class="co"># standard error of the difference</span></span>
<span></span>
<span><span class="va">n_r</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size replication</span></span>
<span></span>
<span><span class="va">se_o_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">se_o</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">od</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_o_r</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>[1] 0.325520 1.298378
</code></pre>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">od</span>, <span class="va">se_o_r</span><span class="op">)</span>, <span class="va">od</span> <span class="op">-</span> <span class="va">se_o_r</span><span class="op">*</span><span class="fl">4</span>, <span class="va">od</span> <span class="op">+</span> <span class="va">se_o_r</span><span class="op">*</span><span class="fl">4</span>, lwd <span class="op">=</span> <span class="fl">2</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\theta$"</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">od</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">se_o_r</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-22-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="pros">
<ul>
<li>Take into account uncertainty of both studies</li>
<li>We can plan a replication using the standard deviation of the original study and the expected sample size</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Low precise original studies lead to wide PI. For a replication study is difficult to fall outside the PI</li>
<li>Mainly for <em>one-to-one</em> replications design</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-p_orig" class="level2" data-number="10.11"><h2 data-number="10.11" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-p_orig">
<span class="header-section-number">10.11</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(p_{orig}\)</span>
</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Theory</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Pros-cons</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Simulation</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> proposed a new method based on the prediction interval to calculate a p value <span class="math inline">\(p_{orig}\)</span> representing the probability that <span class="math inline">\(\theta_{orig}\)</span> is consistent with the replications. This method is suited for <em>many-to-one</em> replication designs. Formally:</p>
<p><span class="math display">\[
P_{orig} = 2 \left[ 1 - \Phi \left( \frac{|\hat \theta_{orig} - \hat \mu_{\theta_{rep}}|}{\sqrt{\hat \tau^2 + \sigma^2_{orig} + \hat{SE}^2_{\hat \mu_{\theta_{rep}}}}} \right) \right]
\]</span></p>
<ul>
<li>
<span class="math inline">\(\mu_{\theta_{rep}}\)</span> is the pooled (i.e., meta-analytic) estimation of the <span class="math inline">\(k\)</span> replications</li>
<li>
<span class="math inline">\(\tau^2\)</span> is the variance among replications</li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>It is interpreted as the probability that <span class="math inline">\(\theta_{orig}\)</span> is equal or more extreme that what observed. A very low <span class="math inline">\(p_{orig}\)</span> suggest that the original study is inconsistent with replications.</p>
<div class="pros">
<ul>
<li>Suited for <em>many-to-one</em> designs</li>
<li>We take into account all sources of uncertainty</li>
<li>We have a p-value</li>
</ul>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>The code is implemented in the <code>Replicate</code> and <code>MetaUtility</code> R packages:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">theta_rep</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">theta_orig</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span></span>
<span><span class="va">n_orig</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n_rep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">replications</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="va">k</span>, <span class="va">theta_rep</span>, <span class="va">tau2</span>, <span class="va">n_rep</span>, <span class="va">n_rep</span><span class="op">)</span></span>
<span><span class="va">original</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="fl">1</span>, <span class="va">theta_orig</span>, <span class="fl">0</span>, <span class="va">n_orig</span>, <span class="va">n_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_rep</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">replications</span><span class="op">)</span> <span class="co"># random-effects meta-analysis</span></span>
<span></span>
<span><span class="fu">Replicate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Replicate/man/p_orig.html">p_orig</a></span><span class="op">(</span><span class="va">original</span><span class="op">$</span><span class="va">yi</span>, <span class="va">original</span><span class="op">$</span><span class="va">vi</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">tau2</span>, <span class="va">fit_rep</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>[1] 0.5563241
</code></pre>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># standard errors assuming same n and variance 1</span></span>
<span><span class="va">se_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_orig</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="va">n_rep</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_theta_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">se_rep</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="co"># standard error of the random-effects estimate</span></span>
<span></span>
<span><span class="va">sep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span> <span class="op">+</span> <span class="va">se_orig</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">se_theta_rep</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># z of p-orig denominator</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">theta_rep</span>, <span class="va">sep</span><span class="op">)</span>, <span class="va">theta_rep</span> <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="va">sep</span>, <span class="va">theta_rep</span> <span class="op">+</span> <span class="fl">4</span><span class="op">*</span><span class="va">sep</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\theta"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">theta_orig</span>, <span class="fl">0.02</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="va">theta_rep</span>, <span class="va">sep</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-25-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-hat-p_-0" class="level2" data-number="10.12"><h2 data-number="10.12" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-hat-p_-0">
<span class="header-section-number">10.12</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(\hat P_{&gt; 0}\)</span>
</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Theory</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Bootstrap Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Bootstrap Results</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Another related metric is the <span class="math inline">\(\hat P_{&gt; 0}\)</span>, representing the proportion of replications following the same direction as the original effect. Before simply computing the proportions we need to adjust the estimated <span class="math inline">\(\theta_{rep_i}\)</span> with a shrinkage factor:</p>
<p><span class="math display">\[
\tilde{\theta}_{rep_i} = (\theta_{rep_i} - \mu_{\theta_{rep_i}}) \sqrt{\frac{\hat \tau^2}{\hat \tau^2 + v_{rep_i}}}
\]</span></p>
<p>This method is somehow similar to the vote counting but we are adjusting the effects taking into account <span class="math inline">\(\tau^2\)</span>.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute calibrated estimation for the replications</span></span>
<span><span class="co"># use restricted maximum likelihood to estimate tau2 under the hood</span></span>
<span><span class="va">theta_sh</span> <span class="op">&lt;-</span> <span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/calib_ests.html">calib_ests</a></span><span class="op">(</span><span class="va">replications</span><span class="op">$</span><span class="va">yi</span>, <span class="va">replications</span><span class="op">$</span><span class="va">sei</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">theta_sh</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>[1] 0.75
</code></pre>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>The authors suggest a bootstrapping approach for making inference on <span class="math inline">\(\hat P_{&gt; 0}\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span><span class="va">theta_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">nboot</span>, ncol <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nboot</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">replications</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">replications</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">replications_boot</span> <span class="op">&lt;-</span> <span class="va">replications</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span>
<span>  <span class="va">theta_cal</span> <span class="op">&lt;-</span> <span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/calib_ests.html">calib_ests</a></span><span class="op">(</span><span class="va">replications_boot</span><span class="op">$</span><span class="va">yi</span>, </span>
<span>                                       <span class="va">replications_boot</span><span class="op">$</span><span class="va">sei</span>, </span>
<span>                                       method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span>  <span class="va">theta_boot</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_cal</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calculate</span></span>
<span><span class="va">p_greater_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">theta_boot</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-29-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q" class="level2" data-number="10.13"><h2 data-number="10.13" class="anchored" data-anchor-id="mathur-vanderweele--mathur2020-nw-hat-p_gtrless-q">
<span class="header-section-number">10.13</span> Mathur &amp; VanderWeele <span class="citation" data-cites="Mathur2020-nw">(<a href="#ref-Mathur2020-nw" role="doc-biblioref">2020</a>)</span> <span class="math inline">\(\hat P_{\gtrless q*}\)</span>
</h2>
<p>Instead of using 0 as threshold, we can use meaningful effect size to be considered as low but different from 0. <span class="math inline">\(\hat P_{\gtrless q*}\)</span> is the proportion of (calibrated) replications greater or lower than the <span class="math inline">\(q*\)</span> value. This framework is similar to equivalence and minimum effect size testing <span class="citation" data-cites="Lakens2018-ri">(<a href="#ref-Lakens2018-ri" role="doc-biblioref">Lakens et al., 2018</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># minimum non zero effect</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">replications</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see ?MetaUtility::prop_stronger</span></span>
<span><span class="fu">MetaUtility</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetaUtility/man/prop_stronger.html">prop_stronger</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">q</span>,</span>
<span>                           M <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                           t2 <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">tau2</span>,</span>
<span>                           tail <span class="op">=</span> <span class="st">"above"</span>,</span>
<span>                           estimate.method <span class="op">=</span> <span class="st">"calibrated"</span>,</span>
<span>                           ci.method <span class="op">=</span> <span class="st">"calibrated"</span>,</span>
<span>                           dat <span class="op">=</span> <span class="va">replications</span>,</span>
<span>                           yi.name <span class="op">=</span> <span class="st">"yi"</span>,</span>
<span>                           vi.name <span class="op">=</span> <span class="st">"vi"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>   est        se  lo   hi  bt.mn shapiro.pval
1 0.35 0.1137901 0.1 0.55 0.3573    0.5224829
</code></pre>
</div>
</section><section id="combining-original-and-replications" class="level2" data-number="10.14"><h2 data-number="10.14" class="anchored" data-anchor-id="combining-original-and-replications">
<span class="header-section-number">10.14</span> Combining original and replications</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Theory</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Fixed-effects Model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Random-Effects model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Pooling replications</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Another approach is to combine the original and replication results (both <em>one-to-one</em> and <em>many-to-one</em>) using a meta-analysis model. Then we can test if the pooled estimate is different from 0 or another meaningful value.</p>
<div class="pros">
<ul>
<li>Use all the available information, especially when fitting a random-effects model</li>
<li>Take into account the precision by inverse-variance weighting</li>
</ul>
</div>
<div class="cons">
<ul>
<li>Did not consider the publication bias</li>
<li>For <em>one-to-one</em> designs only a fixed-effects model can be used</li>
</ul>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fixed-effects</span></span>
<span><span class="va">fit_fixed</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, method <span class="op">=</span> <span class="st">"FE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_fixed</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>
Fixed-Effects Model (k = 20)

  logLik  deviance       AIC       BIC      AICc   
 20.7415   -0.0000  -39.4829  -38.4872  -39.2607   

I^2 (total heterogeneity / total variability):   0.00%
H^2 (total variability / sampling variability):  0.00

Test for Heterogeneity:
Q(df = 19) = 0.0000, p-val = 1.0000

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.2000  0.0316  6.3246  &lt;.0001 signif. codes:&gt;<!--.0001--></code></pre>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fixed-effects</span></span>
<span><span class="va">fit_random</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_random</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>
Random-Effects Model (k = 20; tau^2 estimator: REML)

  logLik  deviance       AIC       BIC      AICc   
 19.7044  -39.4088  -35.4088  -33.5199  -34.6588   

tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0065)
tau (square root of estimated tau^2 value):      0
I^2 (total heterogeneity / total variability):   0.00%
H^2 (total variability / sampling variability):  1.00

Test for Heterogeneity:
Q(df = 19) = 0.0000, p-val = 1.0000

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.2000  0.0316  6.3246  &lt;.0001 signif. codes:&gt;<!--.0001--></code></pre>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p>The previous approach can be also implemented combining replications into a single effect and then compare the original with the combined replication study.</p>
<p>This is similar to using the CI or PI approaches but the replication effect will probably by very precise due to pooling multiple studies.</p>
</div>
</div>
</div>
</section><section id="q-statistics" class="level2" data-number="10.15"><h2 data-number="10.15" class="anchored" data-anchor-id="q-statistics">
<span class="header-section-number">10.15</span> Q Statistics</h2>
<p>An interesting proposal is using the Q statistics <span class="citation" data-cites="Hedges2019-pr Hedges2019-ar Hedges2021-of Schauer2022-mj Schauer2021-ja Schauer2020-tw Hedges2019-ry">(<a href="#ref-Hedges2019-pr" role="doc-biblioref">Hedges &amp; Schauer, 2019a</a>, <a href="#ref-Hedges2019-ar" role="doc-biblioref">2019b</a>, <a href="#ref-Hedges2019-ry" role="doc-biblioref">2019c</a>, <a href="#ref-Hedges2021-of" role="doc-biblioref">2021</a>; <a href="#ref-Schauer2022-mj" role="doc-biblioref">Schauer, 2022</a>; <a href="#ref-Schauer2020-tw" role="doc-biblioref">Schauer &amp; Hedges, 2020</a>; <a href="#ref-Schauer2021-ja" role="doc-biblioref">Schauer &amp; Hedges, 2021</a>)</span>, commonly used in meta-analysis to assess the presence of heterogeneity. Formally:</p>
<p><span class="math display">\[
Q = \sum_{i = 1}^{k} \frac{(\theta_i - \bar \theta_w)^2}{\sigma^2_i}
\]</span></p>
<p>Where <span class="math inline">\(\bar \theta_w\)</span> is the inverse-variance weighted average (i.g., fixed-effect model). The Q statistics is essentially a weighted sum of squares. Under the null hypothesis where all studies are equal <span class="math inline">\(\theta_1 = \theta_2, ... = \theta_i\)</span> the Q statistics has a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(k - 1\)</span> degrees of freedom. Under the alternative hypothesis the distribution is a non-central <span class="math inline">\(\chi^2\)</span> with non centrality parameter <span class="math inline">\(\lambda\)</span>. The expected value of the <span class="math inline">\(Q\)</span> is <span class="math inline">\(E(Q) = v + \lambda\)</span>, where <span class="math inline">\(v\)</span> are the degrees of freedom.</p>
</section><section id="q-statistics-1" class="level2" data-number="10.16"><h2 data-number="10.16" class="anchored" data-anchor-id="q-statistics-1">
<span class="header-section-number">10.16</span> Q Statistics</h2>
<p>Hedges &amp; Schauer proposed to use the Q statistics to evaluate the consistency of a series of replications:</p>
<ul>
<li>In case of <em>exact</em> replication, <span class="math inline">\(\lambda = 0\)</span> because <span class="math inline">\(\theta_1 = \theta_2, ... = \theta_k\)</span>.</li>
<li>In case of <em>approximate</em> replication, <span class="math inline">\(\lambda &lt; \lambda_0\)</span> where <span class="math inline">\(\lambda_0\)</span> is the maximum value considered as equal to null (i.e., 0).</li>
</ul>
<p>This approach is testing the consistency (i.e., homogeneity) of replications. A successful replication should minimize the heterogeneity and the presence of a significant Q statistics should bring evidence for not replicating the effect<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
</section><section id="q-statistics-2" class="level2" data-number="10.17"><h2 data-number="10.17" class="anchored" data-anchor-id="q-statistics-2">
<span class="header-section-number">10.17</span> Q Statistics</h2>
<p>The method has been expanded and formalized in several papers with different objectives:</p>
<p>. . .</p>
<ul>
<li>to cover different replications setup (burden of proof on replicating vs non-replicating, many-to-one and one-to-one, etc.)</li>
</ul>
<p>. . .</p>
<ul>
<li>interpret and choose the <span class="math inline">\(\lambda\)</span> parameter given that is the core of the approach</li>
</ul>
<p>. . .</p>
<ul>
<li>evaluating the power and statistical properties under different replication scenarios</li>
</ul>
<p>. . .</p>
<ul>
<li>the standard implementation put the burden of proof on non-replication. Thus <span class="math inline">\(H_0\)</span> is that studies replicates. They provided also a series of tests with the opposite formulation.</li>
</ul></section><section id="q-statistics-3" class="level2" data-number="10.18"><h2 data-number="10.18" class="anchored" data-anchor-id="q-statistics-3">
<span class="header-section-number">10.18</span> Q Statistics</h2>
<p>In the case of evaluating an exact replication we can use the <code>Qrep()</code> function that simply calculate the p-value based on the Q sampling distribution.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Function</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Plot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Qrep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, <span class="va">lambda0</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">k</span></span>
<span>  <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">QE</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">Qp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">Q</span>, df <span class="op">=</span> <span class="va">df</span>, ncp <span class="op">=</span> <span class="va">lambda0</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Qp</span> <span class="op">&lt;</span> <span class="fl">0.001</span>, <span class="st">"p &lt; 0.001"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"p = %.3f"</span>, <span class="va">Qp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">Q</span> <span class="op">-</span> <span class="va">df</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">(</span><span class="va">Q</span> <span class="op">-</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="va">Q</span>, lambda <span class="op">=</span> <span class="va">lambda</span>, pval <span class="op">=</span> <span class="va">Qp</span>, df <span class="op">=</span> <span class="va">df</span>, k <span class="op">=</span> <span class="va">k</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, lambda0 <span class="op">=</span> <span class="va">lambda0</span><span class="op">)</span></span>
<span>  <span class="va">H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">lambda0</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"H0: lambda &lt;"</span>, <span class="va">lambda0</span><span class="op">)</span>, <span class="st">"H0: lambda = 0"</span><span class="op">)</span></span>
<span>  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">lambda0</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="st">"Q test for Approximate Replication"</span>, <span class="st">"Q test for Exact Replication"</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_rule.html">cli_rule</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_blue</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">style_bold</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Q = %.3f (df = %s), lambda = %.3f, %s"</span>, <span class="va">res</span><span class="op">$</span><span class="va">Q</span>, <span class="va">res</span><span class="op">$</span><span class="va">df</span>, <span class="va">lambda</span>, <span class="va">pval</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">H0</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_rule.html">cli_rule</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Qrep"</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<pre class="r-output"><code><span style="color: #0000BB; font-weight: bold;">Q test for Exact Replication</span> 

Q = 367.321 (df = 99), lambda = 268.321, p </code></pre>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Qres</span> <span class="op">&lt;-</span> <span class="fu">Qrep</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code><span style="color: #0000BB; font-weight: bold;">Q test for Exact Replication</span> 

Q = 367.321 (df = 99), lambda = 268.321, p </code></pre>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot.Qrep</span><span class="op">(</span><span class="va">Qres</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-36-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="q-statistics-for-approximate-replication" class="level2" data-number="10.19"><h2 data-number="10.19" class="anchored" data-anchor-id="q-statistics-for-approximate-replication">
<span class="header-section-number">10.19</span> Q Statistics for approximate replication</h2>
<ul>
<li><p>In case of approximate replication we need to set <span class="math inline">\(\lambda_0\)</span> to a meaningful value but the overall test is the same. The critical <span class="math inline">\(Q\)</span> is no longer evaluated with a central <span class="math inline">\(\chi^2\)</span> but a non-central <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(\lambda_0\)</span> as non-centrality parameter.</p></li>
<li><p><span class="citation" data-cites="Hedges2019-ry">Hedges &amp; Schauer (<a href="#ref-Hedges2019-ry" role="doc-biblioref">2019c</a>)</span> provide different strategies to choose <span class="math inline">\(\lambda_0\)</span>. They found that under some assumptions, <span class="math inline">\(\lambda = (k - 1) \frac{\tau^2}{\tilde{v}}\)</span></p></li>
<li><p>Given that we introduced the <span class="math inline">\(I^2\)</span> statistics we can derive a <span class="math inline">\(\lambda_0\)</span> based in <span class="math inline">\(I^2\)</span>. <span class="citation" data-cites="Schmidt2014-kw">F. L. Schmidt &amp; Hunter (<a href="#ref-Schmidt2014-kw" role="doc-biblioref">2014</a>)</span> proposed that when <span class="math inline">\(\tilde{v}\)</span> is at least 75% of total variance <span class="math inline">\(\tilde{v} + \tau^2\)</span> thus <span class="math inline">\(\tau^2\)</span> could be considered neglegible. This corresponds to a <span class="math inline">\(I^2 = 25%\)</span> and a ratio <span class="math inline">\(\frac{\tau^2}{\tilde{v}} = 1/3\)</span> thus <span class="math inline">\(\lambda_0 = \frac{(k - 1)}{3}\)</span> can be considered a neglegible heterogeneity</p></li>
</ul></section><section id="q-statistics-for-approximate-replication-1" class="level2" data-number="10.20"><h2 data-number="10.20" class="anchored" data-anchor-id="q-statistics-for-approximate-replication-1">
<span class="header-section-number">10.20</span> Q Statistics for approximate replication</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="va">k</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu">Qrep</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>, lambda0 <span class="op">=</span> <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code><span style="color: #0000BB; font-weight: bold;">Q test for Approximate Replication</span> 

Q = 98.121 (df = 99), lambda = 0.000, p = 0.977 
H0: lambda </code></pre>
</div>
</section><section id="small-telescopes-simonsohn2015-kg" class="level2" data-number="10.21"><h2 data-number="10.21" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg">
<span class="header-section-number">10.21</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<p>Simonsohn <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">2015</a>)</span> introduced 3 main questions when evaluating replicability:</p>
<p>. . .</p>
<ol type="1">
<li>When we combine data from the original and replication study, what is our best guess of the overall effect?</li>
</ol>
<p>. . .</p>
<p><strong>meta-analysis</strong></p>
<p>. . .</p>
<ol start="2" type="1">
<li>Is the effect of the replication study different from the original study?</li>
</ol>
<p>. . .</p>
<p><strong>meta-analysis</strong> and standard tests, but problematic in terms of statistical power</p>
<p>. . .</p>
<ol start="3" type="1">
<li>Does the replication study suggest that the effect of interest is undetectable different from zero?</li>
</ol>
<p>. . .</p>
<p><strong>small telescopes</strong></p>
</section><section id="small-telescopes-simonsohn2015-kg-1" class="level2" data-number="10.22"><h2 data-number="10.22" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg-1">
<span class="header-section-number">10.22</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<p>The idea is simple but quite powerful and insightful. Let’s assume that an original study found an effect of <span class="math inline">\(y_{orig} = 0.7\)</span> on a two-sample design with <span class="math inline">\(n = 20\)</span> per group.</p>
<p>. . .</p>
<ul>
<li>we define a threshold as the effect size that is associated with a certain low power level e.g., <span class="math inline">\(33\%\)</span> given the sample size i.e.&nbsp;<span class="math inline">\(\theta_{small} = 0.5\)</span>
</li>
<li>the replication study found an effect of <span class="math inline">\(y_{rep} = 0.2\)</span> with <span class="math inline">\(n = 100\)</span> subjects</li>
</ul>
<p>. . .</p>
<p>If the <span class="math inline">\(y_{rep}\)</span> is lower (i.e., the upper bound of the confidence interval) than the <em>small effect</em> (<span class="math inline">\(\theta_{small} = 0.5\)</span>) we conclude that the effect is probably so tiny that could not have been detected by the original study. Thus there is no evidence for a replication.</p>
</section><section id="small-telescopes-simonsohn2015-kg-2" class="level2" data-number="10.23"><h2 data-number="10.23" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg-2">
<span class="header-section-number">10.23</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<p>We can use the custom <code>small_telescope()</code> function on simulated data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">small_telescope</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">or_d</span>,</span>
<span>                            <span class="va">or_se</span>,</span>
<span>                            <span class="va">rep_d</span>,</span>
<span>                            <span class="va">rep_se</span>,</span>
<span>                            <span class="va">small</span>,</span>
<span>                            <span class="va">ci</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># quantile for the ci</span></span>
<span>  <span class="va">qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ci</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ci</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># original confidence interval</span></span>
<span>  <span class="va">or_ci</span> <span class="op">&lt;-</span> <span class="va">or_d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span> <span class="op">*</span> <span class="va">or_se</span></span>
<span>  </span>
<span>  <span class="co"># replication confidence interval</span></span>
<span>  <span class="va">rep_ci</span> <span class="op">&lt;-</span> <span class="va">rep_d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span> <span class="op">*</span> <span class="va">rep_se</span></span>
<span>  </span>
<span>  <span class="co"># small power</span></span>
<span>  <span class="va">is_replicated</span> <span class="op">&lt;-</span> <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">small</span></span>
<span>  </span>
<span>  <span class="va">msg_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Original Study: d = %.3f %s CI = [%.3f, %.3f]"</span>,</span>
<span>                          <span class="va">or_d</span>, <span class="va">ci</span>, <span class="va">or_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">or_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">msg_replicated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Replication Study: d = %.3f %s CI = [%.3f, %.3f]"</span>,</span>
<span>                            <span class="va">rep_d</span>, <span class="va">ci</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">is_replicated</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"The replicated effect is not smaller than the small effect (%.3f), (probably) replication!"</span>, <span class="va">small</span><span class="op">)</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_green</a></span><span class="op">(</span><span class="va">msg_res</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"The replicated effect is smaller than the small effect (%.3f), no replication!"</span>, <span class="va">small</span><span class="op">)</span></span>
<span>    <span class="va">msg_res</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_red</a></span><span class="op">(</span><span class="va">msg_res</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"original"</span>, <span class="st">"replication"</span><span class="op">)</span>,</span>
<span>                    d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_d</span>, <span class="va">rep_d</span><span class="op">)</span>,</span>
<span>                    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">or_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">rep_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                    small <span class="op">=</span> <span class="va">small</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># nice message</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="va">msg_original</span>,</span>
<span>    <span class="va">msg_replicated</span>,</span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/rule.html">rule</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="va">msg_res</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="small-telescopes-simonsohn2015-kg-3" class="level2" data-number="10.24"><h2 data-number="10.24" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg-3">
<span class="header-section-number">10.24</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># real effect</span></span>
<span></span>
<span><span class="co"># original study</span></span>
<span><span class="va">or_n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">or_d</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">or_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">20</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">d_small</span> <span class="op">&lt;-</span> <span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span><span class="va">or_n</span>, power <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span>
<span></span>
<span><span class="co"># replication</span></span>
<span><span class="va">rep_n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size of replication study</span></span>
<span><span class="va">g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">rep_n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">rep_n</span>, <span class="va">d</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rep_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g0</span><span class="op">)</span></span>
<span><span class="va">rep_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">rep_n</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g0</span><span class="op">)</span><span class="op">/</span><span class="va">rep_n</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we are using the <code><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr::pwr.t.test()</a></code> to compute the effect size <span class="math inline">\(\theta_{small}\)</span> (in code <code>d</code>) associated with 33% power.</p>
</section><section id="small-telescopes-simonsohn2015-kg-4" class="level2" data-number="10.25"><h2 data-number="10.25" class="anchored" data-anchor-id="small-telescopes-simonsohn2015-kg-4">
<span class="header-section-number">10.25</span> Small Telescopes <span class="citation" data-cites="Simonsohn2015-kg">(<a href="#ref-Simonsohn2015-kg" role="doc-biblioref">Simonsohn, 2015</a>)</span>
</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">small_telescope</span><span class="op">(</span><span class="va">or_d</span>, <span class="va">or_se</span>, <span class="va">rep_d</span>, <span class="va">rep_se</span>, <span class="va">d_small</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>Original Study: d = 0.700 0.95 CI = [0.080, 1.320]
Replication Study: d = 0.214 0.95 CI = [-0.061, 0.490]
────────────────────────────────────────────────────────────────────────────────
<span style="color: #BB0000;">The replicated effect is smaller than the small effect (0.493), no replication!</span>
</code></pre>
</div>
<p>And a (quite over-killed) plot:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-41-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="bayesian-methods" class="level1 section" data-number="11"><h1 class="section" data-number="11">
<span class="header-section-number">11</span> Bayesian Methods</h1>
<section id="bayes-factor" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="bayes-factor">
<span class="header-section-number">11.1</span> Bayes Factor</h2>
<p><span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> proposed a method to estimate the evidence of a <em>replication</em> study. The core topics to understand the method are:</p>
<ul>
<li>Bayesian hypothesis testing using the Bayes Factor <span class="citation" data-cites="Rouder2009-jh">(see, <a href="#ref-Rouder2009-jh" role="doc-biblioref">Rouder et al., 2009</a>)</span>
</li>
<li>Bayes Factor using the Savage-Dickey density ratio <span class="citation" data-cites="Wagenmakers2010-fj">(SDR, <a href="#ref-Wagenmakers2010-fj" role="doc-biblioref">Wagenmakers et al., 2010</a>)</span>
</li>
</ul></section><section id="bayesian-inference" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="bayesian-inference">
<span class="header-section-number">11.2</span> Bayesian inference</h2>
<p>Bayesian inference is the statistical procedure where <strong>prior beliefs</strong> about a phenomenon are combined, using the Bayes theorem, with <strong>evidence from data</strong> to obtain the <strong>posterior beliefs</strong>.</p>
<p>. . .</p>
<p>The interesting part is that the researcher express the prior beliefs in probabilistic terms. Then after collecting data, evidence from the experiment is combined increasing or decreasing the plausibility of prior beliefs.</p>
<p>. . .</p>
<p>Let’s make an (not a very innovative :smile:) example. We need to evaluate the fairness of a coin. The crucial parameter is <span class="math inline">\(\theta\)</span> that is the probability of success (e.g., head). We have our prior belief about the coin (e.g., fair but with some uncertainty). We toss the coin <span class="math inline">\(k\)</span> times and we observe <span class="math inline">\(x\)</span> heads. What are my conclusions?</p>
</section><section id="bayesian-inference-1" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="bayesian-inference-1">
<span class="header-section-number">11.3</span> Bayesian inference</h2>
<p><span class="math display">\[
p(\theta|D) = \frac{p(D|\theta) \; p(\theta)}{p(D)}
\]</span> Where <span class="math inline">\(\theta\)</span> is our parameter and <span class="math inline">\(D\)</span> the data. <span class="math inline">\(p(\theta|D)\)</span> is the posterior distribution that is the product between the likelihood <span class="math inline">\(p(D|\theta)\)</span> and the prior <span class="math inline">\(p(\theta)\)</span>. <span class="math inline">\(p(D)\)</span> is the probability of the data (aka marginal likelihood) and is necessary only for the posterior to be a proper probability distribution.</p>
<p>We can “read” the formula as: <em>The probability of the parameter given the data is the product between the likelihood of the data given the parameter and the prior probability of the parameter</em>.</p>
</section><section id="bayesian-inference-2" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="bayesian-inference-2">
<span class="header-section-number">11.4</span> Bayesian inference</h2>
<p>Let’s express our <strong>prior</strong> belief in probabilistic terms:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-42-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="bayesian-inference-3" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="bayesian-inference-3">
<span class="header-section-number">11.5</span> Bayesian inference</h2>
<p>Now we collect data and we observe <span class="math inline">\(x = 40\)</span> tails out of <span class="math inline">\(k = 50\)</span> trials thus <span class="math inline">\(\hat{\theta} = 0.8\)</span> and compute the <em>likelihood</em>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-43-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="bayesian-inference-4" class="level2" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="bayesian-inference-4">
<span class="header-section-number">11.6</span> Bayesian inference</h2>
<p>Finally we combine, using the Bayes rule, <strong>prior</strong> and <strong>likelihood</strong> to obtain the <strong>posterior</strong> distribution:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-44-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="bayes-factor-1" class="level2" data-number="11.7"><h2 data-number="11.7" class="anchored" data-anchor-id="bayes-factor-1">
<span class="header-section-number">11.7</span> Bayes Factor</h2>
<p>The idea of the Bayes Factor is computing the evidence of the data under two competing hypotheses, <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> (~ <span class="math inline">\(\theta\)</span> in our previous example):</p>
<p><span class="math display">\[
\frac{p(H_0|D)}{p(H_1|D)} = \frac{f(D|H_0)}{f(D|H_1)} \times \frac{p(H_0)}{p(H_1)}
\]</span></p>
<p>Where <span class="math inline">\(f\)</span> is the likelihood function, <span class="math inline">\(y\)</span> are the data. The <span class="math inline">\(\frac{p(H_0)}{p(H_1)}\)</span> is the prior odds of the two hypothesis. The Bayes Factor is the ratio between the likelihood of the data under the two hypotheses.</p>
</section><section id="bayes-factor-using-the-sdr" class="level2" data-number="11.8"><h2 data-number="11.8" class="anchored" data-anchor-id="bayes-factor-using-the-sdr">
<span class="header-section-number">11.8</span> Bayes Factor using the SDR</h2>
<p>Calculating the BF can be problematic in some condition. The SDR is a convenient shortcut to calculate the Bayes Factor <span class="citation" data-cites="Wagenmakers2010-fj">(<a href="#ref-Wagenmakers2010-fj" role="doc-biblioref">Wagenmakers et al., 2010</a>)</span>. The idea is that the ratio between the prior and posterior density distribution for the <span class="math inline">\(H_1\)</span> is an estimate of the Bayes factor calculated in the standard way.</p>
<p><span class="math display">\[
BF_{01} = \frac{p(D|H_0)}{p(D|H_1)} = \frac{p(\theta = x|D, H_1)}{p(\theta = x, H_1)}
\]</span></p>
<p>Where <span class="math inline">\(\theta\)</span> is the parameter of interest and <span class="math inline">\(x\)</span> is the null value under <span class="math inline">\(H_0\)</span> e.g., 0. and <span class="math inline">\(D\)</span> are the data.</p>
</section><section id="bayes-factor-using-the-sdr-example" class="level2" data-number="11.9"><h2 data-number="11.9" class="anchored" data-anchor-id="bayes-factor-using-the-sdr-example">
<span class="header-section-number">11.9</span> Bayes Factor using the SDR, Example:</h2>
<p>Following the previous example <span class="math inline">\(H_0: \theta = 0.5\)</span>. Under <span class="math inline">\(H_1\)</span> we use a completely uninformative prior by setting <span class="math inline">\(\theta \sim Beta(1, 1)\)</span>.</p>
<p>We flip again the coin 20 times and we found that <span class="math inline">\(\hat \theta = 0.75\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-45-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="bayes-factor-using-the-sdr-example-1" class="level2" data-number="11.10"><h2 data-number="11.10" class="anchored" data-anchor-id="bayes-factor-using-the-sdr-example-1">
<span class="header-section-number">11.10</span> Bayes Factor using the SDR, Example:</h2>
<p>The ratio between the two black dots is the Bayes Factor.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-46-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>If the probability density of the null value decrease after seeing data (from prior to posterior) this means that the Bayes factor should favor the alternative hypothesis. On the left, the density of 0.5 is lower after seeing the data –&gt; evidence for H1 On the right the density of 0.5 is higher after seeing the data –&gt; evidence for H0</p>
</div>
</section><section id="verhagen2014-tx-model" class="level2" data-number="11.11"><h2 data-number="11.11" class="anchored" data-anchor-id="verhagen2014-tx-model">
<span class="header-section-number">11.11</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> model<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</h2>
<p>The idea is using the posterior distribution of the original study as prior for a Bayesian hypothesis testing where:</p>
<ul>
<li>
<span class="math inline">\(H_0: \theta_{rep} = 0\)</span> thus there is no effect in the replication study</li>
<li>
<span class="math inline">\(H_1: \theta_{rep} \neq 0\)</span> and in particular is distributed as <span class="math inline">\(\delta \sim \mathcal{N}(\theta_{orig}, \sigma^2_{orig})\)</span> where <span class="math inline">\(\theta_{orig}\)</span> and <span class="math inline">\(\sigma^2_{orig}\)</span> are the mean and standard error of the original study</li>
</ul>
<p>If <span class="math inline">\(H_0\)</span> is more likely after seeing the data, there is evidence against the replication (i.e., <span class="math inline">\(BF_{r0} &gt; 1\)</span>) otherwise there is evidence for a successful replication (<span class="math inline">\(BF_{r1} &gt; 1\)</span>).</p>
</section><section id="verhagen2014-tx-model-1" class="level2" data-number="11.12"><h2 data-number="11.12" class="anchored" data-anchor-id="verhagen2014-tx-model-1">
<span class="header-section-number">11.12</span> <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> model</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Disclaimer:</strong> The actual implementation of <span class="citation" data-cites="Verhagen2014-tx">Verhagen &amp; Wagenmakers (<a href="#ref-Verhagen2014-tx" role="doc-biblioref">2014</a>)</span> is different (they use the <span class="math inline">\(t\)</span> statistics). The proposed implementation for the current workshop use a standard linear model.</p>
</div>
</div>
</section><section id="example" class="level2" data-number="11.13"><h2 data-number="11.13" class="anchored" data-anchor-id="example">
<span class="header-section-number">11.13</span> Example</h2>
<p>Let’s assume that the original study (<span class="math inline">\(n = 30\)</span>) estimate a <span class="math inline">\(y_{orig} = 0.4\)</span> and a standard error of <span class="math inline">\(\sigma^2/n\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># original study</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">yorig</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The assumption of Verhagen &amp; Wagenmakers (2014) is that the original study performed a Bayesian analysis with a completely flat prior. Thus the confidence interval is the same as the Bayesian credible interval.</p>
</div>
</div>
</section><section id="example-1" class="level2" data-number="11.14"><h2 data-number="11.14" class="anchored" data-anchor-id="example-1">
<span class="header-section-number">11.14</span> Example</h2>
<p>For this reason, the posterior distribution of the original study can be approximated as:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-48-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>With an uninformative prior the credible interval is the same as the confidence interval</p>
</div>
</section><section id="example-2" class="level2" data-number="11.15"><h2 data-number="11.15" class="anchored" data-anchor-id="example-2">
<span class="header-section-number">11.15</span> Example</h2>
<p>Let’s imagine that a new study tried to replicate the original one. They collected <span class="math inline">\(n = 100\)</span> participants with the same protocol and found and effect of <span class="math inline">\(y_{rep} = 0.1\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">yrep</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">nrep</span>, mu <span class="op">=</span> <span class="fl">0.1</span>, Sigma <span class="op">=</span> <span class="fl">1</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">yrep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">yrep</span>, main <span class="op">=</span> <span class="st">"Replication Study (n1 = 100)"</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_{rep}$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yrep</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-49-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="example-3" class="level2" data-number="11.16"><h2 data-number="11.16" class="anchored" data-anchor-id="example-3">
<span class="header-section-number">11.16</span> Example</h2>
<p>We can analyze these data with an <em>intercept-only regression model</em> setting as prior the posterior distribution of the original study:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># setting the prior on the intercept parameter</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html">normal</a></span><span class="op">(</span>location <span class="op">=</span> <span class="va">yorig</span>,</span>
<span>                          scale <span class="op">=</span> <span class="va">se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fitting the bayesian linear regression</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">stan_glm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>                data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>                prior_intercept <span class="op">=</span> <span class="va">prior</span>,</span>
<span>                refresh <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="r-output"><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      y ~ 1
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 100
 predictors:   1

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 0.2    0.1  0.1   0.2   0.3  
sigma       1.0    0.1  0.9   1.0   1.1  

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 0.2    0.1  0.0   0.2   0.3  

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.0  1.0  2609 
sigma         0.0  1.0  2608 
mean_PPD      0.0  1.0  3185 
log-posterior 0.0  1.0  1693 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).
</code></pre>
</div>
</section><section id="example-4" class="level2" data-number="11.17"><h2 data-number="11.17" class="anchored" data-anchor-id="example-4">
<span class="header-section-number">11.17</span> Example</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Plot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>We can use the <code><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayestestR::bayesfactor_pointnull()</a></code> to calculate the BF using the Savage-Dickey density ratio.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayesfactor_pointnull</a></span><span class="op">(</span><span class="va">fit</span>, null <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="example-5" class="level2" data-number="11.18"><h2 data-number="11.18" class="anchored" data-anchor-id="example-5">
<span class="header-section-number">11.18</span> Example</h2>
<p>You can also use the <code>bf_replication()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bf_replication</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu_original</span>,</span>
<span>                           <span class="va">se_original</span>,</span>
<span>                           <span class="va">replication</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># prior based on the original study</span></span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html">normal</a></span><span class="op">(</span>location <span class="op">=</span> <span class="va">mu_original</span>, scale <span class="op">=</span> <span class="va">se_original</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># to dataframe</span></span>
<span>  <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">replication</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                            data <span class="op">=</span> <span class="va">replication</span>,</span>
<span>                            prior_intercept <span class="op">=</span> <span class="va">prior</span>, </span>
<span>                            refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># avoid printing</span></span>
<span>  </span>
<span>  <span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/bayesfactor_parameters.html">bayesfactor_pointnull</a></span><span class="op">(</span><span class="va">fit</span>, null <span class="op">=</span> <span class="fl">0</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Bayes Factor Replication Rate"</span></span>
<span>  <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="st">"Posterior Distribution ~ Mean: %.3f, SE: %.3f"</span></span>
<span>  <span class="va">replication</span> <span class="op">&lt;-</span> <span class="st">"Evidence for replication: %3f (log %.3f)"</span></span>
<span>  <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="st">"Evidence for non replication: %3f (log %.3f)"</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_green</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">replication</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">non_replication</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="op">-</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">replication</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">replication</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span></span>
<span>    <span class="va">non_replication</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_red</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">non_replication</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span>, <span class="op">-</span><span class="va">bf</span><span class="op">$</span><span class="va">log_BF</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">outlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">fit</span>,</span>
<span>    bf <span class="op">=</span> <span class="va">bf</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_blue</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span>,</span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/rule.html">rule</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="va">posterior</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n"</span>,</span>
<span>    <span class="va">replication</span>,</span>
<span>    <span class="va">non_replication</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">outlist</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="example-6" class="level2" data-number="11.19"><h2 data-number="11.19" class="anchored" data-anchor-id="example-6">
<span class="header-section-number">11.19</span> Example</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bf_replication</span><span class="op">(</span>mu_original <span class="op">=</span> <span class="va">yorig</span>, se_original <span class="op">=</span> <span class="va">se</span>, replication <span class="op">=</span> <span class="va">yrep</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="example-7" class="level2" data-number="11.20"><h2 data-number="11.20" class="anchored" data-anchor-id="example-7">
<span class="header-section-number">11.20</span> Example</h2>
<p>A better custom plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bfplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="va">yorig</span>, <span class="va">se</span><span class="op">)</span>,</span>
<span>  posterior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span> </span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>                <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Original Study (Prior)"</span><span class="op">)</span>,</span>
<span>                linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">yorig</span>, sd <span class="op">=</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>                linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Replication Study (Posterior)"</span><span class="op">)</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, sd <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yorig</span>, sd <span class="op">=</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>, sd <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\delta"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="example-8" class="level2" data-number="11.21"><h2 data-number="11.21" class="anchored" data-anchor-id="example-8">
<span class="header-section-number">11.21</span> Example</h2>
<p>A better custom plot:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="chapter4_files/figure-html/unnamed-chunk-56-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="references" class="level2" data-number="11.22"><h2 data-number="11.22" class="anchored" data-anchor-id="references">
<span class="header-section-number">11.22</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Anderson2024-cx" class="csl-entry" role="listitem">
Anderson, S. F., &amp; Kelley, K. (2024). Sample size planning for replication studies: The devil is in the design. <em>Psychological Methods</em>, <em>29</em>, 844–867. <a href="https://doi.org/10.1037/met0000520">https://doi.org/10.1037/met0000520</a>
</div>
<div id="ref-Brandt2014-da" class="csl-entry" role="listitem">
Brandt, M. J., IJzerman, H., Dijksterhuis, A., Farach, F. J., Geller, J., Giner-Sorolla, R., Grange, J. A., Perugini, M., Spies, J. R., &amp; Veer, A. van ’t. (2014). The replication recipe: What makes for a convincing replication? <em>Journal of Experimental Social Psychology</em>, <em>50</em>, 217–224. <a href="https://doi.org/10.1016/j.jesp.2013.10.005">https://doi.org/10.1016/j.jesp.2013.10.005</a>
</div>
<div id="ref-Bushman2009-zv" class="csl-entry" role="listitem">
Bushman, B. J., &amp; Wang, M. C. (2009). Vote-counting procedures in meta-analysis. In <em><em>The handbook of research synthesis and meta-analysis</em></em> (pp. 207–220). Russell Sage Foundation.
</div>
<div id="ref-Hedges1980-gd" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Olkin, I. (1980). Vote-counting methods in research synthesis. <em>Psychological Bulletin</em>, <em>88</em>, 359–369. <a href="https://doi.org/10.1037/0033-2909.88.2.359">https://doi.org/10.1037/0033-2909.88.2.359</a>
</div>
<div id="ref-Hedges2019-pr" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019a). Consistency of effects is important in replication: Rejoinder to mathur and VanderWeele (2019). <em>Psychological Methods</em>, <em>24</em>, 576–577. <a href="https://doi.org/10.1037/met0000237">https://doi.org/10.1037/met0000237</a>
</div>
<div id="ref-Hedges2019-ar" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019b). More than one replication study is needed for unambiguous tests of replication. <em>Journal of Educational and Behavioral Statistics: A Quarterly Publication Sponsored by the American Educational Research Association and the American Statistical Association</em>, <em>44</em>, 543–570. <a href="https://doi.org/10.3102/1076998619852953">https://doi.org/10.3102/1076998619852953</a>
</div>
<div id="ref-Hedges2019-ry" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019c). Statistical analyses for studying replication: Meta-analytic perspectives. <em>Psychological Methods</em>, <em>24</em>, 557–570. <a href="https://doi.org/10.1037/met0000189">https://doi.org/10.1037/met0000189</a>
</div>
<div id="ref-Hedges2021-of" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2021). The design of replication studies. <em>Journal of the Royal Statistical Society. Series A, (Statistics in Society)</em>, <em>184</em>, 868–886. <a href="https://doi.org/10.1111/rssa.12688">https://doi.org/10.1111/rssa.12688</a>
</div>
<div id="ref-Heyard2024-hv" class="csl-entry" role="listitem">
Heyard, R., Pawel, S., Frese, J., Voelkl, B., Würbel, H., McCann, S., Held, L., Wever, K. E., Hartmann, H., Townsin, L., &amp; Zellers, S. (2024). <em>A scoping review on metrics to quantify reproducibility: A multitude of questions leads to a multitude of metrics</em>. <a href="https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC">https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC</a>
</div>
<div id="ref-Jeffreys1973-bp" class="csl-entry" role="listitem">
Jeffreys, H. (1973). <em>Scientific inference</em>. Cambridge University Press.
</div>
<div id="ref-Lakens2018-ri" class="csl-entry" role="listitem">
Lakens, D., Scheel, A. M., &amp; Isager, P. M. (2018). Equivalence testing for psychological research: A tutorial. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>, 259–269. <a href="https://doi.org/10.1177/2515245918770963">https://doi.org/10.1177/2515245918770963</a>
</div>
<div id="ref-Ly2019-ow" class="csl-entry" role="listitem">
Ly, A., Etz, A., Marsman, M., &amp; Wagenmakers, E.-J. (2019). Replication bayes factors from evidence updating. <em>Behavior Research Methods</em>, <em>51</em>, 2498–2508. <a href="https://doi.org/10.3758/s13428-018-1092-x">https://doi.org/10.3758/s13428-018-1092-x</a>
</div>
<div id="ref-Mathur2019-vh" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2019). Challenges and suggestions for defining replication "success" when effects may be heterogeneous: Comment on hedges and schauer (2019). <em>Psychological Methods</em>, <em>24</em>, 571–575. <a href="https://doi.org/10.1037/met0000223">https://doi.org/10.1037/met0000223</a>
</div>
<div id="ref-Mathur2020-nw" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2020). New statistical metrics for multisite replication projects. <em>Journal of the Royal Statistical Society. Series A, (Statistics in Society)</em>, <em>183</em>, 1145–1166. <a href="https://doi.org/10.1111/rssa.12572">https://doi.org/10.1111/rssa.12572</a>
</div>
<div id="ref-Nosek2020-vh" class="csl-entry" role="listitem">
Nosek, B. A., &amp; Errington, T. M. (2020). What is replication? <em>PLoS Biology</em>, <em>18</em>, e3000691. <a href="https://doi.org/10.1371/journal.pbio.3000691">https://doi.org/10.1371/journal.pbio.3000691</a>
</div>
<div id="ref-Patil2016-vc" class="csl-entry" role="listitem">
Patil, P., Peng, R. D., &amp; Leek, J. T. (2016). What should researchers expect when they replicate studies? A statistical view of replicability in psychological science. <em>Perspectives on Psychological Science: A Journal of the Association for Psychological Science</em>, <em>11</em>, 539–544. <a href="https://doi.org/10.1177/1745691616646366">https://doi.org/10.1177/1745691616646366</a>
</div>
<div id="ref-Rouder2009-jh" class="csl-entry" role="listitem">
Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G. (2009). Bayesian t tests for accepting and rejecting the null hypothesis. <em>Psychonomic Bulletin &amp; Review</em>, <em>16</em>, 225–237. <a href="https://doi.org/10.3758/PBR.16.2.225">https://doi.org/10.3758/PBR.16.2.225</a>
</div>
<div id="ref-Schauer2022-mj" class="csl-entry" role="listitem">
Schauer, J. M. (2022). Replicability and meta-analysis. In W. O’Donohue, A. Masuda, &amp; S. Lilienfeld (Eds.), <em>Avoiding questionable research practices in applied psychology</em> (pp. 301–342). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-031-04968-2_14">https://doi.org/10.1007/978-3-031-04968-2_14</a>
</div>
<div id="ref-Schauer2020-tw" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2020). Assessing heterogeneity and power in replications of psychological experiments. <em>Psychological Bulletin</em>, <em>146</em>, 701–719. <a href="https://doi.org/10.1037/bul0000232">https://doi.org/10.1037/bul0000232</a>
</div>
<div id="ref-Schauer2021-ja" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2021). Reconsidering statistical methods for assessing replication. <em>Psychological Methods</em>, <em>26</em>, 127–139. <a href="https://doi.org/10.1037/met0000302">https://doi.org/10.1037/met0000302</a>
</div>
<div id="ref-Schmidt2014-kw" class="csl-entry" role="listitem">
Schmidt, F. L., &amp; Hunter, J. E. (2014). <em>Methods of meta-analysis: Correcting error and bias in research findings</em> (3rd ed.). SAGE Publications. <a href="https://doi.org/10.4135/9781483398105">https://doi.org/10.4135/9781483398105</a>
</div>
<div id="ref-Schmidt2009-mq" class="csl-entry" role="listitem">
Schmidt, S. (2009). Shall we really do it again? The powerful concept of replication is neglected in the social sciences. <em>Review of General Psychology: Journal of Division 1, of the American Psychological Association</em>, <em>13</em>, 90–100. <a href="https://doi.org/10.1037/a0015108">https://doi.org/10.1037/a0015108</a>
</div>
<div id="ref-Simonsohn2015-kg" class="csl-entry" role="listitem">
Simonsohn, U. (2015). Small telescopes: Detectability and the evaluation of replication results: Detectability and the evaluation of replication results. <em>Psychological Science</em>, <em>26</em>, 559–569. <a href="https://doi.org/10.1177/0956797614567341">https://doi.org/10.1177/0956797614567341</a>
</div>
<div id="ref-Spence2016-tz" class="csl-entry" role="listitem">
Spence, J. R., &amp; Stanley, D. J. (2016). Prediction interval: What to expect when you’re expecting … a replication. <em>PloS One</em>, <em>11</em>, e0162874. <a href="https://doi.org/10.1371/journal.pone.0162874">https://doi.org/10.1371/journal.pone.0162874</a>
</div>
<div id="ref-Valentine2011-yq" class="csl-entry" role="listitem">
Valentine, J. C., Biglan, A., Boruch, R. F., Castro, F. G., Collins, L. M., Flay, B. R., Kellam, S., Mościcki, E. K., &amp; Schinke, S. P. (2011). Replication in prevention science. <em>Prevention Science: The Official Journal of the Society for Prevention Research</em>, <em>12</em>, 103–117. <a href="https://doi.org/10.1007/s11121-011-0217-6">https://doi.org/10.1007/s11121-011-0217-6</a>
</div>
<div id="ref-Verhagen2014-tx" class="csl-entry" role="listitem">
Verhagen, J., &amp; Wagenmakers, E.-J. (2014). Bayesian tests to quantify the result of a replication attempt. <em>Journal of Experimental Psychology. General</em>, <em>143</em>, 1457–1475. <a href="https://doi.org/10.1037/a0036731">https://doi.org/10.1037/a0036731</a>
</div>
<div id="ref-Wagenmakers2010-fj" class="csl-entry" role="listitem">
Wagenmakers, E.-J., Lodewyckx, T., Kuriyal, H., &amp; Grasman, R. (2010). Bayesian hypothesis testing for psychologists: A tutorial on the savage–dickey method. <em>Cognitive Psychology</em>, <em>60</em>, 158–189. <a href="https://doi.org/10.1016/j.cogpsych.2009.12.001">https://doi.org/10.1016/j.cogpsych.2009.12.001</a>
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The approach has been debated by a series of opinion papers <span class="citation" data-cites="Hedges2019-pr Mathur2019-vh">(see <a href="#ref-Hedges2019-pr" role="doc-biblioref">Hedges &amp; Schauer, 2019a</a>; <a href="#ref-Mathur2019-vh" role="doc-biblioref">Mathur &amp; VanderWeele, 2019</a>)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>see also <span class="citation" data-cites="Ly2019-ow">Ly et al. (<a href="#ref-Ly2019-ow" role="doc-biblioref">2019</a>)</span> for an improvement<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/chapter3.html" class="pagination-link" aria-label="Probability of Replication">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability of Replication</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter5.html" class="pagination-link" aria-label="Meta-analysis and publication bias">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>