<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Meta-analysis and publication bias – The three Rs of trustworthy science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter6.html" rel="next">
<link href="../chapters/chapter4.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d536d1a7baed4b06fb80168836a8c311.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/chapter5.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">The three Rs of trustworthy science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is a replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Replicability and reproducibility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability of Replication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Improving study robustness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Planning a replication study</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#meta-analysis" id="toc-meta-analysis" class="nav-link active" data-scroll-target="#meta-analysis"><span class="header-section-number">6</span> Meta-analysis</a>
  <ul class="collapse">
<li><a href="#meta-analysis-1" id="toc-meta-analysis-1" class="nav-link" data-scroll-target="#meta-analysis-1"><span class="header-section-number">6.1</span> Meta-analysis</a></li>
  <li><a href="#meta-analysis-and-systematic-review" id="toc-meta-analysis-and-systematic-review" class="nav-link" data-scroll-target="#meta-analysis-and-systematic-review"><span class="header-section-number">6.2</span> Meta-analysis and Systematic Review</a></li>
  <li><a href="#before-the-fun-part" id="toc-before-the-fun-part" class="nav-link" data-scroll-target="#before-the-fun-part"><span class="header-section-number">6.3</span> Before the fun part…</a></li>
  <li><a href="#unstandardized-effect-sizes" id="toc-unstandardized-effect-sizes" class="nav-link" data-scroll-target="#unstandardized-effect-sizes"><span class="header-section-number">6.4</span> Unstandardized effect sizes</a></li>
  <li><a href="#unstandardized-effect-sizes-1" id="toc-unstandardized-effect-sizes-1" class="nav-link" data-scroll-target="#unstandardized-effect-sizes-1"><span class="header-section-number">6.5</span> Unstandardized effect sizes</a></li>
  <li><a href="#unstandardized-effect-sizes-2" id="toc-unstandardized-effect-sizes-2" class="nav-link" data-scroll-target="#unstandardized-effect-sizes-2"><span class="header-section-number">6.6</span> Unstandardized effect sizes</a></li>
  <li><a href="#standardized-effect-sizes" id="toc-standardized-effect-sizes" class="nav-link" data-scroll-target="#standardized-effect-sizes"><span class="header-section-number">6.7</span> Standardized effect sizes</a></li>
  <li><a href="#standardized-effect-sizes-1" id="toc-standardized-effect-sizes-1" class="nav-link" data-scroll-target="#standardized-effect-sizes-1"><span class="header-section-number">6.8</span> Standardized effect sizes</a></li>
  <li><a href="#standardized-vs-unstandardized" id="toc-standardized-vs-unstandardized" class="nav-link" data-scroll-target="#standardized-vs-unstandardized"><span class="header-section-number">6.9</span> Standardized vs unstandardized</a></li>
  <li><a href="#standardized-vs-unstandardized-1" id="toc-standardized-vs-unstandardized-1" class="nav-link" data-scroll-target="#standardized-vs-unstandardized-1"><span class="header-section-number">6.10</span> Standardized vs unstandardized</a></li>
  <li><a href="#sec-effsize-se" id="toc-sec-effsize-se" class="nav-link" data-scroll-target="#sec-effsize-se"><span class="header-section-number">6.11</span> Effect size sampling variability</a></li>
  <li><a href="#effect-size-sampling-variability" id="toc-effect-size-sampling-variability" class="nav-link" data-scroll-target="#effect-size-sampling-variability"><span class="header-section-number">6.12</span> Effect size sampling variability</a></li>
  <li><a href="#unstandardized-effect-sizes-3" id="toc-unstandardized-effect-sizes-3" class="nav-link" data-scroll-target="#unstandardized-effect-sizes-3"><span class="header-section-number">6.13</span> Unstandardized effect sizes</a></li>
  </ul>
</li>
  <li>
<a href="#simulating-a-single-study" id="toc-simulating-a-single-study" class="nav-link" data-scroll-target="#simulating-a-single-study"><span class="header-section-number">7</span> Simulating a single study</a>
  <ul class="collapse">
<li><a href="#simulating-a-single-study---umd" id="toc-simulating-a-single-study---umd" class="nav-link" data-scroll-target="#simulating-a-single-study---umd"><span class="header-section-number">7.1</span> Simulating a single study - UMD</a></li>
  <li><a href="#simulating-a-single-study---umd-1" id="toc-simulating-a-single-study---umd-1" class="nav-link" data-scroll-target="#simulating-a-single-study---umd-1"><span class="header-section-number">7.2</span> Simulating a single study - UMD</a></li>
  <li><a href="#simulating-a-single-study---umd-2" id="toc-simulating-a-single-study---umd-2" class="nav-link" data-scroll-target="#simulating-a-single-study---umd-2"><span class="header-section-number">7.3</span> Simulating a single study - UMD</a></li>
  <li><a href="#sec-umd-sampling-distribution" id="toc-sec-umd-sampling-distribution" class="nav-link" data-scroll-target="#sec-umd-sampling-distribution"><span class="header-section-number">7.4</span> Simulating a single study - UMD</a></li>
  <li><a href="#simulating-a-single-study---smd" id="toc-simulating-a-single-study---smd" class="nav-link" data-scroll-target="#simulating-a-single-study---smd"><span class="header-section-number">7.5</span> Simulating a single study - SMD</a></li>
  <li><a href="#simulating-a-single-study---smd-1" id="toc-simulating-a-single-study---smd-1" class="nav-link" data-scroll-target="#simulating-a-single-study---smd-1"><span class="header-section-number">7.6</span> Simulating a single study - SMD</a></li>
  <li><a href="#simulating-a-single-study---pearson-rho" id="toc-simulating-a-single-study---pearson-rho" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho"><span class="header-section-number">7.7</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#simulating-a-single-study---pearson-rho-1" id="toc-simulating-a-single-study---pearson-rho-1" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho-1"><span class="header-section-number">7.8</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#simulating-a-single-study---pearson-rho-2" id="toc-simulating-a-single-study---pearson-rho-2" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho-2"><span class="header-section-number">7.9</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#simulating-a-single-study---pearson-rho-3" id="toc-simulating-a-single-study---pearson-rho-3" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho-3"><span class="header-section-number">7.10</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#simulating-a-single-study---pearson-rho-4" id="toc-simulating-a-single-study---pearson-rho-4" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho-4"><span class="header-section-number">7.11</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#simulating-a-single-study---pearson-rho-5" id="toc-simulating-a-single-study---pearson-rho-5" class="nav-link" data-scroll-target="#simulating-a-single-study---pearson-rho-5"><span class="header-section-number">7.12</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span></a></li>
  <li><a href="#more-on-effect-sizes" id="toc-more-on-effect-sizes" class="nav-link" data-scroll-target="#more-on-effect-sizes"><span class="header-section-number">7.13</span> More on effect sizes</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra" id="toc-simulating-from-sampling-distributions-extra" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra"><span class="header-section-number">7.14</span> Simulating from sampling distributions [#extra]</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra-1" id="toc-simulating-from-sampling-distributions-extra-1" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra-1"><span class="header-section-number">7.15</span> Simulating from sampling distributions [#extra]</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra-2" id="toc-simulating-from-sampling-distributions-extra-2" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra-2"><span class="header-section-number">7.16</span> Simulating from sampling distributions [#extra]</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra-3" id="toc-simulating-from-sampling-distributions-extra-3" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra-3"><span class="header-section-number">7.17</span> Simulating from sampling distributions [#extra]</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra-4" id="toc-simulating-from-sampling-distributions-extra-4" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra-4"><span class="header-section-number">7.18</span> Simulating from sampling distributions [#extra]</a></li>
  <li><a href="#simulating-from-sampling-distributions-extra-5" id="toc-simulating-from-sampling-distributions-extra-5" class="nav-link" data-scroll-target="#simulating-from-sampling-distributions-extra-5"><span class="header-section-number">7.19</span> Simulating from sampling distributions [#extra]</a></li>
  </ul>
</li>
  <li>
<a href="#simulation-setup" id="toc-simulation-setup" class="nav-link" data-scroll-target="#simulation-setup"><span class="header-section-number">8</span> Simulation setup</a>
  <ul class="collapse">
<li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation"><span class="header-section-number">8.1</span> Notation</a></li>
  <li><a href="#simulation-setup-1" id="toc-simulation-setup-1" class="nav-link" data-scroll-target="#simulation-setup-1"><span class="header-section-number">8.2</span> Simulation setup</a></li>
  <li><a href="#simulation-setup-2" id="toc-simulation-setup-2" class="nav-link" data-scroll-target="#simulation-setup-2"><span class="header-section-number">8.3</span> Simulation setup</a></li>
  <li><a href="#simulation-setup-3" id="toc-simulation-setup-3" class="nav-link" data-scroll-target="#simulation-setup-3"><span class="header-section-number">8.4</span> Simulation setup</a></li>
  <li><a href="#simulation-setup---disclaimer" id="toc-simulation-setup---disclaimer" class="nav-link" data-scroll-target="#simulation-setup---disclaimer"><span class="header-section-number">8.5</span> Simulation setup - Disclaimer</a></li>
  <li><a href="#simulation-setup---disclaimer-1" id="toc-simulation-setup---disclaimer-1" class="nav-link" data-scroll-target="#simulation-setup---disclaimer-1"><span class="header-section-number">8.6</span> Simulation setup - Disclaimer</a></li>
  </ul>
</li>
  <li>
<a href="#combining-studies" id="toc-combining-studies" class="nav-link" data-scroll-target="#combining-studies"><span class="header-section-number">9</span> Combining studies</a>
  <ul class="collapse">
<li><a href="#combining-studies-1" id="toc-combining-studies-1" class="nav-link" data-scroll-target="#combining-studies-1"><span class="header-section-number">9.1</span> Combining studies</a></li>
  <li><a href="#combining-studies-2" id="toc-combining-studies-2" class="nav-link" data-scroll-target="#combining-studies-2"><span class="header-section-number">9.2</span> Combining studies</a></li>
  <li><a href="#weighting-studies" id="toc-weighting-studies" class="nav-link" data-scroll-target="#weighting-studies"><span class="header-section-number">9.3</span> Weighting studies</a></li>
  <li><a href="#weighting-studies-1" id="toc-weighting-studies-1" class="nav-link" data-scroll-target="#weighting-studies-1"><span class="header-section-number">9.4</span> Weighting studies</a></li>
  <li><a href="#weighting-studies-2" id="toc-weighting-studies-2" class="nav-link" data-scroll-target="#weighting-studies-2"><span class="header-section-number">9.5</span> Weighting studies</a></li>
  </ul>
</li>
  <li>
<a href="#equal-effects-ee-meta-analysis" id="toc-equal-effects-ee-meta-analysis" class="nav-link" data-scroll-target="#equal-effects-ee-meta-analysis"><span class="header-section-number">10</span> Equal-effects (EE) meta-analysis</a>
  <ul class="collapse">
<li><a href="#ee-meta-analysis" id="toc-ee-meta-analysis" class="nav-link" data-scroll-target="#ee-meta-analysis"><span class="header-section-number">10.1</span> EE meta-analysis</a></li>
  <li><a href="#ee-meta-analysis-formally" id="toc-ee-meta-analysis-formally" class="nav-link" data-scroll-target="#ee-meta-analysis-formally"><span class="header-section-number">10.2</span> EE meta-analysis, formally</a></li>
  <li><a href="#ee-meta-analysis-1" id="toc-ee-meta-analysis-1" class="nav-link" data-scroll-target="#ee-meta-analysis-1"><span class="header-section-number">10.3</span> EE meta-analysis</a></li>
  <li><a href="#simulating-an-ee-model" id="toc-simulating-an-ee-model" class="nav-link" data-scroll-target="#simulating-an-ee-model"><span class="header-section-number">10.4</span> Simulating an EE model</a></li>
  <li><a href="#sec-ee-impact-n" id="toc-sec-ee-impact-n" class="nav-link" data-scroll-target="#sec-ee-impact-n"><span class="header-section-number">10.5</span> Simulating an EE modelm</a></li>
  <li><a href="#simulating-an-ee-model-1" id="toc-simulating-an-ee-model-1" class="nav-link" data-scroll-target="#simulating-an-ee-model-1"><span class="header-section-number">10.6</span> Simulating an EE model</a></li>
  <li><a href="#fitting-an-ee-model" id="toc-fitting-an-ee-model" class="nav-link" data-scroll-target="#fitting-an-ee-model"><span class="header-section-number">10.7</span> Fitting an EE model</a></li>
  <li><a href="#interpreting-an-ee-model" id="toc-interpreting-an-ee-model" class="nav-link" data-scroll-target="#interpreting-an-ee-model"><span class="header-section-number">10.8</span> Interpreting an EE model</a></li>
  <li><a href="#interpreting-an-ee-model-1" id="toc-interpreting-an-ee-model-1" class="nav-link" data-scroll-target="#interpreting-an-ee-model-1"><span class="header-section-number">10.9</span> Interpreting an EE model</a></li>
  <li><a href="#interpreting-an-ee-model-2" id="toc-interpreting-an-ee-model-2" class="nav-link" data-scroll-target="#interpreting-an-ee-model-2"><span class="header-section-number">10.10</span> Interpreting an EE Model</a></li>
  <li><a href="#interpreting-an-ee-model-3" id="toc-interpreting-an-ee-model-3" class="nav-link" data-scroll-target="#interpreting-an-ee-model-3"><span class="header-section-number">10.11</span> Interpreting an EE Model</a></li>
  <li><a href="#ee-model-as-a-weighted-average" id="toc-ee-model-as-a-weighted-average" class="nav-link" data-scroll-target="#ee-model-as-a-weighted-average"><span class="header-section-number">10.12</span> EE model as a weighted Average</a></li>
  </ul>
</li>
  <li>
<a href="#random-effects-re-meta-analysis" id="toc-random-effects-re-meta-analysis" class="nav-link" data-scroll-target="#random-effects-re-meta-analysis"><span class="header-section-number">11</span> Random-effects (RE) meta-analysis</a>
  <ul class="collapse">
<li><a href="#are-the-ee-assumptions-realistic" id="toc-are-the-ee-assumptions-realistic" class="nav-link" data-scroll-target="#are-the-ee-assumptions-realistic"><span class="header-section-number">11.1</span> Are the EE assumptions realistic?</a></li>
  <li><a href="#are-the-ee-assumptions-realistic-1" id="toc-are-the-ee-assumptions-realistic-1" class="nav-link" data-scroll-target="#are-the-ee-assumptions-realistic-1"><span class="header-section-number">11.2</span> Are the EE assumptions realistic?</a></li>
  <li><a href="#random-effects-model-re" id="toc-random-effects-model-re" class="nav-link" data-scroll-target="#random-effects-model-re"><span class="header-section-number">11.3</span> Random-effects model (RE)</a></li>
  <li><a href="#re-model" id="toc-re-model" class="nav-link" data-scroll-target="#re-model"><span class="header-section-number">11.4</span> RE model</a></li>
  <li><a href="#re-model-estimation" id="toc-re-model-estimation" class="nav-link" data-scroll-target="#re-model-estimation"><span class="header-section-number">11.5</span> RE model estimation</a></li>
  <li><a href="#re-vs-ee-model" id="toc-re-vs-ee-model" class="nav-link" data-scroll-target="#re-vs-ee-model"><span class="header-section-number">11.6</span> RE vs EE model</a></li>
  <li><a href="#simulating-a-re-model" id="toc-simulating-a-re-model" class="nav-link" data-scroll-target="#simulating-a-re-model"><span class="header-section-number">11.7</span> Simulating a RE Model</a></li>
  <li><a href="#simulating-a-re-model-1" id="toc-simulating-a-re-model-1" class="nav-link" data-scroll-target="#simulating-a-re-model-1"><span class="header-section-number">11.8</span> Simulating a RE model</a></li>
  <li><a href="#simulating-a-re-model-2" id="toc-simulating-a-re-model-2" class="nav-link" data-scroll-target="#simulating-a-re-model-2"><span class="header-section-number">11.9</span> Simulating a RE model</a></li>
  <li><a href="#simulating-a-re-model-3" id="toc-simulating-a-re-model-3" class="nav-link" data-scroll-target="#simulating-a-re-model-3"><span class="header-section-number">11.10</span> Simulating a RE model</a></li>
  <li><a href="#simulating-a-re-model-4" id="toc-simulating-a-re-model-4" class="nav-link" data-scroll-target="#simulating-a-re-model-4"><span class="header-section-number">11.11</span> Simulating a RE Model</a></li>
  <li><a href="#re-model-estimation-1" id="toc-re-model-estimation-1" class="nav-link" data-scroll-target="#re-model-estimation-1"><span class="header-section-number">11.12</span> RE model estimation</a></li>
  <li><a href="#fitting-a-re-model" id="toc-fitting-a-re-model" class="nav-link" data-scroll-target="#fitting-a-re-model"><span class="header-section-number">11.13</span> Fitting a RE model</a></li>
  <li><a href="#intepreting-the-re-model" id="toc-intepreting-the-re-model" class="nav-link" data-scroll-target="#intepreting-the-re-model"><span class="header-section-number">11.14</span> Intepreting the RE model</a></li>
  <li><a href="#estimating-tau2" id="toc-estimating-tau2" class="nav-link" data-scroll-target="#estimating-tau2"><span class="header-section-number">11.15</span> Estimating <span class="math inline">\(\tau^2\)</span></a></li>
  <li><a href="#estimating-tau2-1" id="toc-estimating-tau2-1" class="nav-link" data-scroll-target="#estimating-tau2-1"><span class="header-section-number">11.16</span> Estimating <span class="math inline">\(\tau^2\)</span></a></li>
  <li><a href="#intepreting-heterogeneity-tau2" id="toc-intepreting-heterogeneity-tau2" class="nav-link" data-scroll-target="#intepreting-heterogeneity-tau2"><span class="header-section-number">11.17</span> Intepreting heterogeneity <span class="math inline">\(\tau^2\)</span></a></li>
  <li><a href="#intepreting-tau2" id="toc-intepreting-tau2" class="nav-link" data-scroll-target="#intepreting-tau2"><span class="header-section-number">11.18</span> Intepreting <span class="math inline">\(\tau^2\)</span></a></li>
  <li><a href="#the-q-statistics" id="toc-the-q-statistics" class="nav-link" data-scroll-target="#the-q-statistics"><span class="header-section-number">11.19</span> The <span class="math inline">\(Q\)</span> Statistics</a></li>
  <li><a href="#the-q-statistics-1" id="toc-the-q-statistics-1" class="nav-link" data-scroll-target="#the-q-statistics-1"><span class="header-section-number">11.20</span> The <span class="math inline">\(Q\)</span> Statistics</a></li>
  <li><a href="#the-q-statistics-2" id="toc-the-q-statistics-2" class="nav-link" data-scroll-target="#the-q-statistics-2"><span class="header-section-number">11.21</span> The <span class="math inline">\(Q\)</span> Statistics</a></li>
  <li><a href="#the-q-statistics-3" id="toc-the-q-statistics-3" class="nav-link" data-scroll-target="#the-q-statistics-3"><span class="header-section-number">11.22</span> The <span class="math inline">\(Q\)</span> Statistics</a></li>
  <li><a href="#i2-higgins2002-fh" id="toc-i2-higgins2002-fh" class="nav-link" data-scroll-target="#i2-higgins2002-fh"><span class="header-section-number">11.23</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins &amp; Thompson, 2002)</span></a></li>
  <li><a href="#i2-higgins2002-fh-1" id="toc-i2-higgins2002-fh-1" class="nav-link" data-scroll-target="#i2-higgins2002-fh-1"><span class="header-section-number">11.24</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins &amp; Thompson, 2002)</span></a></li>
  <li><a href="#i2-higgins2002-fh-2" id="toc-i2-higgins2002-fh-2" class="nav-link" data-scroll-target="#i2-higgins2002-fh-2"><span class="header-section-number">11.25</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(Higgins &amp; Thompson, 2002)</span></a></li>
  <li><a href="#what-about-tildev" id="toc-what-about-tildev" class="nav-link" data-scroll-target="#what-about-tildev"><span class="header-section-number">11.26</span> What about <span class="math inline">\(\tilde{v}\)</span>?</a></li>
  <li><a href="#what-about-tildev-1" id="toc-what-about-tildev-1" class="nav-link" data-scroll-target="#what-about-tildev-1"><span class="header-section-number">11.27</span> What about <span class="math inline">\(\tilde{v}\)</span>?</a></li>
  <li><a href="#what-about-tildev-2" id="toc-what-about-tildev-2" class="nav-link" data-scroll-target="#what-about-tildev-2"><span class="header-section-number">11.28</span> What about <span class="math inline">\(\tilde{v}\)</span>?</a></li>
  <li><a href="#h2" id="toc-h2" class="nav-link" data-scroll-target="#h2"><span class="header-section-number">11.29</span> <span class="math inline">\(H^2\)</span></a></li>
  <li><a href="#h2-1" id="toc-h2-1" class="nav-link" data-scroll-target="#h2-1"><span class="header-section-number">11.30</span> <span class="math inline">\(H^2\)</span></a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">11.31</span> Confidence Intervals</a></li>
  <li><a href="#confidence-intervals-1" id="toc-confidence-intervals-1" class="nav-link" data-scroll-target="#confidence-intervals-1"><span class="header-section-number">11.32</span> Confidence Intervals</a></li>
  <li><a href="#confidence-intervals-2" id="toc-confidence-intervals-2" class="nav-link" data-scroll-target="#confidence-intervals-2"><span class="header-section-number">11.33</span> Confidence Intervals</a></li>
  <li><a href="#confidence-intervals-3" id="toc-confidence-intervals-3" class="nav-link" data-scroll-target="#confidence-intervals-3"><span class="header-section-number">11.34</span> Confidence Intervals</a></li>
  <li><a href="#confidence-intervals-4" id="toc-confidence-intervals-4" class="nav-link" data-scroll-target="#confidence-intervals-4"><span class="header-section-number">11.35</span> Confidence Intervals</a></li>
  <li><a href="#prediction-intervals-pi" id="toc-prediction-intervals-pi" class="nav-link" data-scroll-target="#prediction-intervals-pi"><span class="header-section-number">11.36</span> Prediction intervals (PI)</a></li>
  <li><a href="#pi-for-a-sample-mean" id="toc-pi-for-a-sample-mean" class="nav-link" data-scroll-target="#pi-for-a-sample-mean"><span class="header-section-number">11.37</span> PI for a sample mean</a></li>
  <li><a href="#pi-in-meta-analysis" id="toc-pi-in-meta-analysis" class="nav-link" data-scroll-target="#pi-in-meta-analysis"><span class="header-section-number">11.38</span> PI in meta-analysis</a></li>
  <li><a href="#pi-in-meta-analysis-1" id="toc-pi-in-meta-analysis-1" class="nav-link" data-scroll-target="#pi-in-meta-analysis-1"><span class="header-section-number">11.39</span> PI in meta-analysis</a></li>
  <li><a href="#references-download-.bib-file" id="toc-references-download-.bib-file" class="nav-link" data-scroll-target="#references-download-.bib-file"><span class="header-section-number">11.40</span> References </a><button class="btn"><a href="#references-download-.bib-file" id="toc-references-download-.bib-file" class="nav-link" data-scroll-target="#references-download-.bib-file"><i class="fa fa-download"></i></a><a href="data:text/x-bibtex;base64,QEFSVElDTEV7VmllY2h0YmF1ZXIyMDA1LXp0LAogIHRpdGxlID0ge0JpYXMgYW5kIGVmZmljaWVuY3kgb2YgbWV0YS1hbmFseXRpYyB2YXJpYW5jZSBlc3RpbWF0b3JzIGluIHRoZQogIHJhbmRvbS1lZmZlY3RzIG1vZGVsfSwKICBhdXRob3IgPSB7VmllY2h0YmF1ZXIsIFdvbGZnYW5nfSwKICBqb3VybmFsdGl0bGUgPSB7Sm91cm5hbCBvZiBlZHVjYXRpb25hbCBhbmQgYmVoYXZpb3JhbCBzdGF0aXN0aWNzOiBhIHF1YXJ0ZXJseQogIHB1YmxpY2F0aW9uIHNwb25zb3JlZCBieSB0aGUgQW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gYW5kIHRoZQogIEFtZXJpY2FuIFN0YXRpc3RpY2FsIEFzc29jaWF0aW9ufSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gKEFFUkEpfSwKICB2b2x1bWUgPSB7MzB9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezI2MS0yOTN9LAogIGRhdGUgPSB7MjAwNS0wOX0sCiAgZG9pID0gezEwLjMxMDIvMTA3Njk5ODYwMzAwMDMyNjF9LAogIGlzc24gPSB7MTA3Ni05OTg2LDE5MzUtMTA1NH0sCiAgYWJzdHJhY3QgPSB7VGhlIG1ldGEtYW5hbHl0aWMgcmFuZG9tIGVmZmVjdHMgbW9kZWwgYXNzdW1lcyB0aGF0IHRoZQogIHZhcmlhYmlsaXR5IGluIGVmZmVjdCBzaXplIGVzdGltYXRlcyBkcmF3biBmcm9tIGEgc2V0IG9mIHN0dWRpZXMgY2FuIGJlCiAgZGVjb21wb3NlZCBpbnRvIHR3byBwYXJ0czogaGV0ZXJvZ2VuZWl0eSBkdWUgdG8gcmFuZG9tIHBvcHVsYXRpb24gZWZmZWN0cyBhbmQKICBzYW1wbGluZyB2YXJpYW5jZS4gSW4gdGhpcyBjb250ZXh0LCB0aGUgdXN1YWwgZ29hbCBpcyB0byBlc3RpbWF0ZSB0aGUgY2VudHJhbAogIHRlbmRlbmN5IGFuZCB0aGUgYW1vdW50IG9mIGhldGVyb2dlbmVpdHkgaW4gdGhlIHBvcHVsYXRpb24gZWZmZWN0IHNpemVzLiBUaGUKICBhbW91bnQgb2YgaGV0ZXJvZ2VuZWl0eSBpbiBhIHNldCBvZiBlZmZlY3Qgc2l6ZXMgaGFzIGltcGxpY2F0aW9ucyByZWdhcmRpbmcKICB0aGUgaW50ZXJwcmV0YXRpb24gb2YgdGhlIG1ldGEtYW5hbHl0aWMgZmluZGluZ3MgYW5kIG9mdGVuIHNlcnZlcyBhcyBhbgogIGluZGljYXRvciBmb3IgdGhlIHByZXNlbmNlIG9mIHBvdGVudGlhbCBtb2RlcmF0b3IgdmFyaWFibGVzLiBGaXZlIHBvcHVsYXRpb24KICBoZXRlcm9nZW5laXR5IGVzdGltYXRvcnMgd2VyZSBjb21wYXJlZCBpbiB0aGlzIGFydGljbGUgYW5hbHl0aWNhbGx5IGFuZCB2aWEKICBNb250ZSBDYXJsbyBzaW11bGF0aW9ucyB3aXRoIHJlc3BlY3QgdG8gdGhlaXIgYmlhcyBhbmQgZWZmaWNpZW5jeS59LAogIHVybCA9IHtodHRwczovL3NjaG9sYXIuZ29vZ2xlLmNvbS9jaXRhdGlvbnM/dmlld19vcD12aWV3X2NpdGF0aW9uJmhsPWVuJnVzZXI9Sjg5UlhKa0FBQUFKJmNpdGF0aW9uX2Zvcl92aWV3PUo4OVJYSmtBQUFBSjpxak1ha0ZIRHk3c0N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQk9PS3tIYXJyZXIyMDIxLWdvLAogIHRpdGxlID0ge0RvaW5nIG1ldGEtYW5hbHlzaXMgd2l0aCBSOiBBIGhhbmRzLW9uIGd1aWRlfSwKICBhdXRob3IgPSB7SGFycmVyLCBNYXRoaWFzIGFuZCBDdWlqcGVycywgUGltIGFuZCBGdXJ1a2F3YSwgVG9zaGkgYW5kIEViZXJ0LAogIERhdmlkfSwKICBwdWJsaXNoZXIgPSB7Q1JDIFByZXNzfSwKICBsb2NhdGlvbiA9IHtMb25kb24sIEVuZ2xhbmR9LAogIGVkaXRpb24gPSB7MXN0fSwKICBkYXRlID0gezIwMjEtMDktMTN9LAogIHBhZ2V0b3RhbCA9IHs0NzR9LAogIGlzYm4gPSB7OTc4MDM2NzYxMDA3NH0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe1Zlcm9uaWtpMjAxNi1udywKICB0aXRsZSA9IHtNZXRob2RzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlIGFuZCBpdHMgdW5jZXJ0YWludHkgaW4KICBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7VmVyb25pa2ksIEFyZXRpIEFuZ2VsaWtpIGFuZCBKYWNrc29uLCBEYW4gYW5kIFZpZWNodGJhdWVyLCBXb2xmZ2FuZwogIGFuZCBCZW5kZXIsIFJhbGYgYW5kIEJvd2RlbiwgSmFjayBhbmQgS25hcHAsIEd1aWRvIGFuZCBLdXNzLCBPbGl2ZXIgYW5kCiAgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgTGFuZ2FuLCBEZWFuIGFuZCBTYWxhbnRpLCBHZW9yZ2lhfSwKICBqb3VybmFsdGl0bGUgPSB7UmVzZWFyY2ggc3ludGhlc2lzIG1ldGhvZHN9LAogIHB1Ymxpc2hlciA9IHtXaWxleX0sCiAgdm9sdW1lID0gezd9LAogIGlzc3VlID0gezF9LAogIHBhZ2VzID0gezU1LTc5fSwKICBkYXRlID0gezIwMTYtMDN9LAogIGRvaSA9IHsxMC4xMDAyL2pyc20uMTE2NH0sCiAgcG1jID0ge1BNQzQ5NTAwMzB9LAogIHBtaWQgPSB7MjYzMzIxNDR9LAogIGlzc24gPSB7MTc1OS0yODc5LDE3NTktMjg4N30sCiAgYWJzdHJhY3QgPSB7TWV0YS1hbmFseXNlcyBhcmUgdHlwaWNhbGx5IHVzZWQgdG8gZXN0aW1hdGUgdGhlIG92ZXJhbGwvbWVhbiBvZgogIGFuIG91dGNvbWUgb2YgaW50ZXJlc3QuIEhvd2V2ZXIsIGluZmVyZW5jZSBhYm91dCBiZXR3ZWVuLXN0dWR5IHZhcmlhYmlsaXR5LAogIHdoaWNoIGlzIHR5cGljYWxseSBtb2RlbGxlZCB1c2luZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgcGFyYW1ldGVyLCBpcwogIHVzdWFsbHkgYW4gYWRkaXRpb25hbCBhaW0uIFRoZSBEZXJTaW1vbmlhbiBhbmQgTGFpcmQgbWV0aG9kLCBjdXJyZW50bHkgd2lkZWx5CiAgdXNlZCBieSBkZWZhdWx0IHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLCBoYXMgYmVlbiBsb25nCiAgY2hhbGxlbmdlZC4gT3VyIGFpbSBpcyB0byBpZGVudGlmeSBrbm93biBtZXRob2RzIGZvciBlc3RpbWF0aW9uIG9mIHRoZQogIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyBjb3JyZXNwb25kaW5nIHVuY2VydGFpbnR5LCBhbmQgdG8gc3VtbWFyaXNlIHRoZQogIHNpbXVsYXRpb24gYW5kIGVtcGlyaWNhbCBldmlkZW5jZSB0aGF0IGNvbXBhcmVzIHRoZW0uIFdlIGlkZW50aWZpZWQgMTYKICBlc3RpbWF0b3JzIGZvciB0aGUgYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSwgc2V2ZW4gbWV0aG9kcyB0byBjYWxjdWxhdGUKICBjb25maWRlbmNlIGludGVydmFscywgYW5kIHNldmVyYWwgY29tcGFyYXRpdmUgc3R1ZGllcy4gU2ltdWxhdGlvbiBzdHVkaWVzCiAgc3VnZ2VzdCB0aGF0IGZvciBib3RoIGRpY2hvdG9tb3VzIGFuZCBjb250aW51b3VzIGRhdGEgdGhlIGVzdGltYXRvciBwcm9wb3NlZAogIGJ5IFBhdWxlIGFuZCBNYW5kZWwgYW5kIGZvciBjb250aW51b3VzIGRhdGEgdGhlIHJlc3RyaWN0ZWQgbWF4aW11bSBsaWtlbGlob29kCiAgZXN0aW1hdG9yIGFyZSBiZXR0ZXIgYWx0ZXJuYXRpdmVzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLgogIEJhc2VkIG9uIHRoZSBzY2VuYXJpb3MgYW5kIHJlc3VsdHMgcHJlc2VudGVkIGluIHRoZSBwdWJsaXNoZWQgc3R1ZGllcywgd2UKICByZWNvbW1lbmQgdGhlIFEtcHJvZmlsZSBtZXRob2QgYW5kIHRoZSBhbHRlcm5hdGl2ZSBhcHByb2FjaCBiYXNlZCBvbiBhCiAgJ2dlbmVyYWxpc2VkIENvY2hyYW4gYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSBzdGF0aXN0aWMnIHRvIGNvbXB1dGUKICBjb3JyZXNwb25kaW5nIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGFyb3VuZCB0aGUgcmVzdWx0aW5nIGVzdGltYXRlcy4gT3VyCiAgcmVjb21tZW5kYXRpb25zIGFyZSBiYXNlZCBvbiBhIHF1YWxpdGF0aXZlIGV2YWx1YXRpb24gb2YgdGhlIGV4aXN0aW5nCiAgbGl0ZXJhdHVyZSBhbmQgZXhwZXJ0IGNvbnNlbnN1cy4gRXZpZGVuY2UtYmFzZWQgcmVjb21tZW5kYXRpb25zIHJlcXVpcmUgYW4KICBleHRlbnNpdmUgc2ltdWxhdGlvbiBzdHVkeSB3aGVyZSBhbGwgbWV0aG9kcyB3b3VsZCBiZSBjb21wYXJlZCB1bmRlciB0aGUgc2FtZQogIHNjZW5hcmlvcy59LAogIHVybCA9IHtodHRwczovL29ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS8xMC4xMDAyL2pyc20uMTE2NH0sCiAgZmlsZSA9IHtWZXJvbmlraSBldCBhbC4gMjAxNiAtIE1ldGhvZHMgdG8gZXN0aW1hdGUgdGhlIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyB1bmNlcnRhaW50eSBpbiBtZXRhLWFuYWx5c2lzLnBkZn0sCiAga2V5d29yZHMgPSB7YmlhczsgY29uZmlkZW5jZSBpbnRlcnZhbDsgY292ZXJhZ2UgcHJvYmFiaWxpdHk7IGhldGVyb2dlbmVpdHk7CiAgbWVhbiBzcXVhcmVkIGVycm9yfSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQE1JU0N7Qm9yZW5zdGVpbjIwMDktbW8sCiAgdGl0bGUgPSB7SW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfX0sCiAgYXV0aG9yID0ge0JvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICBSb3Roc3RlaW4sIEhhbm5haCBSfSwKICBkYXRlID0gezIwMDl9LAogIGRvaSA9IHsxMC4xMDAyLzk3ODA0NzA3NDMzODZ9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyLzk3ODA0NzA3NDMzODZ9Cn0KCkBBUlRJQ0xFe1JpbGV5MjAxMS1ocCwKICB0aXRsZSA9IHtJbnRlcnByZXRhdGlvbiBvZiByYW5kb20gZWZmZWN0cyBtZXRhLWFuYWx5c2VzfSwKICBhdXRob3IgPSB7UmlsZXksIFJpY2hhcmQgRCBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgRGVla3MsIEpvbmF0aGFuIEp9LAogIGpvdXJuYWx0aXRsZSA9IHtCTUp9LAogIHZvbHVtZSA9IHszNDJ9LAogIHBhZ2VzID0ge2Q1NDl9LAogIGRhdGUgPSB7MjAxMS0wMi0xMH0sCiAgZG9pID0gezEwLjExMzYvYm1qLmQ1NDl9LAogIHBtaWQgPSB7MjEzMTA3OTR9LAogIGlzc24gPSB7MDk1OS04MTM4LDE3NTYtMTgzM30sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qLmQ1NDl9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtJbnRIb3V0MjAxNi1zeiwKICB0aXRsZSA9IHtQbGVhIGZvciByb3V0aW5lbHkgcHJlc2VudGluZyBwcmVkaWN0aW9uIGludGVydmFscyBpbiBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7SW50SG91dCwgSm9hbm5hIGFuZCBJb2FubmlkaXMsIEpvaG4gUCBBIGFuZCBSb3ZlcnMsIE1hcm9lc2thIE0gYW5kCiAgR29lbWFuLCBKZWxsZSBKfSwKICBqb3VybmFsdGl0bGUgPSB7Qk1KIG9wZW59LAogIHZvbHVtZSA9IHs2fSwKICBpc3N1ZSA9IHs3fSwKICBwYWdlcyA9IHtlMDEwMjQ3fSwKICBkYXRlID0gezIwMTYtMDctMTJ9LAogIGRvaSA9IHsxMC4xMTM2L2Jtam9wZW4tMjAxNS0wMTAyNDd9LAogIHBtYyA9IHtQTUM0OTQ3NzUxfSwKICBwbWlkID0gezI3NDA2NjM3fSwKICBpc3NuID0gezIwNDQtNjA1NX0sCiAgYWJzdHJhY3QgPSB7T0JKRUNUSVZFUzogRXZhbHVhdGluZyB0aGUgdmFyaWF0aW9uIGluIHRoZSBzdHJlbmd0aCBvZiB0aGUgZWZmZWN0CiAgYWNyb3NzIHN0dWRpZXMgaXMgYSBrZXkgZmVhdHVyZSBvZiBtZXRhLWFuYWx5c2VzLiBUaGlzIHZhcmlhYmlsaXR5IGlzCiAgcmVmbGVjdGVkIGJ5IG1lYXN1cmVzIGxpa2Ugz4QoMikgb3IgSSgyKSwgYnV0IHRoZWlyIGNsaW5pY2FsIGludGVycHJldGF0aW9uIGlzCiAgbm90IHN0cmFpZ2h0Zm9yd2FyZC4gQSBwcmVkaWN0aW9uIGludGVydmFsIGlzIGxlc3MgY29tcGxpY2F0ZWQ6IGl0IHByZXNlbnRzCiAgdGhlIGV4cGVjdGVkIHJhbmdlIG9mIHRydWUgZWZmZWN0cyBpbiBzaW1pbGFyIHN0dWRpZXMuIFdlIGFpbWVkIHRvIHNob3cgdGhlCiAgYWR2YW50YWdlcyBvZiBoYXZpbmcgdGhlIHByZWRpY3Rpb24gaW50ZXJ2YWwgcm91dGluZWx5IHJlcG9ydGVkIGluCiAgbWV0YS1hbmFseXNlcy4gREVTSUdOOiBXZSBzaG93IGhvdyB0aGUgcHJlZGljdGlvbiBpbnRlcnZhbCBjYW4gaGVscCB1bmRlcnN0YW5kCiAgdGhlIHVuY2VydGFpbnR5IGFib3V0IHdoZXRoZXIgYW4gaW50ZXJ2ZW50aW9uIHdvcmtzIG9yIG5vdC4gVG8gZXZhbHVhdGUgdGhlCiAgaW1wbGljYXRpb25zIG9mIHVzaW5nIHRoaXMgaW50ZXJ2YWwgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHRzLCB3ZSBzZWxlY3RlZCB0aGUKICBmaXJzdCBtZXRhLWFuYWx5c2lzIHBlciBpbnRlcnZlbnRpb24gcmV2aWV3IG9mIHRoZSBDb2NocmFuZSBEYXRhYmFzZSBvZgogIFN5c3RlbWF0aWMgUmV2aWV3cyBJc3N1ZXMgMjAwOS0yMDEzIHdpdGggYSBkaWNob3RvbW91cyAobj0yMDA5KSBvciBjb250aW51b3VzCiAgKG49MTI1NCkgb3V0Y29tZSwgYW5kIGdlbmVyYXRlZCA5NVwlIHByZWRpY3Rpb24gaW50ZXJ2YWxzIGZvciB0aGVtLiBSRVNVTFRTOgogIEluIDcyLjRcJSBvZiA0Nzkgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCAocmFuZG9tLWVmZmVjdHMgcDApLCB0aGUgOTVcJQogIHByZWRpY3Rpb24gaW50ZXJ2YWwgc3VnZ2VzdGVkIHRoYXQgdGhlIGludGVydmVudGlvbiBlZmZlY3QgY291bGQgYmUgbnVsbCBvcgogIGV2ZW4gYmUgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbi4gSW4gMjAuM1wlIG9mIHRob3NlIDQ3OSBtZXRhLWFuYWx5c2VzLCB0aGUKICBwcmVkaWN0aW9uIGludGVydmFsIHNob3dlZCB0aGF0IHRoZSBlZmZlY3QgY291bGQgYmUgY29tcGxldGVseSBvcHBvc2l0ZSB0byB0aGUKICBwb2ludCBlc3RpbWF0ZSBvZiB0aGUgbWV0YS1hbmFseXNpcy4gV2UgZGVtb25zdHJhdGUgYWxzbyBob3cgdGhlIHByZWRpY3Rpb24KICBpbnRlcnZhbCBjYW4gYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHByb2JhYmlsaXR5IHRoYXQgYSBuZXcgdHJpYWwgd2lsbCBzaG93IGEKICBuZWdhdGl2ZSBlZmZlY3QgYW5kIHRvIGltcHJvdmUgdGhlIGNhbGN1bGF0aW9ucyBvZiB0aGUgcG93ZXIgb2YgYSBuZXcgdHJpYWwuCiAgQ09OQ0xVU0lPTlM6IFRoZSBwcmVkaWN0aW9uIGludGVydmFsIHJlZmxlY3RzIHRoZSB2YXJpYXRpb24gaW4gdHJlYXRtZW50CiAgZWZmZWN0cyBvdmVyIGRpZmZlcmVudCBzZXR0aW5ncywgaW5jbHVkaW5nIHdoYXQgZWZmZWN0IGlzIHRvIGJlIGV4cGVjdGVkIGluCiAgZnV0dXJlIHBhdGllbnRzLCBzdWNoIGFzIHRoZSBwYXRpZW50cyB0aGF0IGEgY2xpbmljaWFuIGlzIGludGVyZXN0ZWQgdG8gdHJlYXQuCiAgUHJlZGljdGlvbiBpbnRlcnZhbHMgc2hvdWxkIGJlIHJvdXRpbmVseSByZXBvcnRlZCB0byBhbGxvdyBtb3JlIGluZm9ybWF0aXZlCiAgaW5mZXJlbmNlcyBpbiBtZXRhLWFuYWx5c2VzLn0sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qb3Blbi0yMDE1LTAxMDI0N30sCiAga2V5d29yZHMgPSB7Q2xpbmljYWwgdHJpYWw7IENvY2hyYW5lIERhdGFiYXNlIG9mIFN5c3RlbWF0aWMgUmV2aWV3czsKICBIZXRlcm9nZW5laXR5OyBNZXRhLWFuYWx5c2lzOyBQcmVkaWN0aW9uIGludGVydmFsOyBSYW5kb20gZWZmZWN0cztCYXllc2lhbgogIFN0YXRpc3RpY3N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtIaWdnaW5zMjAwMi1maCwKICB0aXRsZSA9IHtRdWFudGlmeWluZyBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpc30sCiAgYXV0aG9yID0ge0hpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHfSwKICBqb3VybmFsdGl0bGUgPSB7U3RhdGlzdGljcyBpbiBtZWRpY2luZX0sCiAgdm9sdW1lID0gezIxfSwKICBpc3N1ZSA9IHsxMX0sCiAgcGFnZXMgPSB7MTUzOS0xNTU4fSwKICBkYXRlID0gezIwMDItMDYtMTV9LAogIGRvaSA9IHsxMC4xMDAyL3NpbS4xMTg2fSwKICBwbWlkID0gezEyMTExOTE5fSwKICBpc3NuID0gezAyNzctNjcxNX0sCiAgYWJzdHJhY3QgPSB7VGhlIGV4dGVudCBvZiBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpcyBwYXJ0bHkgZGV0ZXJtaW5lcwogIHRoZSBkaWZmaWN1bHR5IGluIGRyYXdpbmcgb3ZlcmFsbCBjb25jbHVzaW9ucy4gVGhpcyBleHRlbnQgbWF5IGJlIG1lYXN1cmVkIGJ5CiAgZXN0aW1hdGluZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UsIGJ1dCBpbnRlcnByZXRhdGlvbiBpcyB0aGVuIHNwZWNpZmljIHRvIGEKICBwYXJ0aWN1bGFyIHRyZWF0bWVudCBlZmZlY3QgbWV0cmljLiBBIHRlc3QgZm9yIHRoZSBleGlzdGVuY2Ugb2YgaGV0ZXJvZ2VuZWl0eQogIGV4aXN0cywgYnV0IGRlcGVuZHMgb24gdGhlIG51bWJlciBvZiBzdHVkaWVzIGluIHRoZSBtZXRhLWFuYWx5c2lzLiBXZSBkZXZlbG9wCiAgbWVhc3VyZXMgb2YgdGhlIGltcGFjdCBvZiBoZXRlcm9nZW5laXR5IG9uIGEgbWV0YS1hbmFseXNpcywgZnJvbSBtYXRoZW1hdGljYWwKICBjcml0ZXJpYSwgdGhhdCBhcmUgaW5kZXBlbmRlbnQgb2YgdGhlIG51bWJlciBvZiBzdHVkaWVzIGFuZCB0aGUgdHJlYXRtZW50CiAgZWZmZWN0IG1ldHJpYy4gV2UgZGVyaXZlIGFuZCBwcm9wb3NlIHRocmVlIHN1aXRhYmxlIHN0YXRpc3RpY3M6IEggaXMgdGhlCiAgc3F1YXJlIHJvb3Qgb2YgdGhlIGNoaTIgaGV0ZXJvZ2VuZWl0eSBzdGF0aXN0aWMgZGl2aWRlZCBieSBpdHMgZGVncmVlcyBvZgogIGZyZWVkb207IFIgaXMgdGhlIHJhdGlvIG9mIHRoZSBzdGFuZGFyZCBlcnJvciBvZiB0aGUgdW5kZXJseWluZyBtZWFuIGZyb20gYQogIHJhbmRvbSBlZmZlY3RzIG1ldGEtYW5hbHlzaXMgdG8gdGhlIHN0YW5kYXJkIGVycm9yIG9mIGEgZml4ZWQgZWZmZWN0CiAgbWV0YS1hbmFseXRpYyBlc3RpbWF0ZSwgYW5kIEkyIGlzIGEgdHJhbnNmb3JtYXRpb24gb2YgKEgpIHRoYXQgZGVzY3JpYmVzIHRoZQogIHByb3BvcnRpb24gb2YgdG90YWwgdmFyaWF0aW9uIGluIHN0dWR5IGVzdGltYXRlcyB0aGF0IGlzIGR1ZSB0byBoZXRlcm9nZW5laXR5LgogIFdlIGRpc2N1c3MgaW50ZXJwcmV0YXRpb24sIGludGVydmFsIGVzdGltYXRlcyBhbmQgb3RoZXIgcHJvcGVydGllcyBvZiB0aGVzZQogIG1lYXN1cmVzIGFuZCBleGFtaW5lIHRoZW0gaW4gZml2ZSBleGFtcGxlIGRhdGEgc2V0cyBzaG93aW5nIGRpZmZlcmVudCBhbW91bnRzCiAgb2YgaGV0ZXJvZ2VuZWl0eS4gV2UgY29uY2x1ZGUgdGhhdCBIIGFuZCBJMiwgd2hpY2ggY2FuIHVzdWFsbHkgYmUgY2FsY3VsYXRlZAogIGZvciBwdWJsaXNoZWQgbWV0YS1hbmFseXNlcywgYXJlIHBhcnRpY3VsYXJseSB1c2VmdWwgc3VtbWFyaWVzIG9mIHRoZSBpbXBhY3QKICBvZiBoZXRlcm9nZW5laXR5LiBPbmUgb3IgYm90aCBzaG91bGQgYmUgcHJlc2VudGVkIGluIHB1Ymxpc2hlZCBtZXRhLWFuYWx5c2VzCiAgaW4gcHJlZmVyZW5jZSB0byB0aGUgdGVzdCBmb3IgaGV0ZXJvZ2VuZWl0eS59LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyL3NpbS4xMTg2fSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQEFSVElDTEV7SGVkZ2VzMTk4OS1pcCwKICB0aXRsZSA9IHtBbiB1bmJpYXNlZCBjb3JyZWN0aW9uIGZvciBzYW1wbGluZyBlcnJvciBpbiB2YWxpZGl0eSBnZW5lcmFsaXphdGlvbgogIHN0dWRpZXN9LAogIGF1dGhvciA9IHtIZWRnZXMsIExhcnJ5IFZ9LAogIGpvdXJuYWx0aXRsZSA9IHtUaGUgSm91cm5hbCBvZiBhcHBsaWVkIHBzeWNob2xvZ3l9LAogIHB1Ymxpc2hlciA9IHtBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpfSwKICB2b2x1bWUgPSB7NzR9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezQ2OS00Nzd9LAogIGRhdGUgPSB7MTk4OS0wNn0sCiAgZG9pID0gezEwLjEwMzcvMDAyMS05MDEwLjc0LjMuNDY5fSwKICBpc3NuID0gezAwMjEtOTAxMCwxOTM5LTE4NTR9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDM3LzAwMjEtOTAxMC43NC4zLjQ2OX0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe0hlZGdlczIwMTktcnksCiAgdGl0bGUgPSB7U3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uOiBNZXRhLWFuYWx5dGljCiAgcGVyc3BlY3RpdmVzfSwKICBhdXRob3IgPSB7SGVkZ2VzLCBMYXJyeSBWIGFuZCBTY2hhdWVyLCBKYWNvYiBNfSwKICBqb3VybmFsdGl0bGUgPSB7UHN5Y2hvbG9naWNhbCBtZXRob2RzfSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gUHN5Y2hvbG9naWNhbCBBc3NvY2lhdGlvbiAoQVBBKX0sCiAgdm9sdW1lID0gezI0fSwKICBpc3N1ZSA9IHs1fSwKICBwYWdlcyA9IHs1NTctNTcwfSwKICBkYXRlID0gezIwMTktMTB9LAogIGRvaSA9IHsxMC4xMDM3L21ldDAwMDAxODl9LAogIHBtaWQgPSB7MzAwNzA1NDd9LAogIGlzc24gPSB7MTA4Mi05ODlYLDE5MzktMTQ2M30sCiAgYWJzdHJhY3QgPSB7Rm9ybWFsIGVtcGlyaWNhbCBhc3Nlc3NtZW50cyBvZiByZXBsaWNhdGlvbiBoYXZlIHJlY2VudGx5IGJlY29tZQogIG1vcmUgcHJvbWluZW50IGluIHNldmVyYWwgYXJlYXMgb2Ygc2NpZW5jZSwgaW5jbHVkaW5nIHBzeWNob2xvZ3kuIFRoZXNlCiAgYXNzZXNzbWVudHMgaGF2ZSB1c2VkIGRpZmZlcmVudCBzdGF0aXN0aWNhbCBhcHByb2FjaGVzIHRvIGRldGVybWluZSBpZiBhCiAgZmluZGluZyBoYXMgYmVlbiByZXBsaWNhdGVkLiBUaGUgcHVycG9zZSBvZiB0aGlzIGFydGljbGUgaXMgdG8gcHJvdmlkZSBzZXZlcmFsCiAgYWx0ZXJuYXRpdmUgY29uY2VwdHVhbCBmcmFtZXdvcmtzIHRoYXQgbGVhZCB0byBkaWZmZXJlbnQgc3RhdGlzdGljYWwgYW5hbHlzZXMKICB0byB0ZXN0IGh5cG90aGVzZXMgYWJvdXQgcmVwbGljYXRpb24uIEFsbCBvZiB0aGVzZSBhbmFseXNlcyBhcmUgYmFzZWQgb24KICBzdGF0aXN0aWNhbCBtZXRob2RzIHVzZWQgaW4gbWV0YS1hbmFseXNpcy4gVGhlIGRpZmZlcmVuY2VzIGFtb25nIHRoZSBtZXRob2RzCiAgZGVzY3JpYmVkIGludm9sdmUgd2hldGhlciB0aGUgYnVyZGVuIG9mIHByb29mIGlzIHBsYWNlZCBvbiByZXBsaWNhdGlvbiBvcgogIG5vbnJlcGxpY2F0aW9uLCB3aGV0aGVyIHJlcGxpY2F0aW9uIGlzIGV4YWN0IG9yIGFsbG93cyBmb3IgYSBzbWFsbCBhbW91bnQgb2YKICAibmVnbGlnaWJsZSBoZXRlcm9nZW5laXR5LCIgYW5kIHdoZXRoZXIgdGhlIHN0dWRpZXMgb2JzZXJ2ZWQgYXJlIGFzc3VtZWQgdG8gYmUKICBmaXhlZCAoY29uc3RpdHV0aW5nIHRoZSBlbnRpcmUgYm9keSBvZiByZWxldmFudCBldmlkZW5jZSkgb3IgYXJlIGEgc2FtcGxlIGZyb20KICBhIHVuaXZlcnNlIG9mIHBvc3NpYmx5IHJlbGV2YW50IHN0dWRpZXMuIFRoZSBzdGF0aXN0aWNhbCBwb3dlciBvZiBlYWNoIG9mCiAgdGhlc2UgdGVzdHMgaXMgY29tcHV0ZWQgYW5kIHNob3duIHRvIGJlIGxvdyBpbiBtYW55IGNhc2VzLCByYWlzaW5nIGlzc3VlcyBvZgogIHRoZSBpbnRlcnByZXRhYmlsaXR5IG9mIHRlc3RzIGZvciByZXBsaWNhdGlvbi4gKFBzeWNJTkZPIERhdGFiYXNlIFJlY29yZCAoYykKICAyMDE5IEFQQSwgYWxsIHJpZ2h0cyByZXNlcnZlZCkufSwKICB1cmwgPSB7aHR0cDovL2R4LmRvaS5vcmcvMTAuMTAzNy9tZXQwMDAwMTg5fSwKICBmaWxlID0ge0hlZGdlcyBhbmQgU2NoYXVlciAyMDE5IC0gU3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uIC0gTWV0YS1hbmFseXRpYyBwZXJzcGVjdGl2ZXMucGRmfSwKICBrZXl3b3JkcyA9IHtyZXBsaWNhYmlsaXR5LWJvb2s7bWV0aG9kc30sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCg==" download="refs_to_download.bib" class="nav-link" data-scroll-target="data\:text/x-bibtex;base64,QEFSVElDTEV7VmllY2h0YmF1ZXIyMDA1LXp0LAogIHRpdGxlID0ge0JpYXMgYW5kIGVmZmljaWVuY3kgb2YgbWV0YS1hbmFseXRpYyB2YXJpYW5jZSBlc3RpbWF0b3JzIGluIHRoZQogIHJhbmRvbS1lZmZlY3RzIG1vZGVsfSwKICBhdXRob3IgPSB7VmllY2h0YmF1ZXIsIFdvbGZnYW5nfSwKICBqb3VybmFsdGl0bGUgPSB7Sm91cm5hbCBvZiBlZHVjYXRpb25hbCBhbmQgYmVoYXZpb3JhbCBzdGF0aXN0aWNzOiBhIHF1YXJ0ZXJseQogIHB1YmxpY2F0aW9uIHNwb25zb3JlZCBieSB0aGUgQW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gYW5kIHRoZQogIEFtZXJpY2FuIFN0YXRpc3RpY2FsIEFzc29jaWF0aW9ufSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gKEFFUkEpfSwKICB2b2x1bWUgPSB7MzB9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezI2MS0yOTN9LAogIGRhdGUgPSB7MjAwNS0wOX0sCiAgZG9pID0gezEwLjMxMDIvMTA3Njk5ODYwMzAwMDMyNjF9LAogIGlzc24gPSB7MTA3Ni05OTg2LDE5MzUtMTA1NH0sCiAgYWJzdHJhY3QgPSB7VGhlIG1ldGEtYW5hbHl0aWMgcmFuZG9tIGVmZmVjdHMgbW9kZWwgYXNzdW1lcyB0aGF0IHRoZQogIHZhcmlhYmlsaXR5IGluIGVmZmVjdCBzaXplIGVzdGltYXRlcyBkcmF3biBmcm9tIGEgc2V0IG9mIHN0dWRpZXMgY2FuIGJlCiAgZGVjb21wb3NlZCBpbnRvIHR3byBwYXJ0czogaGV0ZXJvZ2VuZWl0eSBkdWUgdG8gcmFuZG9tIHBvcHVsYXRpb24gZWZmZWN0cyBhbmQKICBzYW1wbGluZyB2YXJpYW5jZS4gSW4gdGhpcyBjb250ZXh0LCB0aGUgdXN1YWwgZ29hbCBpcyB0byBlc3RpbWF0ZSB0aGUgY2VudHJhbAogIHRlbmRlbmN5IGFuZCB0aGUgYW1vdW50IG9mIGhldGVyb2dlbmVpdHkgaW4gdGhlIHBvcHVsYXRpb24gZWZmZWN0IHNpemVzLiBUaGUKICBhbW91bnQgb2YgaGV0ZXJvZ2VuZWl0eSBpbiBhIHNldCBvZiBlZmZlY3Qgc2l6ZXMgaGFzIGltcGxpY2F0aW9ucyByZWdhcmRpbmcKICB0aGUgaW50ZXJwcmV0YXRpb24gb2YgdGhlIG1ldGEtYW5hbHl0aWMgZmluZGluZ3MgYW5kIG9mdGVuIHNlcnZlcyBhcyBhbgogIGluZGljYXRvciBmb3IgdGhlIHByZXNlbmNlIG9mIHBvdGVudGlhbCBtb2RlcmF0b3IgdmFyaWFibGVzLiBGaXZlIHBvcHVsYXRpb24KICBoZXRlcm9nZW5laXR5IGVzdGltYXRvcnMgd2VyZSBjb21wYXJlZCBpbiB0aGlzIGFydGljbGUgYW5hbHl0aWNhbGx5IGFuZCB2aWEKICBNb250ZSBDYXJsbyBzaW11bGF0aW9ucyB3aXRoIHJlc3BlY3QgdG8gdGhlaXIgYmlhcyBhbmQgZWZmaWNpZW5jeS59LAogIHVybCA9IHtodHRwczovL3NjaG9sYXIuZ29vZ2xlLmNvbS9jaXRhdGlvbnM/dmlld19vcD12aWV3X2NpdGF0aW9uJmhsPWVuJnVzZXI9Sjg5UlhKa0FBQUFKJmNpdGF0aW9uX2Zvcl92aWV3PUo4OVJYSmtBQUFBSjpxak1ha0ZIRHk3c0N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQk9PS3tIYXJyZXIyMDIxLWdvLAogIHRpdGxlID0ge0RvaW5nIG1ldGEtYW5hbHlzaXMgd2l0aCBSOiBBIGhhbmRzLW9uIGd1aWRlfSwKICBhdXRob3IgPSB7SGFycmVyLCBNYXRoaWFzIGFuZCBDdWlqcGVycywgUGltIGFuZCBGdXJ1a2F3YSwgVG9zaGkgYW5kIEViZXJ0LAogIERhdmlkfSwKICBwdWJsaXNoZXIgPSB7Q1JDIFByZXNzfSwKICBsb2NhdGlvbiA9IHtMb25kb24sIEVuZ2xhbmR9LAogIGVkaXRpb24gPSB7MXN0fSwKICBkYXRlID0gezIwMjEtMDktMTN9LAogIHBhZ2V0b3RhbCA9IHs0NzR9LAogIGlzYm4gPSB7OTc4MDM2NzYxMDA3NH0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe1Zlcm9uaWtpMjAxNi1udywKICB0aXRsZSA9IHtNZXRob2RzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlIGFuZCBpdHMgdW5jZXJ0YWludHkgaW4KICBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7VmVyb25pa2ksIEFyZXRpIEFuZ2VsaWtpIGFuZCBKYWNrc29uLCBEYW4gYW5kIFZpZWNodGJhdWVyLCBXb2xmZ2FuZwogIGFuZCBCZW5kZXIsIFJhbGYgYW5kIEJvd2RlbiwgSmFjayBhbmQgS25hcHAsIEd1aWRvIGFuZCBLdXNzLCBPbGl2ZXIgYW5kCiAgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgTGFuZ2FuLCBEZWFuIGFuZCBTYWxhbnRpLCBHZW9yZ2lhfSwKICBqb3VybmFsdGl0bGUgPSB7UmVzZWFyY2ggc3ludGhlc2lzIG1ldGhvZHN9LAogIHB1Ymxpc2hlciA9IHtXaWxleX0sCiAgdm9sdW1lID0gezd9LAogIGlzc3VlID0gezF9LAogIHBhZ2VzID0gezU1LTc5fSwKICBkYXRlID0gezIwMTYtMDN9LAogIGRvaSA9IHsxMC4xMDAyL2pyc20uMTE2NH0sCiAgcG1jID0ge1BNQzQ5NTAwMzB9LAogIHBtaWQgPSB7MjYzMzIxNDR9LAogIGlzc24gPSB7MTc1OS0yODc5LDE3NTktMjg4N30sCiAgYWJzdHJhY3QgPSB7TWV0YS1hbmFseXNlcyBhcmUgdHlwaWNhbGx5IHVzZWQgdG8gZXN0aW1hdGUgdGhlIG92ZXJhbGwvbWVhbiBvZgogIGFuIG91dGNvbWUgb2YgaW50ZXJlc3QuIEhvd2V2ZXIsIGluZmVyZW5jZSBhYm91dCBiZXR3ZWVuLXN0dWR5IHZhcmlhYmlsaXR5LAogIHdoaWNoIGlzIHR5cGljYWxseSBtb2RlbGxlZCB1c2luZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgcGFyYW1ldGVyLCBpcwogIHVzdWFsbHkgYW4gYWRkaXRpb25hbCBhaW0uIFRoZSBEZXJTaW1vbmlhbiBhbmQgTGFpcmQgbWV0aG9kLCBjdXJyZW50bHkgd2lkZWx5CiAgdXNlZCBieSBkZWZhdWx0IHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLCBoYXMgYmVlbiBsb25nCiAgY2hhbGxlbmdlZC4gT3VyIGFpbSBpcyB0byBpZGVudGlmeSBrbm93biBtZXRob2RzIGZvciBlc3RpbWF0aW9uIG9mIHRoZQogIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyBjb3JyZXNwb25kaW5nIHVuY2VydGFpbnR5LCBhbmQgdG8gc3VtbWFyaXNlIHRoZQogIHNpbXVsYXRpb24gYW5kIGVtcGlyaWNhbCBldmlkZW5jZSB0aGF0IGNvbXBhcmVzIHRoZW0uIFdlIGlkZW50aWZpZWQgMTYKICBlc3RpbWF0b3JzIGZvciB0aGUgYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSwgc2V2ZW4gbWV0aG9kcyB0byBjYWxjdWxhdGUKICBjb25maWRlbmNlIGludGVydmFscywgYW5kIHNldmVyYWwgY29tcGFyYXRpdmUgc3R1ZGllcy4gU2ltdWxhdGlvbiBzdHVkaWVzCiAgc3VnZ2VzdCB0aGF0IGZvciBib3RoIGRpY2hvdG9tb3VzIGFuZCBjb250aW51b3VzIGRhdGEgdGhlIGVzdGltYXRvciBwcm9wb3NlZAogIGJ5IFBhdWxlIGFuZCBNYW5kZWwgYW5kIGZvciBjb250aW51b3VzIGRhdGEgdGhlIHJlc3RyaWN0ZWQgbWF4aW11bSBsaWtlbGlob29kCiAgZXN0aW1hdG9yIGFyZSBiZXR0ZXIgYWx0ZXJuYXRpdmVzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLgogIEJhc2VkIG9uIHRoZSBzY2VuYXJpb3MgYW5kIHJlc3VsdHMgcHJlc2VudGVkIGluIHRoZSBwdWJsaXNoZWQgc3R1ZGllcywgd2UKICByZWNvbW1lbmQgdGhlIFEtcHJvZmlsZSBtZXRob2QgYW5kIHRoZSBhbHRlcm5hdGl2ZSBhcHByb2FjaCBiYXNlZCBvbiBhCiAgJ2dlbmVyYWxpc2VkIENvY2hyYW4gYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSBzdGF0aXN0aWMnIHRvIGNvbXB1dGUKICBjb3JyZXNwb25kaW5nIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGFyb3VuZCB0aGUgcmVzdWx0aW5nIGVzdGltYXRlcy4gT3VyCiAgcmVjb21tZW5kYXRpb25zIGFyZSBiYXNlZCBvbiBhIHF1YWxpdGF0aXZlIGV2YWx1YXRpb24gb2YgdGhlIGV4aXN0aW5nCiAgbGl0ZXJhdHVyZSBhbmQgZXhwZXJ0IGNvbnNlbnN1cy4gRXZpZGVuY2UtYmFzZWQgcmVjb21tZW5kYXRpb25zIHJlcXVpcmUgYW4KICBleHRlbnNpdmUgc2ltdWxhdGlvbiBzdHVkeSB3aGVyZSBhbGwgbWV0aG9kcyB3b3VsZCBiZSBjb21wYXJlZCB1bmRlciB0aGUgc2FtZQogIHNjZW5hcmlvcy59LAogIHVybCA9IHtodHRwczovL29ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS8xMC4xMDAyL2pyc20uMTE2NH0sCiAgZmlsZSA9IHtWZXJvbmlraSBldCBhbC4gMjAxNiAtIE1ldGhvZHMgdG8gZXN0aW1hdGUgdGhlIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyB1bmNlcnRhaW50eSBpbiBtZXRhLWFuYWx5c2lzLnBkZn0sCiAga2V5d29yZHMgPSB7YmlhczsgY29uZmlkZW5jZSBpbnRlcnZhbDsgY292ZXJhZ2UgcHJvYmFiaWxpdHk7IGhldGVyb2dlbmVpdHk7CiAgbWVhbiBzcXVhcmVkIGVycm9yfSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQE1JU0N7Qm9yZW5zdGVpbjIwMDktbW8sCiAgdGl0bGUgPSB7SW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfX0sCiAgYXV0aG9yID0ge0JvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICBSb3Roc3RlaW4sIEhhbm5haCBSfSwKICBkYXRlID0gezIwMDl9LAogIGRvaSA9IHsxMC4xMDAyLzk3ODA0NzA3NDMzODZ9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyLzk3ODA0NzA3NDMzODZ9Cn0KCkBBUlRJQ0xFe1JpbGV5MjAxMS1ocCwKICB0aXRsZSA9IHtJbnRlcnByZXRhdGlvbiBvZiByYW5kb20gZWZmZWN0cyBtZXRhLWFuYWx5c2VzfSwKICBhdXRob3IgPSB7UmlsZXksIFJpY2hhcmQgRCBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgRGVla3MsIEpvbmF0aGFuIEp9LAogIGpvdXJuYWx0aXRsZSA9IHtCTUp9LAogIHZvbHVtZSA9IHszNDJ9LAogIHBhZ2VzID0ge2Q1NDl9LAogIGRhdGUgPSB7MjAxMS0wMi0xMH0sCiAgZG9pID0gezEwLjExMzYvYm1qLmQ1NDl9LAogIHBtaWQgPSB7MjEzMTA3OTR9LAogIGlzc24gPSB7MDk1OS04MTM4LDE3NTYtMTgzM30sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qLmQ1NDl9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtJbnRIb3V0MjAxNi1zeiwKICB0aXRsZSA9IHtQbGVhIGZvciByb3V0aW5lbHkgcHJlc2VudGluZyBwcmVkaWN0aW9uIGludGVydmFscyBpbiBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7SW50SG91dCwgSm9hbm5hIGFuZCBJb2FubmlkaXMsIEpvaG4gUCBBIGFuZCBSb3ZlcnMsIE1hcm9lc2thIE0gYW5kCiAgR29lbWFuLCBKZWxsZSBKfSwKICBqb3VybmFsdGl0bGUgPSB7Qk1KIG9wZW59LAogIHZvbHVtZSA9IHs2fSwKICBpc3N1ZSA9IHs3fSwKICBwYWdlcyA9IHtlMDEwMjQ3fSwKICBkYXRlID0gezIwMTYtMDctMTJ9LAogIGRvaSA9IHsxMC4xMTM2L2Jtam9wZW4tMjAxNS0wMTAyNDd9LAogIHBtYyA9IHtQTUM0OTQ3NzUxfSwKICBwbWlkID0gezI3NDA2NjM3fSwKICBpc3NuID0gezIwNDQtNjA1NX0sCiAgYWJzdHJhY3QgPSB7T0JKRUNUSVZFUzogRXZhbHVhdGluZyB0aGUgdmFyaWF0aW9uIGluIHRoZSBzdHJlbmd0aCBvZiB0aGUgZWZmZWN0CiAgYWNyb3NzIHN0dWRpZXMgaXMgYSBrZXkgZmVhdHVyZSBvZiBtZXRhLWFuYWx5c2VzLiBUaGlzIHZhcmlhYmlsaXR5IGlzCiAgcmVmbGVjdGVkIGJ5IG1lYXN1cmVzIGxpa2Ugz4QoMikgb3IgSSgyKSwgYnV0IHRoZWlyIGNsaW5pY2FsIGludGVycHJldGF0aW9uIGlzCiAgbm90IHN0cmFpZ2h0Zm9yd2FyZC4gQSBwcmVkaWN0aW9uIGludGVydmFsIGlzIGxlc3MgY29tcGxpY2F0ZWQ6IGl0IHByZXNlbnRzCiAgdGhlIGV4cGVjdGVkIHJhbmdlIG9mIHRydWUgZWZmZWN0cyBpbiBzaW1pbGFyIHN0dWRpZXMuIFdlIGFpbWVkIHRvIHNob3cgdGhlCiAgYWR2YW50YWdlcyBvZiBoYXZpbmcgdGhlIHByZWRpY3Rpb24gaW50ZXJ2YWwgcm91dGluZWx5IHJlcG9ydGVkIGluCiAgbWV0YS1hbmFseXNlcy4gREVTSUdOOiBXZSBzaG93IGhvdyB0aGUgcHJlZGljdGlvbiBpbnRlcnZhbCBjYW4gaGVscCB1bmRlcnN0YW5kCiAgdGhlIHVuY2VydGFpbnR5IGFib3V0IHdoZXRoZXIgYW4gaW50ZXJ2ZW50aW9uIHdvcmtzIG9yIG5vdC4gVG8gZXZhbHVhdGUgdGhlCiAgaW1wbGljYXRpb25zIG9mIHVzaW5nIHRoaXMgaW50ZXJ2YWwgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHRzLCB3ZSBzZWxlY3RlZCB0aGUKICBmaXJzdCBtZXRhLWFuYWx5c2lzIHBlciBpbnRlcnZlbnRpb24gcmV2aWV3IG9mIHRoZSBDb2NocmFuZSBEYXRhYmFzZSBvZgogIFN5c3RlbWF0aWMgUmV2aWV3cyBJc3N1ZXMgMjAwOS0yMDEzIHdpdGggYSBkaWNob3RvbW91cyAobj0yMDA5KSBvciBjb250aW51b3VzCiAgKG49MTI1NCkgb3V0Y29tZSwgYW5kIGdlbmVyYXRlZCA5NVwlIHByZWRpY3Rpb24gaW50ZXJ2YWxzIGZvciB0aGVtLiBSRVNVTFRTOgogIEluIDcyLjRcJSBvZiA0Nzkgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCAocmFuZG9tLWVmZmVjdHMgcDApLCB0aGUgOTVcJQogIHByZWRpY3Rpb24gaW50ZXJ2YWwgc3VnZ2VzdGVkIHRoYXQgdGhlIGludGVydmVudGlvbiBlZmZlY3QgY291bGQgYmUgbnVsbCBvcgogIGV2ZW4gYmUgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbi4gSW4gMjAuM1wlIG9mIHRob3NlIDQ3OSBtZXRhLWFuYWx5c2VzLCB0aGUKICBwcmVkaWN0aW9uIGludGVydmFsIHNob3dlZCB0aGF0IHRoZSBlZmZlY3QgY291bGQgYmUgY29tcGxldGVseSBvcHBvc2l0ZSB0byB0aGUKICBwb2ludCBlc3RpbWF0ZSBvZiB0aGUgbWV0YS1hbmFseXNpcy4gV2UgZGVtb25zdHJhdGUgYWxzbyBob3cgdGhlIHByZWRpY3Rpb24KICBpbnRlcnZhbCBjYW4gYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHByb2JhYmlsaXR5IHRoYXQgYSBuZXcgdHJpYWwgd2lsbCBzaG93IGEKICBuZWdhdGl2ZSBlZmZlY3QgYW5kIHRvIGltcHJvdmUgdGhlIGNhbGN1bGF0aW9ucyBvZiB0aGUgcG93ZXIgb2YgYSBuZXcgdHJpYWwuCiAgQ09OQ0xVU0lPTlM6IFRoZSBwcmVkaWN0aW9uIGludGVydmFsIHJlZmxlY3RzIHRoZSB2YXJpYXRpb24gaW4gdHJlYXRtZW50CiAgZWZmZWN0cyBvdmVyIGRpZmZlcmVudCBzZXR0aW5ncywgaW5jbHVkaW5nIHdoYXQgZWZmZWN0IGlzIHRvIGJlIGV4cGVjdGVkIGluCiAgZnV0dXJlIHBhdGllbnRzLCBzdWNoIGFzIHRoZSBwYXRpZW50cyB0aGF0IGEgY2xpbmljaWFuIGlzIGludGVyZXN0ZWQgdG8gdHJlYXQuCiAgUHJlZGljdGlvbiBpbnRlcnZhbHMgc2hvdWxkIGJlIHJvdXRpbmVseSByZXBvcnRlZCB0byBhbGxvdyBtb3JlIGluZm9ybWF0aXZlCiAgaW5mZXJlbmNlcyBpbiBtZXRhLWFuYWx5c2VzLn0sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qb3Blbi0yMDE1LTAxMDI0N30sCiAga2V5d29yZHMgPSB7Q2xpbmljYWwgdHJpYWw7IENvY2hyYW5lIERhdGFiYXNlIG9mIFN5c3RlbWF0aWMgUmV2aWV3czsKICBIZXRlcm9nZW5laXR5OyBNZXRhLWFuYWx5c2lzOyBQcmVkaWN0aW9uIGludGVydmFsOyBSYW5kb20gZWZmZWN0cztCYXllc2lhbgogIFN0YXRpc3RpY3N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtIaWdnaW5zMjAwMi1maCwKICB0aXRsZSA9IHtRdWFudGlmeWluZyBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpc30sCiAgYXV0aG9yID0ge0hpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHfSwKICBqb3VybmFsdGl0bGUgPSB7U3RhdGlzdGljcyBpbiBtZWRpY2luZX0sCiAgdm9sdW1lID0gezIxfSwKICBpc3N1ZSA9IHsxMX0sCiAgcGFnZXMgPSB7MTUzOS0xNTU4fSwKICBkYXRlID0gezIwMDItMDYtMTV9LAogIGRvaSA9IHsxMC4xMDAyL3NpbS4xMTg2fSwKICBwbWlkID0gezEyMTExOTE5fSwKICBpc3NuID0gezAyNzctNjcxNX0sCiAgYWJzdHJhY3QgPSB7VGhlIGV4dGVudCBvZiBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpcyBwYXJ0bHkgZGV0ZXJtaW5lcwogIHRoZSBkaWZmaWN1bHR5IGluIGRyYXdpbmcgb3ZlcmFsbCBjb25jbHVzaW9ucy4gVGhpcyBleHRlbnQgbWF5IGJlIG1lYXN1cmVkIGJ5CiAgZXN0aW1hdGluZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UsIGJ1dCBpbnRlcnByZXRhdGlvbiBpcyB0aGVuIHNwZWNpZmljIHRvIGEKICBwYXJ0aWN1bGFyIHRyZWF0bWVudCBlZmZlY3QgbWV0cmljLiBBIHRlc3QgZm9yIHRoZSBleGlzdGVuY2Ugb2YgaGV0ZXJvZ2VuZWl0eQogIGV4aXN0cywgYnV0IGRlcGVuZHMgb24gdGhlIG51bWJlciBvZiBzdHVkaWVzIGluIHRoZSBtZXRhLWFuYWx5c2lzLiBXZSBkZXZlbG9wCiAgbWVhc3VyZXMgb2YgdGhlIGltcGFjdCBvZiBoZXRlcm9nZW5laXR5IG9uIGEgbWV0YS1hbmFseXNpcywgZnJvbSBtYXRoZW1hdGljYWwKICBjcml0ZXJpYSwgdGhhdCBhcmUgaW5kZXBlbmRlbnQgb2YgdGhlIG51bWJlciBvZiBzdHVkaWVzIGFuZCB0aGUgdHJlYXRtZW50CiAgZWZmZWN0IG1ldHJpYy4gV2UgZGVyaXZlIGFuZCBwcm9wb3NlIHRocmVlIHN1aXRhYmxlIHN0YXRpc3RpY3M6IEggaXMgdGhlCiAgc3F1YXJlIHJvb3Qgb2YgdGhlIGNoaTIgaGV0ZXJvZ2VuZWl0eSBzdGF0aXN0aWMgZGl2aWRlZCBieSBpdHMgZGVncmVlcyBvZgogIGZyZWVkb207IFIgaXMgdGhlIHJhdGlvIG9mIHRoZSBzdGFuZGFyZCBlcnJvciBvZiB0aGUgdW5kZXJseWluZyBtZWFuIGZyb20gYQogIHJhbmRvbSBlZmZlY3RzIG1ldGEtYW5hbHlzaXMgdG8gdGhlIHN0YW5kYXJkIGVycm9yIG9mIGEgZml4ZWQgZWZmZWN0CiAgbWV0YS1hbmFseXRpYyBlc3RpbWF0ZSwgYW5kIEkyIGlzIGEgdHJhbnNmb3JtYXRpb24gb2YgKEgpIHRoYXQgZGVzY3JpYmVzIHRoZQogIHByb3BvcnRpb24gb2YgdG90YWwgdmFyaWF0aW9uIGluIHN0dWR5IGVzdGltYXRlcyB0aGF0IGlzIGR1ZSB0byBoZXRlcm9nZW5laXR5LgogIFdlIGRpc2N1c3MgaW50ZXJwcmV0YXRpb24sIGludGVydmFsIGVzdGltYXRlcyBhbmQgb3RoZXIgcHJvcGVydGllcyBvZiB0aGVzZQogIG1lYXN1cmVzIGFuZCBleGFtaW5lIHRoZW0gaW4gZml2ZSBleGFtcGxlIGRhdGEgc2V0cyBzaG93aW5nIGRpZmZlcmVudCBhbW91bnRzCiAgb2YgaGV0ZXJvZ2VuZWl0eS4gV2UgY29uY2x1ZGUgdGhhdCBIIGFuZCBJMiwgd2hpY2ggY2FuIHVzdWFsbHkgYmUgY2FsY3VsYXRlZAogIGZvciBwdWJsaXNoZWQgbWV0YS1hbmFseXNlcywgYXJlIHBhcnRpY3VsYXJseSB1c2VmdWwgc3VtbWFyaWVzIG9mIHRoZSBpbXBhY3QKICBvZiBoZXRlcm9nZW5laXR5LiBPbmUgb3IgYm90aCBzaG91bGQgYmUgcHJlc2VudGVkIGluIHB1Ymxpc2hlZCBtZXRhLWFuYWx5c2VzCiAgaW4gcHJlZmVyZW5jZSB0byB0aGUgdGVzdCBmb3IgaGV0ZXJvZ2VuZWl0eS59LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyL3NpbS4xMTg2fSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQEFSVElDTEV7SGVkZ2VzMTk4OS1pcCwKICB0aXRsZSA9IHtBbiB1bmJpYXNlZCBjb3JyZWN0aW9uIGZvciBzYW1wbGluZyBlcnJvciBpbiB2YWxpZGl0eSBnZW5lcmFsaXphdGlvbgogIHN0dWRpZXN9LAogIGF1dGhvciA9IHtIZWRnZXMsIExhcnJ5IFZ9LAogIGpvdXJuYWx0aXRsZSA9IHtUaGUgSm91cm5hbCBvZiBhcHBsaWVkIHBzeWNob2xvZ3l9LAogIHB1Ymxpc2hlciA9IHtBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpfSwKICB2b2x1bWUgPSB7NzR9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezQ2OS00Nzd9LAogIGRhdGUgPSB7MTk4OS0wNn0sCiAgZG9pID0gezEwLjEwMzcvMDAyMS05MDEwLjc0LjMuNDY5fSwKICBpc3NuID0gezAwMjEtOTAxMCwxOTM5LTE4NTR9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDM3LzAwMjEtOTAxMC43NC4zLjQ2OX0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe0hlZGdlczIwMTktcnksCiAgdGl0bGUgPSB7U3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uOiBNZXRhLWFuYWx5dGljCiAgcGVyc3BlY3RpdmVzfSwKICBhdXRob3IgPSB7SGVkZ2VzLCBMYXJyeSBWIGFuZCBTY2hhdWVyLCBKYWNvYiBNfSwKICBqb3VybmFsdGl0bGUgPSB7UHN5Y2hvbG9naWNhbCBtZXRob2RzfSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gUHN5Y2hvbG9naWNhbCBBc3NvY2lhdGlvbiAoQVBBKX0sCiAgdm9sdW1lID0gezI0fSwKICBpc3N1ZSA9IHs1fSwKICBwYWdlcyA9IHs1NTctNTcwfSwKICBkYXRlID0gezIwMTktMTB9LAogIGRvaSA9IHsxMC4xMDM3L21ldDAwMDAxODl9LAogIHBtaWQgPSB7MzAwNzA1NDd9LAogIGlzc24gPSB7MTA4Mi05ODlYLDE5MzktMTQ2M30sCiAgYWJzdHJhY3QgPSB7Rm9ybWFsIGVtcGlyaWNhbCBhc3Nlc3NtZW50cyBvZiByZXBsaWNhdGlvbiBoYXZlIHJlY2VudGx5IGJlY29tZQogIG1vcmUgcHJvbWluZW50IGluIHNldmVyYWwgYXJlYXMgb2Ygc2NpZW5jZSwgaW5jbHVkaW5nIHBzeWNob2xvZ3kuIFRoZXNlCiAgYXNzZXNzbWVudHMgaGF2ZSB1c2VkIGRpZmZlcmVudCBzdGF0aXN0aWNhbCBhcHByb2FjaGVzIHRvIGRldGVybWluZSBpZiBhCiAgZmluZGluZyBoYXMgYmVlbiByZXBsaWNhdGVkLiBUaGUgcHVycG9zZSBvZiB0aGlzIGFydGljbGUgaXMgdG8gcHJvdmlkZSBzZXZlcmFsCiAgYWx0ZXJuYXRpdmUgY29uY2VwdHVhbCBmcmFtZXdvcmtzIHRoYXQgbGVhZCB0byBkaWZmZXJlbnQgc3RhdGlzdGljYWwgYW5hbHlzZXMKICB0byB0ZXN0IGh5cG90aGVzZXMgYWJvdXQgcmVwbGljYXRpb24uIEFsbCBvZiB0aGVzZSBhbmFseXNlcyBhcmUgYmFzZWQgb24KICBzdGF0aXN0aWNhbCBtZXRob2RzIHVzZWQgaW4gbWV0YS1hbmFseXNpcy4gVGhlIGRpZmZlcmVuY2VzIGFtb25nIHRoZSBtZXRob2RzCiAgZGVzY3JpYmVkIGludm9sdmUgd2hldGhlciB0aGUgYnVyZGVuIG9mIHByb29mIGlzIHBsYWNlZCBvbiByZXBsaWNhdGlvbiBvcgogIG5vbnJlcGxpY2F0aW9uLCB3aGV0aGVyIHJlcGxpY2F0aW9uIGlzIGV4YWN0IG9yIGFsbG93cyBmb3IgYSBzbWFsbCBhbW91bnQgb2YKICAibmVnbGlnaWJsZSBoZXRlcm9nZW5laXR5LCIgYW5kIHdoZXRoZXIgdGhlIHN0dWRpZXMgb2JzZXJ2ZWQgYXJlIGFzc3VtZWQgdG8gYmUKICBmaXhlZCAoY29uc3RpdHV0aW5nIHRoZSBlbnRpcmUgYm9keSBvZiByZWxldmFudCBldmlkZW5jZSkgb3IgYXJlIGEgc2FtcGxlIGZyb20KICBhIHVuaXZlcnNlIG9mIHBvc3NpYmx5IHJlbGV2YW50IHN0dWRpZXMuIFRoZSBzdGF0aXN0aWNhbCBwb3dlciBvZiBlYWNoIG9mCiAgdGhlc2UgdGVzdHMgaXMgY29tcHV0ZWQgYW5kIHNob3duIHRvIGJlIGxvdyBpbiBtYW55IGNhc2VzLCByYWlzaW5nIGlzc3VlcyBvZgogIHRoZSBpbnRlcnByZXRhYmlsaXR5IG9mIHRlc3RzIGZvciByZXBsaWNhdGlvbi4gKFBzeWNJTkZPIERhdGFiYXNlIFJlY29yZCAoYykKICAyMDE5IEFQQSwgYWxsIHJpZ2h0cyByZXNlcnZlZCkufSwKICB1cmwgPSB7aHR0cDovL2R4LmRvaS5vcmcvMTAuMTAzNy9tZXQwMDAwMTg5fSwKICBmaWxlID0ge0hlZGdlcyBhbmQgU2NoYXVlciAyMDE5IC0gU3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uIC0gTWV0YS1hbmFseXRpYyBwZXJzcGVjdGl2ZXMucGRmfSwKICBrZXl3b3JkcyA9IHtyZXBsaWNhYmlsaXR5LWJvb2s7bWV0aG9kc30sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCg=="> Download .bib file</a></button></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Meta-analysis and publication bias</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="meta-analysis" class="level1 section" data-number="6"><h1 class="section" data-number="6">
<span class="header-section-number">6</span> Meta-analysis</h1>
<section id="meta-analysis-1" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="meta-analysis-1">
<span class="header-section-number">6.1</span> Meta-analysis</h2>
<ul>
<li>The meta-analysis is a statistical procedure to combine evidence from a group of studies.</li>
</ul>
<p>. . .</p>
<ul>
<li>The idea is to “switch” the statistical unit from e.g., participants to studies</li>
</ul>
<p>. . .</p>
<ul>
<li>The motto could be that (appropriately) combining similar studies with a similar aim is the best way to understand something about a phenomenon</li>
</ul></section><section id="meta-analysis-and-systematic-review" class="level2 smaller" data-number="6.2"><h2 class="smaller anchored" data-number="6.2" data-anchor-id="meta-analysis-and-systematic-review">
<span class="header-section-number">6.2</span> Meta-analysis and Systematic Review</h2>
<p>Usually a meta-analysis work follows these steps:</p>
<ol type="1">
<li>
<strong>Identify the research question</strong>: is the treatment <em>x</em> effective?, Does the experimental effect <em>y</em> exist?</li>
<li>
<strong>Define inclusion/exclusion criteria</strong>: From the research question (1), keep only e.g., randomized controlled trials, studies with healthy participants, etc.</li>
<li>
<strong>Systematically search for studies</strong>: Analyze the literature to find all relevant studies</li>
<li>
<strong>Extract relevant information</strong>: Read, extract and organize relevant information e.g., sample size, treatment type, age, etc.</li>
<li>
<strong>Summarize the results</strong>: Create a narrative (flowcharts, tables, etc.) summary of included studies. This is the Systematic review part.</li>
<li>
<strong>Choose an effect size</strong>: Choose a way to standardize the effect across included studies</li>
<li>
<strong>Meta-analysis model</strong>: Choose and implement a meta-analysis model</li>
<li><strong>Interpret and report results</strong></li>
</ol></section><section id="before-the-fun-part" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="before-the-fun-part">
<span class="header-section-number">6.3</span> Before the fun part…</h2>
<div class="incremental">
<ul class="incremental">
<li>We are dealing only with the <strong>statistical part</strong>. The study selection, data extraction, studies evaluation etc. is another story</li>
<li>The quality of the meta-analysis is the <strong>quality of included studies</strong>
</li>
</ul>
</div>
<p>. . .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/gigo.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</section><section id="unstandardized-effect-sizes" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="unstandardized-effect-sizes">
<span class="header-section-number">6.4</span> Unstandardized effect sizes</h2>
<p>The basic idea of an effect size is just using the raw measure. For example studies using reaction times we can calculate the difference between two conditions as <span class="math inline">\(\overline X_1 - \overline X_2\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="unstandardized-effect-sizes-1" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="unstandardized-effect-sizes-1">
<span class="header-section-number">6.5</span> Unstandardized effect sizes</h2>
<p>But another study (with the same research question) could use another measure, e.g., accuracy. We can still (not the best strategy but) compute the difference between the group means.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="unstandardized-effect-sizes-2" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="unstandardized-effect-sizes-2">
<span class="header-section-number">6.6</span> Unstandardized effect sizes</h2>
<p>Clearly we cannot directly compare the two effects but we need to standardize the measure.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="standardized-effect-sizes" class="level2" data-number="6.7"><h2 data-number="6.7" class="anchored" data-anchor-id="standardized-effect-sizes">
<span class="header-section-number">6.7</span> Standardized effect sizes</h2>
<p>To compare results from different studies, we should use a common metric. Frequently meta-analysts use <em>standardized</em> effect sizes. For example the Pearson correlation or the Cohen’s <span class="math inline">\(d\)</span>.</p>
<p><span id="eq-correlation"><span class="math display">\[
r = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\sqrt{\sum{(x_i - \bar{x})^2}\sum{(y_i - \bar{y})^2}}}
\tag{6.1}\]</span></span></p>
<p><span class="math display">\[
d = \frac{\bar{x_1} - \bar{x_2}}{s_p}
\]</span></p>
<p><span class="math display">\[
s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\]</span></p>
</section><section id="standardized-effect-sizes-1" class="level2" data-number="6.8"><h2 data-number="6.8" class="anchored" data-anchor-id="standardized-effect-sizes-1">
<span class="header-section-number">6.8</span> Standardized effect sizes</h2>
<p>The advantage of standardized effect size is that regardless the original variable, the interpretation and the scale is the same. For example the pearson correlation ranges between -1 and 1 and the Cohen’s <span class="math inline">\(d\)</span> between <span class="math inline">\(- \infty\)</span> and <span class="math inline">\(\infty\)</span> and is interpreted as how many standard deviations the two groups/conditions differs.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">S</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">X</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>, cex <span class="op">=</span> <span class="fl">1.3</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     cex.lab <span class="op">=</span> <span class="fl">1.2</span>, cex.axis <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>     main <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$r = %.2f$"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     main <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$d = %.2f$"</span>, <span class="fu">lsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lsr/man/cohensD.html">cohensD</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="standardized-vs-unstandardized" class="level2" data-number="6.9"><h2 data-number="6.9" class="anchored" data-anchor-id="standardized-vs-unstandardized">
<span class="header-section-number">6.9</span> Standardized vs unstandardized</h2>
<p>The main difference is (usually) the absence of a effect-size-variance relationship for unstandardized effects. For example, the variance of the difference between two groups is:</p>
<p><span id="eq-var-umd"><span class="math display">\[
V_d = \frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}
\tag{6.2}\]</span></span></p>
<p>While the variance of a Cohen’s <span class="math inline">\(d\)</span> can be calculated as:</p>
<p><span class="math display">\[
V_d = \frac{n_1 + n_2}{n_1 n_2} + \frac{d^2}{2(n_1 + n_2)}
\]</span></p>
</section><section id="standardized-vs-unstandardized-1" class="level2" data-number="6.10"><h2 data-number="6.10" class="anchored" data-anchor-id="standardized-vs-unstandardized-1">
<span class="header-section-number">6.10</span> Standardized vs unstandardized</h2>
<p>In this <a href="https://www.jepusto.com/alternative-formulas-for-the-smd/">amazing blog post</a> James Pustejovsky explained where the equations comes from. Basically, the <span class="math inline">\(\frac{n_1 + n_2}{n_1 n_2}\)</span> term is the same as the <span class="math inline">\(\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}\)</span> while the extra <span class="math inline">\(\frac{d^2}{2(n_1 + n_2)}\)</span> is for the non-centrality induced by the standardized difference.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">vumd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dd</span>, <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">vd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dd</span>, <span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">dd</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">d</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"Sample Size"</span>,</span>
<span>       color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-effsize-se" class="level2" data-number="6.11"><h2 data-number="6.11" class="anchored" data-anchor-id="sec-effsize-se">
<span class="header-section-number">6.11</span> Effect size sampling variability</h2>
<p>Crucially, we can calculate also the <strong>sampling variability</strong> of each effect size. The <strong>sampling variability</strong> is the precision of estimated value.</p>
<p>For example, there are multiple methods to estimate the Cohen’s <span class="math inline">\(d\)</span> sampling variability. For example:</p>
<p><span class="math display">\[
V_d = \frac{n_1 + n_2}{n_1 n_2} + \frac{d^2}{2(n_1 + n_2)}
\]</span></p>
<p>Each effect size has a specific formula for the sampling variability. The sample size is usually the most important information. Studies with high sample size have low sampling variability.</p>
</section><section id="effect-size-sampling-variability" class="level2" data-number="6.12"><h2 data-number="6.12" class="anchored" data-anchor-id="effect-size-sampling-variability">
<span class="header-section-number">6.12</span> Effect size sampling variability</h2>
<p>As the sample size grows and tends to infinity, the sampling variability approach zero.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="unstandardized-effect-sizes-3" class="level2" data-number="6.13"><h2 data-number="6.13" class="anchored" data-anchor-id="unstandardized-effect-sizes-3">
<span class="header-section-number">6.13</span> Unstandardized effect sizes</h2>
<p>For the examples and plots I’m going to use simulated data. We simulate <em>unstandardized</em> effect sizes (UMD) because the computations are easier and the estimator is unbiased <span class="citation" data-cites="Viechtbauer2005-zt">(e.g., <a href="chapter5.html#ref-Viechtbauer2005-zt" role="doc-biblioref">Viechtbauer, 2005</a>)</span></p>
<p>More specifically we simulate hypothetical studies where two independent groups are compared:</p>
<p><span id="eq-umd"><span class="math display">\[
\Delta = \overline{X_1} - \overline{X_2}
\tag{6.3}\]</span></span></p>
<p><span class="math display">\[
SE_{\Delta} = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}
\]</span></p>
<p>With <span class="math inline">\(X_{1_i} \sim \mathcal{N}(0, 1)\)</span> and <span class="math inline">\(X_{2_i} \sim \mathcal{N}(\Delta, 1)\)</span></p>
<p>The main advantage is that, compared to standardized effect size, the sampling variability do not depends on the effect size itself, simplifying the computations.</p>
</section></section><section id="simulating-a-single-study" class="level1 section" data-number="7"><h1 class="section" data-number="7">
<span class="header-section-number">7</span> Simulating a single study</h1>
<section id="simulating-a-single-study---umd" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="simulating-a-single-study---umd">
<span class="header-section-number">7.1</span> Simulating a single study - UMD</h2>
<p>To simulate a single study using a UMD we need to generate data according to the appropriate model. Here we have a difference between two groups. We can assume that the two groups comes from a normal distribution where group 1 <span class="math inline">\(g_1 \sim \mathcal{N}(0, 1)\)</span> and group 2 <span class="math inline">\(g_2 \sim \mathcal{N}(D, 1)\)</span> where <span class="math inline">\(D\)</span> is the effect size. Then using Equations <a href="#eq-var-umd" class="quarto-xref"><span>6.2</span></a>, <a href="#eq-umd" class="quarto-xref"><span>6.3</span></a> we can estimate the effect size and the variance.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co"># effect size</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># sample size</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">D</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># effect size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8988085</span></span>
<span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 0.0381312</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-single-study---umd-1" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="simulating-a-single-study---umd-1">
<span class="header-section-number">7.2</span> Simulating a single study - UMD</h2>
<p>For simplicity we can wrap everything within a function:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># default sd = 1</span></span>
<span><span class="va">sim_umd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">D</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span> <span class="co"># same to n1 if null </span></span>
<span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span>, mean <span class="op">=</span> <span class="va">D</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">sim_umd</span><span class="op">(</span><span class="fl">100</span>, D <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;          yi         vi</span></span>
<span><span class="co">#&gt; 1 0.4114704 0.02041681</span></span>
<span><span class="fu">sim_umd</span><span class="op">(</span><span class="fl">50</span>, D <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;           yi         vi</span></span>
<span><span class="co">#&gt; 1 -0.1741297 0.04320926</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-single-study---umd-2" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="simulating-a-single-study---umd-2">
<span class="header-section-number">7.3</span> Simulating a single study - UMD</h2>
<p>We can also generate a large number of studies and check the distribution of effect size and sampling variances. Note that the real <span class="math inline">\(D = 1\)</span> and the real variance <span class="math inline">\(V_D = 1/50 + 1/50 = 0.04\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu">sim_umd</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">50</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># simplify = FALSE return a list</span></span>
<span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">studies</span><span class="op">)</span> <span class="co"># to dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">studies</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          yi         vi
#&gt; 1 1.0498116 0.03577581
#&gt; 2 0.6682341 0.03041130
#&gt; 3 0.9836933 0.03880497
#&gt; 4 1.0205462 0.04067314
#&gt; 5 1.2316595 0.03710892
#&gt; 6 1.2021872 0.03864621</code></pre>
</div>
</div>
</section><section id="sec-umd-sampling-distribution" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-umd-sampling-distribution">
<span class="header-section-number">7.4</span> Simulating a single study - UMD</h2>
<p>Then we can plot the sampling distributions:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-a-single-study---smd" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="simulating-a-single-study---smd">
<span class="header-section-number">7.5</span> Simulating a single study - SMD</h2>
<p>The idea is the same when simulating a SDM but we need extra steps. Let’s adjust the previous function:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_smd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">D</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span> <span class="co"># same to n1 if null </span></span>
<span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span>, mean <span class="op">=</span> <span class="va">D</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># pooled standard deviation</span></span>
<span>  <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">v1</span> <span class="op">*</span> <span class="op">(</span><span class="va">n1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">v2</span> <span class="op">*</span> <span class="op">(</span><span class="va">n2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">sp</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n1</span> <span class="op">*</span> <span class="va">n2</span><span class="op">)</span> <span class="op">+</span> <span class="va">yi</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-single-study---smd-1" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="simulating-a-single-study---smd-1">
<span class="header-section-number">7.6</span> Simulating a single study - SMD</h2>
<p>When working with SMD, calculating the sampling variance can be challenging. <span class="citation" data-cites="Veroniki2016-nw">Veroniki et al. (<a href="chapter5.html#ref-Veroniki2016-nw" role="doc-biblioref">2016</a>)</span> identified 16 different estimators with different properties. Furthermore, it is a common practice to correct the SDM effect and variance using the Hedges’s correction <span class="citation" data-cites="Hedges1989-ip">(<a href="chapter5.html#ref-Hedges1989-ip" role="doc-biblioref">Hedges, 1989</a>)</span>.</p>
<p>You can directly implement another equation for the sampling variance or the Hedges’s correction directly in the simulation function.</p>
</section><section id="simulating-a-single-study---pearson-rho" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho">
<span class="header-section-number">7.7</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<p>Another common effect size is the Pearson correlation coefficient <span class="math inline">\(\rho\)</span> (and the estimate <span class="math inline">\(r\)</span>, see <a href="#eq-correlation" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>). The variance of the correlation is calculated as:</p>
<p><span class="math display">\[
V_{r} = \frac{(1 - r^2)^2}{n - 1}
\]</span></p>
</section><section id="simulating-a-single-study---pearson-rho-1" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho-1">
<span class="header-section-number">7.8</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<p>There is a huge dependency between <span class="math inline">\(r\)</span> and it’s sampling variance (similar to the Cohen’s <span class="math inline">\(d\)</span>):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">v</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"N = 50"</span>, xlab <span class="op">=</span> <span class="st">"r"</span>, ylab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$V_r$"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-a-single-study---pearson-rho-2" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho-2">
<span class="header-section-number">7.9</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<p>For this reason the so-called Fisher’s <span class="math inline">\(z\)</span> transformation is used to stabilize the relationship.</p>
<p><span class="math display">\[
z = \frac{\log{\frac{1 + r}{1 - r}}}{2}
\]</span></p>
<p><span class="math display">\[
V_z = \frac{1}{n - 3}
\]</span></p>
<p>Now the variance is completely independent from the correlation value.</p>
</section><section id="simulating-a-single-study---pearson-rho-3" class="level2" data-number="7.10"><h2 data-number="7.10" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho-3">
<span class="header-section-number">7.10</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<p>This is the relationship between <span class="math inline">\(r\)</span> and <span class="math inline">\(z\)</span>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">r</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Fisher's z"</span>, ylab <span class="op">=</span> <span class="st">"Correlation"</span>, main <span class="op">=</span> <span class="st">"Correlation to Fisher's z"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-a-single-study---pearson-rho-4" class="level2" data-number="7.11"><h2 data-number="7.11" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho-4">
<span class="header-section-number">7.11</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<p>To simulate a study using correlations we can use the <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">MASS::mvrnorm()</a></code> function that can generate correlated data from a multivariate normal distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_r</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">r</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">R</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># 2 x 2 correlation matrix</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span> <span class="co"># the means are not relevant here</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># extract correlation</span></span>
<span>  <span class="va">vr</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># variance of r</span></span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span> <span class="co"># fisher z</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># fisher z variance</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, <span class="va">r</span>, <span class="va">vr</span><span class="op">)</span> <span class="co"># including also the pearson correlation and variance</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-single-study---pearson-rho-5" class="level2" data-number="7.12"><h2 data-number="7.12" class="anchored" data-anchor-id="simulating-a-single-study---pearson-rho-5">
<span class="header-section-number">7.12</span> Simulating a single study - Pearson <span class="math inline">\(\rho\)</span>
</h2>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sim_r</span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;          yi         vi         r          vr</span></span>
<span><span class="co">#&gt; 1 0.5132608 0.01030928 0.4724819 0.006094519</span></span>
<span><span class="fu">sim_r</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt;         yi        vi         r          vr</span></span>
<span><span class="co">#&gt; 1 1.195983 0.0212766 0.8324254 0.001924302</span></span>
<span></span>
<span><span class="co"># also here the sampling distributions</span></span>
<span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu">sim_r</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.7</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">studies</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">studies</span><span class="op">)</span></span>
<span><span class="co">#&gt;        yi               vi                r                vr          </span></span>
<span><span class="co">#&gt;  Min.   :0.4563   Min.   :0.02128   Min.   :0.4270   Min.   :0.001173  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.7820   1st Qu.:0.02128   1st Qu.:0.6539   1st Qu.:0.003783  </span></span>
<span><span class="co">#&gt;  Median :0.8770   Median :0.02128   Median :0.7049   Median :0.005166  </span></span>
<span><span class="co">#&gt;  Mean   :0.8816   Mean   :0.02128   Mean   :0.7001   Mean   :0.005397  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.9836   3rd Qu.:0.02128   3rd Qu.:0.7546   3rd Qu.:0.006688  </span></span>
<span><span class="co">#&gt;  Max.   :1.3410   Max.   :0.02128   Max.   :0.8719   Max.   :0.013643</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="more-on-effect-sizes" class="level2" data-number="7.13"><h2 data-number="7.13" class="anchored" data-anchor-id="more-on-effect-sizes">
<span class="header-section-number">7.13</span> More on effect sizes</h2>
<p>The same logic can be applied to any situation. Just understand the data generation process, find the effect size equations and generate data.</p>
<ul>
<li>
<span class="citation" data-cites="Borenstein2009-mo">Borenstein et al. (<a href="chapter5.html#ref-Borenstein2009-mo" role="doc-biblioref">2009</a>)</span> for all effect sizes equations. Also with equations to convert among effect sizes (useful in real-world meta-analyses)<br>
</li>
<li>the <a href="https://wviechtb.github.io/metafor/reference/escalc.html"><code>metafor::escalc()</code></a> function implements basically any effect size. You can see also the <a href="https://github.com/wviechtb/metafor/blob/master/R/escalc.r">source code</a> to see the actual R implementation.</li>
<li>
<a href="https://matthewbjane.quarto.pub/guide-to-effect-sizes-and-confidence-intervals">Guide to effect sizes</a>: a modern and complete overview of effect sizes</li>
</ul></section><section id="simulating-from-sampling-distributions-extra" class="level2" data-number="7.14"><h2 data-number="7.14" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra">
<span class="header-section-number">7.14</span> Simulating from sampling distributions [#extra]</h2>
<p>The previous simulation examples are participant-level simulations. In fact we simulated <span class="math inline">\(n\)</span> observations then we aggregated calculating the effect sizes.</p>
<p>. . .</p>
<p>This is the most flexible and general data simulation strategy but is computationally not efficient.</p>
<p>. . .</p>
<p>Another strategy individuate the exact effect size sampling distribution. Then we can sample directly from it. The downside is that we need to derive (or find) the equation.</p>
</section><section id="simulating-from-sampling-distributions-extra-1" class="level2" data-number="7.15"><h2 data-number="7.15" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra-1">
<span class="header-section-number">7.15</span> Simulating from sampling distributions [#extra]</h2>
<p>For example, when generating UMD we can simulate from the sampling distribution presented in <a href="#sec-umd-sampling-distribution" class="quarto-xref"><span>Section 7.4</span></a>.</p>
<p><span class="math display">\[
y_i \sim \mathcal{N}(\theta, \sqrt{\sigma^2_i})
\]</span> <span class="math display">\[
\sigma^2_i \sim \frac{\chi^2_{n_1 + n_2 - 2}}{n_1 + n_2 - 2} (\frac{1}{n_1} + \frac{1}{n_2})
\]</span></p>
<p>In this way we can sample <span class="math inline">\(k\)</span> effects and sampling variances directly from the sampling distributions. Without generating data and then aggregate.</p>
</section><section id="simulating-from-sampling-distributions-extra-2" class="level2" data-number="7.16"><h2 data-number="7.16" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra-2">
<span class="header-section-number">7.16</span> Simulating from sampling distributions [#extra]</h2>
<p>We can again put everything within a function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_k_umd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">D</span>, <span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span></span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">D</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="simulating-from-sampling-distributions-extra-3" class="level2" data-number="7.17"><h2 data-number="7.17" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra-3">
<span class="header-section-number">7.17</span> Simulating from sampling distributions [#extra]</h2>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sim_k_umd</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">10</span>, D <span class="op">=</span> <span class="fl">0.5</span>, n1 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt;           yi         vi</span></span>
<span><span class="co">#&gt; 1  0.5542286 0.04302018</span></span>
<span><span class="co">#&gt; 2  0.7837123 0.03991671</span></span>
<span><span class="co">#&gt; 3  0.3708463 0.04113782</span></span>
<span><span class="co">#&gt; 4  0.6159170 0.03526492</span></span>
<span><span class="co">#&gt; 5  0.6729047 0.03892563</span></span>
<span><span class="co">#&gt; 6  0.4946377 0.03992805</span></span>
<span><span class="co">#&gt; 7  0.5045990 0.03664000</span></span>
<span><span class="co">#&gt; 8  0.3628192 0.04725545</span></span>
<span><span class="co">#&gt; 9  0.2318982 0.04106268</span></span>
<span><span class="co">#&gt; 10 0.6832070 0.05237131</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-from-sampling-distributions-extra-4" class="level2" data-number="7.18"><h2 data-number="7.18" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra-4">
<span class="header-section-number">7.18</span> Simulating from sampling distributions [#extra]</h2>
<p>We can compare the two methods and see that we are sampling from the same data generation process.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span><span class="va">s_umd</span> <span class="op">&lt;-</span> <span class="fu">sim_k_umd</span><span class="op">(</span><span class="va">k</span>, D <span class="op">=</span> <span class="fl">1</span>, n1 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">ip_umd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">k</span>, <span class="fu">sim_umd</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">50</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ip_umd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">ip_umd</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-from-sampling-distributions-extra-5" class="level2" data-number="7.19"><h2 data-number="7.19" class="anchored" data-anchor-id="simulating-from-sampling-distributions-extra-5">
<span class="header-section-number">7.19</span> Simulating from sampling distributions [#extra]</h2>
<p>The actual advantage is in terms of computational speed. To simulate <span class="math inline">\(k = 10\)</span> studies for 1000 times (similar to a standard Monte Carlo simulation):</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  sampling <span class="op">=</span> <span class="fu">sim_k_umd</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">10</span>, n1 <span class="op">=</span> <span class="fl">50</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  participant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu">sim_umd</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">50</span>, D <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">1000</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          expr      min        lq      mean   median       uq      max neval cld</span></span>
<span><span class="co">#&gt; 1    sampling  119.875  126.2125  132.4143  130.801  136.913  393.049  1000  a </span></span>
<span><span class="co">#&gt; 2 participant 1533.363 1570.9390 1629.5997 1588.637 1605.914 6118.904  1000   b</span></span>
<span></span>
<span><span class="va">bench</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">bench</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># faster</span></span>
<span><span class="co">#&gt; [1] 12.30682</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="simulation-setup" class="level1 section" data-number="8"><h1 class="section" data-number="8">
<span class="header-section-number">8</span> Simulation setup</h1>
<section id="notation" class="level2 smaller" data-number="8.1"><h2 class="smaller anchored" data-number="8.1" data-anchor-id="notation">
<span class="header-section-number">8.1</span> Notation</h2>
<p>Meta-analysis notation is a little bit inconsistent in textbooks and papers. We define here some rules to simplify the work.</p>
<ul>
<li>
<span class="math inline">\(k\)</span> is the number of studies</li>
<li>
<span class="math inline">\(n_j\)</span> is the sample size of the group <span class="math inline">\(j\)</span> within a study</li>
<li>
<span class="math inline">\(y_i\)</span> are the observed effect size included in the meta-analysis</li>
<li>
<span class="math inline">\(\sigma_i^2\)</span> are the observed sampling variance of studies and <span class="math inline">\(\epsilon_i\)</span> are the sampling errors</li>
<li>
<span class="math inline">\(\theta\)</span> is the equal-effects parameter (see <a href="#eq-ee1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a>)</li>
<li>
<span class="math inline">\(\delta_i\)</span> is the random-effect (see <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>)</li>
<li>
<span class="math inline">\(\mu_\theta\)</span> is the average effect of a random-effects model (see <a href="#eq-re-mod1" class="quarto-xref">Equation&nbsp;<span>11.1</span></a>)</li>
<li>
<span class="math inline">\(w_i\)</span> are the meta-analysis weights</li>
<li>
<span class="math inline">\(\tau^2\)</span> is the heterogeneity (see <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>)</li>
<li>
<span class="math inline">\(\Delta\)</span> is the (generic) population effect size</li>
<li>
<span class="math inline">\(s_j^2\)</span> is the variance of the group <span class="math inline">\(j\)</span> within a study</li>
</ul></section><section id="simulation-setup-1" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="simulation-setup-1">
<span class="header-section-number">8.2</span> Simulation setup</h2>
<p>Given the introduction to effect sizes, from now we will simulate data using UMD and the individual-level data.</p>
<p>Basically we are simulating an effect size <span class="math inline">\(D\)</span> coming from the comparison of two independent groups <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span>.</p>
<p>Each group is composed by <span class="math inline">\(n\)</span> participants measured on a numerical outcome (e.g., reaction times)</p>
</section><section id="simulation-setup-2" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="simulation-setup-2">
<span class="header-section-number">8.3</span> Simulation setup</h2>
<p>A more general, clear and realistic approach to simulate data is by generating <span class="math inline">\(k\)</span> studies with same/different sample sizes and (later) true effect sizes.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># number of studies</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># sample size from poisson distribution with lambda 40 and minimum 10</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># effect size</span></span>
<span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">D</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>  <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id        yi         vi</span></span>
<span><span class="co">#&gt; 1  1 0.6161948 0.05161202</span></span>
<span><span class="co">#&gt; 2  2 0.3942969 0.07989387</span></span>
<span><span class="co">#&gt; 3  3 0.6223084 0.07811994</span></span>
<span><span class="co">#&gt; 4  4 0.2317775 0.09670337</span></span>
<span><span class="co">#&gt; 5  5 0.2699480 0.04687939</span></span>
<span><span class="co">#&gt; 6  6 0.6029536 0.08060074</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulation-setup-3" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="simulation-setup-3">
<span class="header-section-number">8.4</span> Simulation setup</h2>
<p>We can again put everything within a function:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_studies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">es</span>, <span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">es</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">es</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>    <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="va">yi</span>, <span class="va">vi</span>, n1 <span class="op">=</span> <span class="va">n1</span>, n2 <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># convert to escalc for using metafor methods</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/escalc.html">escalc</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="va">yi</span>, vi <span class="op">=</span> <span class="va">vi</span>, data <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulation-setup---disclaimer" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="simulation-setup---disclaimer">
<span class="header-section-number">8.5</span> Simulation setup - Disclaimer</h2>
<p>The proposed simulation approach using a <code>for</code> loop and separated vectors. For the purpose of the workshop this is the best option. In real-world meta-analysis simulations you can choose a more functional approach starting from a simulation grid as <code>data.frame</code> and mapping the simulation functions.</p>
<p>For some examples see:</p>
<ul>
<li><span class="citation" data-cites="Gambarota2023-on">(<a href="chapter5.html#ref-Gambarota2023-on" role="doc-biblioref"><strong>Gambarota2023-on?</strong></a>)</span></li>
<li><a href="https://www.jepusto.com/simulating-correlated-smds">www.jepusto.com/simulating-correlated-smds</a></li>
</ul></section><section id="simulation-setup---disclaimer-1" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="simulation-setup---disclaimer-1">
<span class="header-section-number">8.6</span> Simulation setup - Disclaimer</h2>
<p>For a more extended overview of the simulation setup we have an entire paper. Supplementary materials (<a href="https://github.com/shared-research/simulating-meta-analysis">github.com/shared-research/simulating-meta-analysis</a>) contains also more examples for complex (multilevel and multivariate models.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/gambarota2023.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section></section><section id="combining-studies" class="level1 section" data-number="9"><h1 class="section" data-number="9">
<span class="header-section-number">9</span> Combining studies</h1>
<section id="combining-studies-1" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="combining-studies-1">
<span class="header-section-number">9.1</span> Combining studies</h2>
<p>Let’s imagine to have <span class="math inline">\(k = 10\)</span> studies, a <span class="math inline">\(D = 0.5\)</span> and heterogeneous sample sizes in each study.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, lambda <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">D</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   id      yi     vi n1 n2 </span></span>
<span><span class="co">#&gt; 1  1 -0.0200 0.0826 32 32 </span></span>
<span><span class="co">#&gt; 2  2 -0.0533 0.1244 21 21 </span></span>
<span><span class="co">#&gt; 3  3  0.8737 0.0524 31 31 </span></span>
<span><span class="co">#&gt; 4  4  0.6142 0.0664 29 29 </span></span>
<span><span class="co">#&gt; 5  5  0.2540 0.0510 37 37 </span></span>
<span><span class="co">#&gt; 6  6  0.5867 0.0511 29 29</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>What is the best way to combine the studies?</p>
</section><section id="combining-studies-2" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="combining-studies-2">
<span class="header-section-number">9.2</span> Combining studies</h2>
<p>We can take the average effect size and considering it as a huge study. This can be considered the best way to combine the effects.</p>
<p><span class="math display">\[
\hat{D} = \frac{\sum^{k}_{i = 1} D_i}{k}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3874658</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>It is appropriate? What do you think? Are we missing something?</p>
</section><section id="weighting-studies" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="weighting-studies">
<span class="header-section-number">9.3</span> Weighting studies</h2>
<p>We are not considering that some studies, despite providing a similar effect size could give more information. An higher sample size (or lower sampling variance) produce a more reliable estimation.</p>
<p>. . .</p>
<p>Would you trust more a study with <span class="math inline">\(n = 100\)</span> and <span class="math inline">\(D = 0.5\)</span> or a study with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(D = 0.5\)</span>? The “meta-analysis” that we did before is completely ignoring this information.</p>
</section><section id="weighting-studies-1" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="weighting-studies-1">
<span class="header-section-number">9.4</span> Weighting studies</h2>
<p>We need to find a value (called weight <span class="math inline">\(w_i\)</span>) that allows assigning more trust to a study because it provide more information.</p>
<p>. . .</p>
<p>The simplest weights are just the sample size, but in practice we use the so-called <strong>inverse-variance weighting</strong>. We use the (inverse) of the sampling variance of the effect size to weight each study.</p>
<p>. . .</p>
<p>The basic version of a meta-analysis is just a <strong>weighted average</strong>:</p>
<p><span class="math display">\[
\overline D_w = \frac{\sum^k_{i = 1}{w_iD_i}}{\sum^k_{i = 1}{w_i}}
\]</span></p>
<p>. . .</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span> <span class="op">*</span> <span class="va">wi</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.41158</span></span>
<span><span class="co"># weighted.mean(dat$yi, wi)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="weighting-studies-2" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="weighting-studies-2">
<span class="header-section-number">9.5</span> Weighting studies</h2>
<p>Graphically, the two models can be represented in this way:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="va">dunw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unw_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yi</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">dunw</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_i$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Study"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">0.4</span>, label <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$\\bar{D} = %.2f$"</span>, <span class="va">dunw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">id</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"n = "</span>, <span class="va">n1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">yi</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span>,</span>
<span>             show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">dw</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_i$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Study"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">0.4</span>, label <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$\\bar{D}_w = %.2f$"</span>, <span class="va">dw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">id</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"n = "</span>, <span class="va">n1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unw_plot</span> <span class="op">+</span> <span class="va">w_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="equal-effects-ee-meta-analysis" class="level1 section" data-number="10"><h1 class="section" data-number="10">
<span class="header-section-number">10</span> Equal-effects (EE) meta-analysis</h1>
<section id="ee-meta-analysis" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="ee-meta-analysis">
<span class="header-section-number">10.1</span> EE meta-analysis</h2>
<p>What we did in the last example (the weighted mean) is the exactly a meta-analysis model called <strong>equal-effects</strong> (or less precisely fixed-effect). The assumptions are very simple:</p>
<ul>
<li>there is a unique, true effect size to estimate <span class="math inline">\(\theta\)</span>
</li>
<li>each study is a more or less precise estimate of <span class="math inline">\(\theta\)</span>
</li>
<li>there is no TRUE variability among studies. The observed variability is due to studies that are imprecise (i.e., sampling error)</li>
<li>assuming that each study has a very large sample size, the observed variability is close to zero.</li>
</ul></section><section id="ee-meta-analysis-formally" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="ee-meta-analysis-formally">
<span class="header-section-number">10.2</span> EE meta-analysis, formally</h2>
<p><span id="eq-ee1"><span class="math display">\[
y_i = \theta + \epsilon_i
\tag{10.1}\]</span></span></p>
<p><span id="eq-ee2"><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\tag{10.2}\]</span></span></p>
<p>Where <span class="math inline">\(\sigma^2_i\)</span> is the vector of sampling variabilities of <span class="math inline">\(k\)</span> studies. This is a standard linear model but with heterogeneous sampling variances.</p>
</section><section id="ee-meta-analysis-1" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="ee-meta-analysis-1">
<span class="header-section-number">10.3</span> EE meta-analysis</h2>
<!-- TODO fix the image, ggplot version -->
</section><section id="simulating-an-ee-model" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="simulating-an-ee-model">
<span class="header-section-number">10.4</span> Simulating an EE model</h2>
<p>What we were doing with the <code>sim_studies()</code> function so far was simulating an EE model. In fact, there were a single <span class="math inline">\(\theta\)</span> parameter and the observed variability was a function of the <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> randomness.</p>
<p>Based on previous assumptions and thinking a little bit, what could be the result of simulating studies with a very large <span class="math inline">\(n\)</span>?</p>
<p>. . .</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">dats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">ns</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="fl">10</span>, es <span class="op">=</span> <span class="va">D</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-ee-impact-n" class="level2" data-number="10.5"><h2 data-number="10.5" class="anchored" data-anchor-id="sec-ee-impact-n">
<span class="header-section-number">10.5</span> Simulating an EE modelm</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-an-ee-model-1" class="level2" data-number="10.6"><h2 data-number="10.6" class="anchored" data-anchor-id="simulating-an-ee-model-1">
<span class="header-section-number">10.6</span> Simulating an EE model</h2>
<p>Formulating the model as a intercept-only regression (see Equations <a href="#eq-ee1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> and <a href="#eq-ee2" class="quarto-xref">Equation&nbsp;<span>10.2</span></a>) we can generate data directly:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># or equivalently</span></span>
<span><span class="co"># yi &lt;- rnorm(k, D, sqrt(1/n + 1/n))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we did for the aggregated data approach. Clearly we need to simulate also the <code>vi</code> vector from the appropriate distribution. Given that we simulated data starting from the participant-level the uncertainty of <code>yi</code> and <code>vi</code> is already included.</p>
</section><section id="fitting-an-ee-model" class="level2" data-number="10.7"><h2 data-number="10.7" class="anchored" data-anchor-id="fitting-an-ee-model">
<span class="header-section-number">10.7</span> Fitting an EE model</h2>
<p>The model can be fitted using the <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">metafor::rma()</a></code> function, with <code>method = "EE"</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">theta</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"EE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Equal-Effects Model (k = 15)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span><span class="co">#&gt;   2.4968    8.3471   -2.9936   -2.2855   -2.6859   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; I^2 (total heterogeneity / total variability):   0.00%</span></span>
<span><span class="co">#&gt; H^2 (total variability / sampling variability):  0.60</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span><span class="co">#&gt; Q(df = 14) = 8.3471, p-val = 0.8705</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span><span class="co">#&gt;   0.5999  0.0647  9.2691  &lt;.0001  0.4731  0.7268  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="interpreting-an-ee-model" class="level2" data-number="10.8"><h2 data-number="10.8" class="anchored" data-anchor-id="interpreting-an-ee-model">
<span class="header-section-number">10.8</span> Interpreting an EE model</h2>
<ul>
<li>The first section (<code>logLik</code>, <code>deviance</code>, etc.) presents some general model statistics and information criteria</li>
<li>The <span class="math inline">\(I^2\)</span> and <span class="math inline">\(H^2\)</span> are statistics evaluating the observed heterogeneity (see next slides)</li>
<li>The <code>Test of Heterogeneity</code> section presents the test of the <span class="math inline">\(Q\)</span> statistics for the observed heterogeneity (see next slides)</li>
<li>The <code>Model Results</code> section presents the estimation of the <span class="math inline">\(\theta\)</span> parameter along with the standard error and the Wald <span class="math inline">\(z\)</span> test (<span class="math inline">\(H_0: \theta = 0\)</span>)</li>
</ul>
<p>The <code>metafor</code> package has a several well documented functions to calculate and plot model results, residuals analysis etc.</p>
</section><section id="interpreting-an-ee-model-1" class="level2" data-number="10.9"><h2 data-number="10.9" class="anchored" data-anchor-id="interpreting-an-ee-model-1">
<span class="header-section-number">10.9</span> Interpreting an EE model</h2>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># general plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="interpreting-an-ee-model-2" class="level2" data-number="10.10"><h2 data-number="10.10" class="anchored" data-anchor-id="interpreting-an-ee-model-2">
<span class="header-section-number">10.10</span> Interpreting an EE Model</h2>
<p>The main function for plotting model results is the <code>forest()</code> function that produce the forest plot.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">forest</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="interpreting-an-ee-model-3" class="level2" data-number="10.11"><h2 data-number="10.11" class="anchored" data-anchor-id="interpreting-an-ee-model-3">
<span class="header-section-number">10.11</span> Interpreting an EE Model</h2>
<p>We did not introduced the concept of heterogeneity, but the <span class="math inline">\(I^2\)</span>, <span class="math inline">\(H^2\)</span> and <span class="math inline">\(Q\)</span> statistics basically evaluate if the observed heterogeneity should be attributed to <strong>sampling variability</strong> (uncertainty in estimating <span class="math inline">\(\theta\)</span> because we have a limited <span class="math inline">\(k\)</span> and <span class="math inline">\(n\)</span>) or <strong>sampling variability</strong> plus other sources of heterogeneity.</p>
</section><section id="ee-model-as-a-weighted-average" class="level2" data-number="10.12"><h2 data-number="10.12" class="anchored" data-anchor-id="ee-model-as-a-weighted-average">
<span class="header-section-number">10.12</span> EE model as a weighted Average</h2>
<p>Formally <span class="math inline">\(\theta\)</span> is estimated as <span class="citation" data-cites="Borenstein2009-mo">(see <a href="chapter5.html#ref-Borenstein2009-mo" role="doc-biblioref">Borenstein et al., 2009, p. 66</a>)</span></p>
<p><span class="math display">\[
\hat{\theta} = \frac{\sum^k_{i = 1}{w_iy_i}}{\sum^k_{i = 1}{w_i}}; \;\;\; w_i = \frac{1}{\sigma^2_i}
\]</span></p>
<p><span class="math display">\[
SE_{\theta} = \frac{1}{\sum^k_{i = 1}{w_i}}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="va">theta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">*</span> <span class="va">wi</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_theta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_hat</span>, se <span class="op">=</span> <span class="va">se_theta_hat</span>, z <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">/</span> <span class="va">se_theta_hat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     theta        se         z </span></span>
<span><span class="co">#&gt; 0.5999291 0.0647239 9.2690513</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="random-effects-re-meta-analysis" class="level1 section" data-number="11"><h1 class="section" data-number="11">
<span class="header-section-number">11</span> Random-effects (RE) meta-analysis</h1>
<section id="are-the-ee-assumptions-realistic" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="are-the-ee-assumptions-realistic">
<span class="header-section-number">11.1</span> Are the EE assumptions realistic?</h2>
<p>The EE model is appropriate if our studies are somehow <strong>exact replications</strong> of the exact same effect. We are assuming that there is <strong>no real variability</strong>.</p>
<p>. . .</p>
<p>However, meta-analysis rarely report the results of <span class="math inline">\(k\)</span> exact replicates. It is more common to include <strong>studies answering the same research question</strong> but with different methods, participants, etc.</p>
<p>. . .</p>
<ul>
<li>people with different ages or other participant-level differences</li>
<li>different methodology</li>
<li>…</li>
</ul></section><section id="are-the-ee-assumptions-realistic-1" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="are-the-ee-assumptions-realistic-1">
<span class="header-section-number">11.2</span> Are the EE assumptions realistic?</h2>
<p>. . .</p>
<p>If we relax the previous assumption we are able to combine studies that are not exact replications.</p>
<p>. . .</p>
<p>Thus the real effect <span class="math inline">\(\theta\)</span> is no longer a single <strong>true</strong> value but can be larger or smaller in some conditions.</p>
<p>. . .</p>
<p>In other terms we are assuming that there could be some variability (i.e., <strong>heterogeneity</strong>) among studies that is independent from the sample size. Even with studies with <span class="math inline">\(\lim_{n\to\infty}\)</span> the observed variability is not zero.</p>
</section><section id="random-effects-model-re" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="random-effects-model-re">
<span class="header-section-number">11.3</span> Random-effects model (RE)</h2>
<p>We can extend the EE model including another source of variability, <span class="math inline">\(\tau^2\)</span>. <span class="math inline">\(\tau^2\)</span> is the true heterogeneity among studies caused by methdological differences or intrisic variability in the phenomenon.</p>
<p>Formally we can extend <a href="#eq-ee1" class="quarto-xref">Equation&nbsp;<span>10.1</span></a> as: <span id="eq-re-mod1"><span class="math display">\[
y_i = \mu_{\theta} + \delta_i + \epsilon_i
\tag{11.1}\]</span></span></p>
<p><span id="eq-re-mod2"><span class="math display">\[
\delta_i \sim \mathcal{N}(0, \tau^2)
\tag{11.2}\]</span></span></p>
<p><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\]</span></p>
<p>Where <span class="math inline">\(\mu_{\theta}\)</span> is the average effect size and <span class="math inline">\(\delta_i\)</span> is the study-specific deviation from the average effect (regulated by <span class="math inline">\(\tau^2\)</span>). Clearly each study specific effect is <span class="math inline">\(\theta_i = \mu_{\theta} + \delta_i\)</span>.</p>
</section><section id="re-model" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="re-model">
<span class="header-section-number">11.4</span> RE model</h2>
<!-- TODO fix the image, ggplot version -->
</section><section id="re-model-estimation" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="re-model-estimation">
<span class="header-section-number">11.5</span> RE model estimation</h2>
<p>Given that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also <span class="math inline">\(\tau^2\)</span>.</p>
<p><span id="eq-re1"><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw^*_i}{\sum_{i = 1}^k w^*_i}
\tag{11.3}\]</span></span></p>
<p><span id="eq-re2"><span class="math display">\[
w^*_i = \frac{1}{\sigma^2_i + \tau^2}
\tag{11.4}\]</span></span></p>
<p>The weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.</p>
</section><section id="re-vs-ee-model" class="level2" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="re-vs-ee-model">
<span class="header-section-number">11.6</span> RE vs EE model</h2>
<p>The crucial difference with the EE model is that even with large <span class="math inline">\(n\)</span>, only the <span class="math inline">\(\mu_{\theta} + \delta_i\)</span> are estimated (almost) without error. As long <span class="math inline">\(\tau^2 \neq 0\)</span> there will be variability in the effect sizes.</p>
<!-- TODO fix the image, ggplot version -->
</section><section id="simulating-a-re-model" class="level2" data-number="11.7"><h2 data-number="11.7" class="anchored" data-anchor-id="simulating-a-re-model">
<span class="header-section-number">11.7</span> Simulating a RE Model</h2>
<p>To simulate the RE model we simply need to include <span class="math inline">\(\tau^2\)</span> in the EE model simulation.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co"># number of studies</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># average effect</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># heterogeneity</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># sample size</span></span>
<span><span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="co"># random-effects</span></span>
<span><span class="va">thetai</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">deltai</span> <span class="co"># true study effect</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">thetai</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   id     yi     vi n1 n2 </span></span>
<span><span class="co">#&gt; 1  1 0.4462 0.0498 37 37 </span></span>
<span><span class="co">#&gt; 2  2 1.0966 0.0641 31 31 </span></span>
<span><span class="co">#&gt; 3  3 0.6987 0.0676 32 32 </span></span>
<span><span class="co">#&gt; 4  4 0.7012 0.0517 33 33 </span></span>
<span><span class="co">#&gt; 5  5 0.2842 0.0767 27 27 </span></span>
<span><span class="co">#&gt; 6  6 0.2323 0.0703 31 31</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-re-model-1" class="level2" data-number="11.8"><h2 data-number="11.8" class="anchored" data-anchor-id="simulating-a-re-model-1">
<span class="header-section-number">11.8</span> Simulating a RE model</h2>
<p>Again, we can put everything within a function expanding the previous <code>sim_studies()</code> by including <span class="math inline">\(\tau^2\)</span>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_studies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">es</span>, <span class="va">tau2</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">add</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">es</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># random effects</span></span>
<span>  <span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">es</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">deltai</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>    <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="va">yi</span>, <span class="va">vi</span>, n1 <span class="op">=</span> <span class="va">n1</span>, n2 <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">add</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">add</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># convert to escalc for using metafor methods</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/escalc.html">escalc</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="va">yi</span>, vi <span class="op">=</span> <span class="va">vi</span>, data <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="simulating-a-re-model-2" class="level2" data-number="11.9"><h2 data-number="11.9" class="anchored" data-anchor-id="simulating-a-re-model-2">
<span class="header-section-number">11.9</span> Simulating a RE model</h2>
<p>The data are similar to the EE simulation but we have an extra source of heterogeneity.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">qforest</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulating-a-re-model-3" class="level2" data-number="11.10"><h2 data-number="11.10" class="anchored" data-anchor-id="simulating-a-re-model-3">
<span class="header-section-number">11.10</span> Simulating a RE model</h2>
<p>To see the actual impact of <span class="math inline">\(\tau^2\)</span> we can follow the same approach of <a href="#sec-ee-impact-n" class="quarto-xref"><span>Section 10.5</span></a> thus using a large <span class="math inline">\(n\)</span>. The sampling variance <code>vi</code> of each study is basically 0.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ... other parameters as before</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span><span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="co"># random-effects</span></span>
<span><span class="va">thetai</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">deltai</span> <span class="co"># true study effect</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">thetai</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># or equivalently </span></span>
<span><span class="co"># dat &lt;- sim_studies(k = k, es = mu, tau2 = tau2, n1 = n)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   id     yi     vi    n1    n2 </span></span>
<span><span class="co">#&gt; 1  1 0.2071 0.0002 10000 10000 </span></span>
<span><span class="co">#&gt; 2  2 0.6257 0.0002 10000 10000 </span></span>
<span><span class="co">#&gt; 3  3 0.7598 0.0002 10000 10000 </span></span>
<span><span class="co">#&gt; 4  4 0.5984 0.0002 10000 10000 </span></span>
<span><span class="co">#&gt; 5  5 0.4834 0.0002 10000 10000 </span></span>
<span><span class="co">#&gt; 6  6 0.2013 0.0002 10000 10000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulating-a-re-model-4" class="level2" data-number="11.11"><h2 data-number="11.11" class="anchored" data-anchor-id="simulating-a-re-model-4">
<span class="header-section-number">11.11</span> Simulating a RE Model</h2>
<p>Clearly, compared to <a href="#sec-ee-impact-n" class="quarto-xref"><span>Section 10.5</span></a>, even with large <span class="math inline">\(n\)</span> the variability is not reduced because <span class="math inline">\(\tau^2 \neq 0\)</span>. As <span class="math inline">\(\tau^2\)</span> approach zero the EE and RE models are similar.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">qforest</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="re-model-estimation-1" class="level2" data-number="11.12"><h2 data-number="11.12" class="anchored" data-anchor-id="re-model-estimation-1">
<span class="header-section-number">11.12</span> RE model estimation</h2>
<p>Given that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also <span class="math inline">\(\tau^2\)</span>.</p>
<p><span id="eq-re1"><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw^*_i}{\sum_{i = 1}^k w^*_i}
\tag{11.5}\]</span></span></p>
<p><span id="eq-re2"><span class="math display">\[
w^*_i = \frac{1}{\sigma^2_i + \tau^2}
\tag{11.6}\]</span></span></p>
<p>The weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.</p>
</section><section id="fitting-a-re-model" class="level2" data-number="11.13"><h2 data-number="11.13" class="anchored" data-anchor-id="fitting-a-re-model">
<span class="header-section-number">11.13</span> Fitting a RE model</h2>
<p>In R we can use the <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">metafor::rma()</a></code> function using the <code>method = "REML"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-Effects Model (k = 15; tau^2 estimator: REML)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span><span class="co">#&gt;  -3.9162    7.8325   11.8325   13.1106   12.9234   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0.1022 (SE = 0.0387)</span></span>
<span><span class="co">#&gt; tau (square root of estimated tau^2 value):      0.3198</span></span>
<span><span class="co">#&gt; I^2 (total heterogeneity / total variability):   99.80%</span></span>
<span><span class="co">#&gt; H^2 (total variability / sampling variability):  512.56</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span><span class="co">#&gt; Q(df = 14) = 7157.7215, p-val &lt; .0001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span><span class="co">#&gt;   0.6142  0.0826  7.4326  &lt;.0001  0.4523  0.7762  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="intepreting-the-re-model" class="level2" data-number="11.14"><h2 data-number="11.14" class="anchored" data-anchor-id="intepreting-the-re-model">
<span class="header-section-number">11.14</span> Intepreting the RE model</h2>
<p>The model output is quite similar to the EE model and also the intepretation is similar.</p>
<p>The only extra section is <code>tau^2/tau</code> that is the estimation of the between-study heterogeneity.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random-Effects Model (k = 15; tau^2 estimator: REML)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   logLik  deviance       AIC       BIC      AICc   </span></span>
<span><span class="co">#&gt;  -3.9162    7.8325   11.8325   13.1106   12.9234   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; tau^2 (estimated amount of total heterogeneity): 0.1022 (SE = 0.0387)</span></span>
<span><span class="co">#&gt; tau (square root of estimated tau^2 value):      0.3198</span></span>
<span><span class="co">#&gt; I^2 (total heterogeneity / total variability):   99.80%</span></span>
<span><span class="co">#&gt; H^2 (total variability / sampling variability):  512.56</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test for Heterogeneity:</span></span>
<span><span class="co">#&gt; Q(df = 14) = 7157.7215, p-val &lt; .0001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; estimate      se    zval    pval   ci.lb   ci.ub      </span></span>
<span><span class="co">#&gt;   0.6142  0.0826  7.4326  &lt;.0001  0.4523  0.7762  *** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="estimating-tau2" class="level2" data-number="11.15"><h2 data-number="11.15" class="anchored" data-anchor-id="estimating-tau2">
<span class="header-section-number">11.15</span> Estimating <span class="math inline">\(\tau^2\)</span>
</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/langan2017.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</section><section id="estimating-tau2-1" class="level2" data-number="11.16"><h2 data-number="11.16" class="anchored" data-anchor-id="estimating-tau2-1">
<span class="header-section-number">11.16</span> Estimating <span class="math inline">\(\tau^2\)</span>
</h2>
<p>The <strong>Restricted Maximum Likelihood</strong> (REML) estimator is considered one of the best. We can compare the results using the <code>all_rma()</code> custom function that tests all the estimators<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitl</span> <span class="op">&lt;-</span> <span class="fu">all_rma</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/compare_rma.html">compare_rma</a></span><span class="op">(</span>fitlist <span class="op">=</span> <span class="va">fitl</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;           DL     HE     HS    HSk     SJ     ML   REML     EB     PM    PMM</span></span>
<span><span class="co">#&gt; b      0.614  0.614  0.614  0.614  0.614  0.614  0.614  0.614  0.614  0.614</span></span>
<span><span class="co">#&gt; se     0.083  0.083  0.080  0.083  0.083  0.080  0.083  0.083  0.083  0.085</span></span>
<span><span class="co">#&gt; zval   7.442  7.433  7.703  7.442  7.433  7.694  7.433  7.433  7.433  7.255</span></span>
<span><span class="co">#&gt; pval   0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000</span></span>
<span><span class="co">#&gt; ci.lb  0.452  0.452  0.458  0.452  0.452  0.458  0.452  0.452  0.452  0.448</span></span>
<span><span class="co">#&gt; ci.ub  0.776  0.776  0.771  0.776  0.776  0.771  0.776  0.776  0.776  0.780</span></span>
<span><span class="co">#&gt; I2    99.804 99.805 99.790 99.804 99.805 99.791 99.805 99.805 99.805 99.814</span></span>
<span><span class="co">#&gt; tau2   0.102  0.102  0.095  0.102  0.102  0.095  0.102  0.102  0.102  0.107</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="intepreting-heterogeneity-tau2" class="level2" data-number="11.17"><h2 data-number="11.17" class="anchored" data-anchor-id="intepreting-heterogeneity-tau2">
<span class="header-section-number">11.17</span> Intepreting heterogeneity <span class="math inline">\(\tau^2\)</span>
</h2>
<p>Looking at <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>, <span class="math inline">\(\tau^2\)</span> is essentially the variance of the random-effect. This means that we can intepret it as the variability (or the standard deviation) of the true effect size distribution.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tau2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">tau2s_t</span> <span class="op">&lt;-</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$\\tau^2 = %.2f$"</span>, <span class="va">tau2s</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e4</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2s</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_i$"</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">tau2s_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e4</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2s</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_i$"</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">tau2s_t</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span></span>
<span><span class="co">#hist(rnorm(1e4, 0, sqrt(tau2s[3])), xlim = c(-2, 2), xlab = latex2exp::TeX("$y_i$"), main = tau2s_t[3], probability = TRUE, ylim = c(0, 5))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e4</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2s</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$y_i$"</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">tau2s_t</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="intepreting-tau2" class="level2" data-number="11.18"><h2 data-number="11.18" class="anchored" data-anchor-id="intepreting-tau2">
<span class="header-section-number">11.18</span> Intepreting <span class="math inline">\(\tau^2\)</span>
</h2>
<p>As in the previus plot we can assume <span class="math inline">\(n = \infty\)</span> and generate true effects from <a href="#eq-re-mod2" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>. In this way we understand the impact of assuming (or estimating) a certain <span class="math inline">\(\tau^2\)</span>.</p>
<p>For example, a <span class="math inline">\(\tau = 0.2\)</span> and a <span class="math inline">\(\mu_{\theta} = 0.5\)</span>, 50% of the true effects ranged between:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">yis</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">yis</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       75%       25% </span></span>
<span><span class="co">#&gt; 0.6358425 0.3664574</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="the-q-statistics" class="level2" data-number="11.19"><h2 data-number="11.19" class="anchored" data-anchor-id="the-q-statistics">
<span class="header-section-number">11.19</span> The <span class="math inline">\(Q\)</span> Statistics<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</h2>
<p>The Q statistics is used to make inference on the heterogeneity. Can be considered as a weighted sum of squares:</p>
<p><span class="math display">\[
Q = \sum^k_{i = 1}w_i(y_i - \hat \mu)^2
\]</span></p>
<p>Where <span class="math inline">\(\hat \mu\)</span> is EE estimation (regardless if <span class="math inline">\(\tau^2 \neq 0\)</span>) and <span class="math inline">\(w_i\)</span> are the inverse-variance weights. Note that in the case of <span class="math inline">\(w_1 = w_2 ... = w_i\)</span>, Q is just a standard sum of squares (or deviance).</p>
</section><section id="the-q-statistics-1" class="level2" data-number="11.20"><h2 data-number="11.20" class="anchored" data-anchor-id="the-q-statistics-1">
<span class="header-section-number">11.20</span> The <span class="math inline">\(Q\)</span> Statistics</h2>
<ul>
<li>Given that we are summing up squared distances, they should be approximately <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(df = k - 1\)</span>. In case of no heterogeneity (<span class="math inline">\(\tau^2 = 0\)</span>) the observed variability is only caused by sampling error and the expectd value of the <span class="math inline">\(\chi^2\)</span> is just the degrees of freedom (<span class="math inline">\(df = k - 1\)</span>).</li>
<li>In case of <span class="math inline">\(\tau^2 \neq 0\)</span>, the expected value is <span class="math inline">\(k - 1 + \lambda\)</span> where <span class="math inline">\(\lambda\)</span> is a non-centrality parameter.</li>
<li>In other terms, if the expected value of <span class="math inline">\(Q\)</span> exceed the expected value assuming no heterogeneity, we have evidence that <span class="math inline">\(\tau^2 \neq 0\)</span>.</li>
</ul></section><section id="the-q-statistics-2" class="level2" data-number="11.21"><h2 data-number="11.21" class="anchored" data-anchor-id="the-q-statistics-2">
<span class="header-section-number">11.21</span> The <span class="math inline">\(Q\)</span> Statistics</h2>
<p>Let’s try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">get_Q</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">vi</span></span>
<span>  <span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">wi</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">*</span><span class="op">(</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span></span>
<span><span class="va">Qs_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">Qs_tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">res2_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">res2_tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dat_tau2_0</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">30</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">dat_tau2</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">30</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">theta_ee_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span>, <span class="fl">1</span><span class="op">/</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span>, <span class="fl">1</span><span class="op">/</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">res2_tau2_0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee_tau2_0</span></span>
<span>  <span class="va">res2_tau2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span></span>
<span>  </span>
<span>  <span class="va">Qs_tau2_0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">get_Q</span><span class="op">(</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">Qs_tau2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">get_Q</span><span class="op">(</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat_tau2</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="the-q-statistics-3" class="level2" data-number="11.22"><h2 data-number="11.22" class="anchored" data-anchor-id="the-q-statistics-3">
<span class="header-section-number">11.22</span> The <span class="math inline">\(Q\)</span> Statistics</h2>
<p>Let’s try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<p>. . .</p>
<ul>
<li>clearly, in the presence of heterogeneity, the expected value of the Q statistics is higher (due to <span class="math inline">\(\lambda \neq 0\)</span>) and also residuals are larger (the <span class="math inline">\(\chi^2\)</span> is just a sum of squared weighted residuals)</li>
</ul>
<p>. . .</p>
<ul>
<li>we can calculate a p-value for deviation from the <span class="math inline">\(\tau^2 = 0\)</span> case as evidence agaist the absence of heterogeneity</li>
</ul></section><section id="i2-higgins2002-fh" class="level2" data-number="11.23"><h2 data-number="11.23" class="anchored" data-anchor-id="i2-higgins2002-fh">
<span class="header-section-number">11.23</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="chapter5.html#ref-Higgins2002-fh" role="doc-biblioref">Higgins &amp; Thompson, 2002</a>)</span>
</h2>
<p>We have two sources of variability in a random-effects meta-analysis, the sampling variability <span class="math inline">\(\sigma_i^2\)</span> and true heterogeneity <span class="math inline">\(\tau^2\)</span>. We can use the <span class="math inline">\(I^2\)</span> to express the interplay between the two. <span id="eq-i2"><span class="math display">\[
I^2 = 100\% \times \frac{\hat{\tau}^2}{\hat{\tau}^2 + \tilde{v}}
\tag{11.7}\]</span></span></p>
<p><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2},
\]</span></p>
<p>Where <span class="math inline">\(\tilde{v}\)</span> is the typical sampling variability. <span class="math inline">\(I^2\)</span> is intepreted as the proportion of total variability due to real heterogeneity (i.e., <span class="math inline">\(\tau^2\)</span>)</p>
</section><section id="i2-higgins2002-fh-1" class="level2" data-number="11.24"><h2 data-number="11.24" class="anchored" data-anchor-id="i2-higgins2002-fh-1">
<span class="header-section-number">11.24</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="chapter5.html#ref-Higgins2002-fh" role="doc-biblioref">Higgins &amp; Thompson, 2002</a>)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</h2>
<p>Note that we can have the same <span class="math inline">\(I^2\)</span> in two completely different meta-analysis. An high <span class="math inline">\(I^2\)</span> does not represent high heterogeneity. Let’s assume to have two meta-analysis with <span class="math inline">\(k\)</span> studies and small (<span class="math inline">\(n = 30\)</span>) vs large (<span class="math inline">\(n = 500\)</span>) sample sizes.</p>
<p>Let’s solve <a href="#eq-i2" class="quarto-xref">Equation&nbsp;<span>11.7</span></a> for <span class="math inline">\(\tau^2\)</span> (using <code><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">filor::tau2_from_I2()</a></code>) and we found that the same <span class="math inline">\(I^2\)</span> can be obtained with two completely different <span class="math inline">\(\tau^2\)</span> values:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">vi_1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span></span>
<span><span class="va">tau2_1</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_1</span><span class="op">)</span></span>
<span><span class="va">tau2_1</span></span>
<span><span class="co">#&gt; [1] 0.2666667</span></span>
<span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">vi_2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span></span>
<span><span class="va">tau2_2</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_2</span><span class="op">)</span></span>
<span><span class="va">tau2_2</span></span>
<span><span class="co">#&gt; [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="i2-higgins2002-fh-2" class="level2" data-number="11.25"><h2 data-number="11.25" class="anchored" data-anchor-id="i2-higgins2002-fh-2">
<span class="header-section-number">11.25</span> <span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="chapter5.html#ref-Higgins2002-fh" role="doc-biblioref">Higgins &amp; Thompson, 2002</a>)</span>
</h2>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">vi_1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span></span>
<span><span class="va">tau2_1</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_1</span><span class="op">)</span></span>
<span><span class="va">tau2_1</span></span>
<span><span class="co">#&gt; [1] 0.2666667</span></span>
<span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">vi_2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span></span>
<span><span class="va">tau2_2</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_2</span><span class="op">)</span></span>
<span><span class="va">tau2_2</span></span>
<span><span class="co">#&gt; [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>In other terms, the <span class="math inline">\(I^2\)</span> can be considered a good index of heterogeneity only when the total variance (<span class="math inline">\(\tilde{v} + \tau^2\)</span>) is similar.</p>
</section><section id="what-about-tildev" class="level2" data-number="11.26"><h2 data-number="11.26" class="anchored" data-anchor-id="what-about-tildev">
<span class="header-section-number">11.26</span> What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p><span class="math inline">\(\tilde{v}\)</span> is considered the “typical” within-study variability (see <a href="https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate">https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate</a>). There are different estimators but <a href="#eq-tildev" class="quarto-xref">Equation&nbsp;<span>11.8</span></a> is the most common.</p>
<p><span id="eq-tildev"><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2}
\tag{11.8}\]</span></span></p>
</section><section id="what-about-tildev-1" class="level2" data-number="11.27"><h2 data-number="11.27" class="anchored" data-anchor-id="what-about-tildev-1">
<span class="header-section-number">11.27</span> What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p>In the hypothetical case where <span class="math inline">\(\sigma^2_1 = \dots = \sigma^2_k\)</span>, <span class="math inline">\(\tilde{v}\)</span> is just <span class="math inline">\(\sigma^2\)</span>. This fact is commonly used to calculate the statistical power analytically <span class="citation" data-cites="Borenstein2009-mo">(<a href="chapter5.html#ref-Borenstein2009-mo" role="doc-biblioref">Borenstein et al., 2009, Chapter 29</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vtilde</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># same vi</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">30</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">30</span><span class="op">)</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667</span></span>
<span><span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06666667</span></span>
<span></span>
<span><span class="co"># heterogeneous vi</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu">sim_vi</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06389075</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="what-about-tildev-2" class="level2" data-number="11.28"><h2 data-number="11.28" class="anchored" data-anchor-id="what-about-tildev-2">
<span class="header-section-number">11.28</span> What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p>Using simulations we can see that <span class="math inline">\(\tilde{v}\)</span> with heterogenenous variances (i.e., sample sizes in this case) can be approximated by the central tendency of the sample size distribution. Note that we are fixing <span class="math inline">\(\sigma^2 = 1\)</span> thus we are not including uncertainty.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># number of studies</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># sample size</span></span>
<span></span>
<span><span class="va">vti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1e5</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1e5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ni</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">ni</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">ni</span></span>
<span>  <span class="va">vti</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># vtilde calculated from lambda</span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="h2" class="level2" data-number="11.29"><h2 data-number="11.29" class="anchored" data-anchor-id="h2">
<span class="header-section-number">11.29</span> <span class="math inline">\(H^2\)</span>
</h2>
<p>The <span class="math inline">\(H^2\)</span> is an alternative index of heterogeneity. Is calculated as:</p>
<p><span class="math display">\[
H^2 = \frac{Q}{k - 1}
\]</span></p>
<p>We defined <span class="math inline">\(Q\)</span> as the weighted sum of squares representing the total variability. <span class="math inline">\(k - 1\)</span> is the expected value of the <span class="math inline">\(\chi^2\)</span> statistics (i.e., sum of squares) when <span class="math inline">\(\tau^2 = 0\)</span> (or <span class="math inline">\(\lambda = 0\)</span>).</p>
<p>Thus <span class="math inline">\(H^2\)</span> is the ratio between total heterogeneity and sampling variability. Higher <span class="math inline">\(H^2\)</span> is associated with higher heterogeneity <strong>relative</strong> to the sampling variability. <span class="math inline">\(H^2\)</span> is not a measure of absolute heterogeneity.</p>
</section><section id="h2-1" class="level2" data-number="11.30"><h2 data-number="11.30" class="anchored" data-anchor-id="h2-1">
<span class="header-section-number">11.30</span> <span class="math inline">\(H^2\)</span>
</h2>
<p>When we are fitting a RE model, the <span class="math inline">\(I^2\)</span> and <span class="math inline">\(H^2\)</span> equations are slightly different <span class="citation" data-cites="Higgins2002-fh">(<a href="chapter5.html#ref-Higgins2002-fh" role="doc-biblioref">Higgins &amp; Thompson, 2002</a>)</span>. See also the <code>metafor</code> <a href="https://github.com/cran/metafor/blob/994d26a65455fac90760ad6a004ec1eaca5856b1/R/rma.uni.r#L2459C30-L2459C30">source code</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">mu</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">fit_re</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="va">fit_ee</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"EE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># H2 with EE model</span></span>
<span></span>
<span><span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># weighted.mean(dat$yi, 1/dat$vi)</span></span>
<span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Q</span>, <span class="va">fit_ee</span><span class="op">$</span><span class="va">QE</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">#&gt; [1] 350.1654 350.1654</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>H2 <span class="op">=</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">QE</span> <span class="op">/</span> <span class="op">(</span><span class="va">fit_ee</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">p</span><span class="op">)</span>, H2_model <span class="op">=</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">H2</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">#&gt;       H2 H2_model </span></span>
<span><span class="co">#&gt; 3.537024 3.537024</span></span>
<span></span>
<span><span class="co"># H2 with RE model</span></span>
<span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>H2 <span class="op">=</span> <span class="va">fit_re</span><span class="op">$</span><span class="va">tau2</span> <span class="op">/</span> <span class="va">vt</span> <span class="op">+</span> <span class="fl">1</span>, H2_model <span class="op">=</span> <span class="va">fit_re</span><span class="op">$</span><span class="va">H2</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">#&gt;       H2 H2_model </span></span>
<span><span class="co">#&gt; 3.495119 3.495119</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="confidence-intervals" class="level2" data-number="11.31"><h2 data-number="11.31" class="anchored" data-anchor-id="confidence-intervals">
<span class="header-section-number">11.31</span> Confidence Intervals</h2>
<p>What is reported in the model summary as <code>ci.lb</code> and <code>ci.ub</code> refers to the 95% confidence interval representing the uncertainty in estimating the effect (or a meta-regression parameter).</p>
<p>Without looking at the equations, let’s try to implement this idea using simulations.</p>
<ul>
<li>choose <span class="math inline">\(k\)</span>, <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(n\)</span>
</li>
<li>simulate data (several times) accordingly and fit the RE model</li>
<li>extract the estimated effect size</li>
<li>compare the simulated sampling distribution with the analytical result</li>
</ul></section><section id="confidence-intervals-1" class="level2" data-number="11.32"><h2 data-number="11.32" class="anchored" data-anchor-id="confidence-intervals-1">
<span class="header-section-number">11.32</span> Confidence Intervals</h2>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5e3</span></span>
<span></span>
<span><span class="co"># true parameters (see Borenstein, 2009; Chapter 29)</span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">vt</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">/</span> <span class="va">k</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">mu</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span>  <span class="va">mui</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mui</span><span class="op">)</span>, analytical <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">#&gt;  simulated analytical </span></span>
<span><span class="co">#&gt; 0.06322640 0.06508356</span></span>
<span></span>
<span><span class="co"># confidence interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>  <span class="st">"simulated"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">mui</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"analytical"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2.5%"</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ci.lb</span>, <span class="st">"97.5%"</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ci.ub</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;                   5%     97.5%</span></span>
<span><span class="co">#&gt; simulated  0.3958958 0.6226868</span></span>
<span><span class="co">#&gt; analytical 0.3721610 0.6272838</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="confidence-intervals-2" class="level2" data-number="11.33"><h2 data-number="11.33" class="anchored" data-anchor-id="confidence-intervals-2">
<span class="header-section-number">11.33</span> Confidence Intervals</h2>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mui</span>, breaks <span class="op">=</span> <span class="fl">50</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Sampling Distribution"</span>, xlab <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\mu_{\\theta}$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span>, <span class="va">se</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="confidence-intervals-3" class="level2" data-number="11.34"><h2 data-number="11.34" class="anchored" data-anchor-id="confidence-intervals-3">
<span class="header-section-number">11.34</span> Confidence Intervals</h2>
<p>Now the equation for the 95% confidence interval should be more clear. The standard error is a function of the within study sampling variances (depending mainly on <span class="math inline">\(n\)</span>), <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(k\)</span>. As we increase <span class="math inline">\(k\)</span> the standard error tends towards zero.</p>
<p><span class="math display">\[
CI = \hat \mu_{\theta} \pm z SE_{\mu_{\theta}}
\]</span></p>
<p><span class="math display">\[
SE_{\mu_{\theta}} = \sqrt{\frac{1}{\sum^{k}_{i = 1}w^{\star}_i}}
\]</span></p>
<p><span class="math display">\[
w^{\star}_i = \frac{1}{\sigma^2_i + \tau^2}
\]</span></p>
</section><section id="confidence-intervals-4" class="level2" data-number="11.35"><h2 data-number="11.35" class="anchored" data-anchor-id="confidence-intervals-4">
<span class="header-section-number">11.35</span> Confidence Intervals</h2>
<p>We can also see it analytically, there is a huge impact of <span class="math inline">\(k\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># true parameters (see Borenstein, 2009; Chapter 29)</span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">vt</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">/</span> <span class="va">k</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, n <span class="op">=</span> <span class="va">n</span>, tau2 <span class="op">=</span> <span class="va">tau2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dd</span>, <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dd</span>, <span class="op">(</span><span class="va">vt</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">/</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">vs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu">as_tex_label</span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">k</span>, <span class="st">"$k = %s$"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dd</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">se</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">k</span>, labeller <span class="op">=</span> <span class="va">label_parsed</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"\\tau^2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Sample Size (n)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$SE_{\\mu_{\\theta}}$"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter5_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="prediction-intervals-pi" class="level2" data-number="11.36"><h2 data-number="11.36" class="anchored" data-anchor-id="prediction-intervals-pi">
<span class="header-section-number">11.36</span> Prediction intervals (PI)</h2>
<p>We could say that the CI is not completely taking into account the between-study heterogeneity (<span class="math inline">\(\tau^2\)</span>). After a meta-analysis we would like to know how confident we are in the parameters estimation BUT also <strong>what would be the expected effect running a new experiment tomorrow?</strong>.</p>
<p>The <strong>prediction interval</strong> <span class="citation" data-cites="IntHout2016-sz Riley2011-hp">(<a href="chapter5.html#ref-IntHout2016-sz" role="doc-biblioref">IntHout et al., 2016</a>; <a href="chapter5.html#ref-Riley2011-hp" role="doc-biblioref">Riley et al., 2011</a>)</span> is exactly the range of effects that I expect in predicting a new study.</p>
</section><section id="pi-for-a-sample-mean" class="level2" data-number="11.37"><h2 data-number="11.37" class="anchored" data-anchor-id="pi-for-a-sample-mean">
<span class="header-section-number">11.37</span> PI for a sample mean</h2>
<p>To understand the concept, let’s assume to have a sample <span class="math inline">\(X\)</span> of size <span class="math inline">\(n\)</span> and we estimate the mean <span class="math inline">\(\overline X\)</span>. The PI is calculated as<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>:</p>
<p><span class="math display">\[
PI = \overline X \pm t_{\alpha/2} s_x \sqrt{1 + \frac{1}{n}}
\]</span></p>
<p>Where <span class="math inline">\(s\)</span> is the sample standard deviation. Basically we are combining the uncertainty in estimating <span class="math inline">\(\overline X\)</span> (i.e, <span class="math inline">\(\frac{s_x}{n}\)</span>) with the standard deviation of the data <span class="math inline">\(s_x\)</span>. Compare it with the confidence interval containing only <span class="math inline">\(\frac{s_x}{n}\)</span>.</p>
</section><section id="pi-in-meta-analysis" class="level2" data-number="11.38"><h2 data-number="11.38" class="anchored" data-anchor-id="pi-in-meta-analysis">
<span class="header-section-number">11.38</span> PI in meta-analysis</h2>
<p>For meta-analysis the equation<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is conceptually similar but with different quantities.</p>
<p><span class="math display">\[
PI = \hat \mu_{\theta} \pm z \sqrt{\tau^2 + SE_{\mu_{\theta}}}
\]</span></p>
<p>Basically we are combining all the sources of uncertainty. As long as <span class="math inline">\(\tau^2 \neq 0\)</span> the PI is greater than the CI (in the EE model they are the same). Thus even with very precise <span class="math inline">\(\mu_{\theta}\)</span> estimation, large <span class="math inline">\(\tau^2\)</span> leads to uncertain predictions.</p>
</section><section id="pi-in-meta-analysis-1" class="level2" data-number="11.39"><h2 data-number="11.39" class="anchored" data-anchor-id="pi-in-meta-analysis-1">
<span class="header-section-number">11.39</span> PI in meta-analysis</h2>
<p>In R the PI can be calculated using <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>. By default the model assume a standard normal distribution thus using <span class="math inline">\(z\)</span> scores. To use the <span class="citation" data-cites="Riley2011-hp">Riley et al. (<a href="chapter5.html#ref-Riley2011-hp" role="doc-biblioref">2011</a>)</span> approach (<span class="math inline">\(t\)</span> distribution) the model need to be fitted using <code>test = "t"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0.1</span>, n1 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">fit_z</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, test <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span> <span class="co"># test = "z" is the default</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_z</span><span class="op">)</span> <span class="co"># notice pi.ub/pi.lb vs ci.ub/ci.lb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    pred     se  ci.lb  ci.ub   pi.lb  pi.ub </span></span>
<span><span class="co">#&gt;  0.4423 0.0424 0.3592 0.5254 -0.2299 1.1145</span></span>
<span><span class="co"># manually</span></span>
<span><span class="va">fit_z</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fit_z</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">fit_z</span><span class="op">$</span><span class="va">tau2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.229882  1.114516</span></span>
<span></span>
<span><span class="va">fit_t</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, test <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_t</span><span class="op">)</span> <span class="co"># notice pi.ub/pi.lb vs ci.ub/ci.lb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    pred     se  ci.lb  ci.ub   pi.lb  pi.ub </span></span>
<span><span class="co">#&gt;  0.4423 0.0424 0.3582 0.5265 -0.2382 1.1228</span></span>
<span><span class="co"># manually</span></span>
<span><span class="va">fit_z</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="va">k</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fit_t</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">fit_t</span><span class="op">$</span><span class="va">tau2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.2382858  1.1229198</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="references-download-.bib-file" class="level2 refs" data-number="11.40"><h2 class="refs anchored" data-number="11.40" data-anchor-id="references-download-.bib-file">
<span class="header-section-number">11.40</span> References <button class="btn"><i class="fa fa-download"></i><a href="data:text/x-bibtex;base64,QEFSVElDTEV7VmllY2h0YmF1ZXIyMDA1LXp0LAogIHRpdGxlID0ge0JpYXMgYW5kIGVmZmljaWVuY3kgb2YgbWV0YS1hbmFseXRpYyB2YXJpYW5jZSBlc3RpbWF0b3JzIGluIHRoZQogIHJhbmRvbS1lZmZlY3RzIG1vZGVsfSwKICBhdXRob3IgPSB7VmllY2h0YmF1ZXIsIFdvbGZnYW5nfSwKICBqb3VybmFsdGl0bGUgPSB7Sm91cm5hbCBvZiBlZHVjYXRpb25hbCBhbmQgYmVoYXZpb3JhbCBzdGF0aXN0aWNzOiBhIHF1YXJ0ZXJseQogIHB1YmxpY2F0aW9uIHNwb25zb3JlZCBieSB0aGUgQW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gYW5kIHRoZQogIEFtZXJpY2FuIFN0YXRpc3RpY2FsIEFzc29jaWF0aW9ufSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gRWR1Y2F0aW9uYWwgUmVzZWFyY2ggQXNzb2NpYXRpb24gKEFFUkEpfSwKICB2b2x1bWUgPSB7MzB9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezI2MS0yOTN9LAogIGRhdGUgPSB7MjAwNS0wOX0sCiAgZG9pID0gezEwLjMxMDIvMTA3Njk5ODYwMzAwMDMyNjF9LAogIGlzc24gPSB7MTA3Ni05OTg2LDE5MzUtMTA1NH0sCiAgYWJzdHJhY3QgPSB7VGhlIG1ldGEtYW5hbHl0aWMgcmFuZG9tIGVmZmVjdHMgbW9kZWwgYXNzdW1lcyB0aGF0IHRoZQogIHZhcmlhYmlsaXR5IGluIGVmZmVjdCBzaXplIGVzdGltYXRlcyBkcmF3biBmcm9tIGEgc2V0IG9mIHN0dWRpZXMgY2FuIGJlCiAgZGVjb21wb3NlZCBpbnRvIHR3byBwYXJ0czogaGV0ZXJvZ2VuZWl0eSBkdWUgdG8gcmFuZG9tIHBvcHVsYXRpb24gZWZmZWN0cyBhbmQKICBzYW1wbGluZyB2YXJpYW5jZS4gSW4gdGhpcyBjb250ZXh0LCB0aGUgdXN1YWwgZ29hbCBpcyB0byBlc3RpbWF0ZSB0aGUgY2VudHJhbAogIHRlbmRlbmN5IGFuZCB0aGUgYW1vdW50IG9mIGhldGVyb2dlbmVpdHkgaW4gdGhlIHBvcHVsYXRpb24gZWZmZWN0IHNpemVzLiBUaGUKICBhbW91bnQgb2YgaGV0ZXJvZ2VuZWl0eSBpbiBhIHNldCBvZiBlZmZlY3Qgc2l6ZXMgaGFzIGltcGxpY2F0aW9ucyByZWdhcmRpbmcKICB0aGUgaW50ZXJwcmV0YXRpb24gb2YgdGhlIG1ldGEtYW5hbHl0aWMgZmluZGluZ3MgYW5kIG9mdGVuIHNlcnZlcyBhcyBhbgogIGluZGljYXRvciBmb3IgdGhlIHByZXNlbmNlIG9mIHBvdGVudGlhbCBtb2RlcmF0b3IgdmFyaWFibGVzLiBGaXZlIHBvcHVsYXRpb24KICBoZXRlcm9nZW5laXR5IGVzdGltYXRvcnMgd2VyZSBjb21wYXJlZCBpbiB0aGlzIGFydGljbGUgYW5hbHl0aWNhbGx5IGFuZCB2aWEKICBNb250ZSBDYXJsbyBzaW11bGF0aW9ucyB3aXRoIHJlc3BlY3QgdG8gdGhlaXIgYmlhcyBhbmQgZWZmaWNpZW5jeS59LAogIHVybCA9IHtodHRwczovL3NjaG9sYXIuZ29vZ2xlLmNvbS9jaXRhdGlvbnM/dmlld19vcD12aWV3X2NpdGF0aW9uJmhsPWVuJnVzZXI9Sjg5UlhKa0FBQUFKJmNpdGF0aW9uX2Zvcl92aWV3PUo4OVJYSmtBQUFBSjpxak1ha0ZIRHk3c0N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQk9PS3tIYXJyZXIyMDIxLWdvLAogIHRpdGxlID0ge0RvaW5nIG1ldGEtYW5hbHlzaXMgd2l0aCBSOiBBIGhhbmRzLW9uIGd1aWRlfSwKICBhdXRob3IgPSB7SGFycmVyLCBNYXRoaWFzIGFuZCBDdWlqcGVycywgUGltIGFuZCBGdXJ1a2F3YSwgVG9zaGkgYW5kIEViZXJ0LAogIERhdmlkfSwKICBwdWJsaXNoZXIgPSB7Q1JDIFByZXNzfSwKICBsb2NhdGlvbiA9IHtMb25kb24sIEVuZ2xhbmR9LAogIGVkaXRpb24gPSB7MXN0fSwKICBkYXRlID0gezIwMjEtMDktMTN9LAogIHBhZ2V0b3RhbCA9IHs0NzR9LAogIGlzYm4gPSB7OTc4MDM2NzYxMDA3NH0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe1Zlcm9uaWtpMjAxNi1udywKICB0aXRsZSA9IHtNZXRob2RzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlIGFuZCBpdHMgdW5jZXJ0YWludHkgaW4KICBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7VmVyb25pa2ksIEFyZXRpIEFuZ2VsaWtpIGFuZCBKYWNrc29uLCBEYW4gYW5kIFZpZWNodGJhdWVyLCBXb2xmZ2FuZwogIGFuZCBCZW5kZXIsIFJhbGYgYW5kIEJvd2RlbiwgSmFjayBhbmQgS25hcHAsIEd1aWRvIGFuZCBLdXNzLCBPbGl2ZXIgYW5kCiAgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgTGFuZ2FuLCBEZWFuIGFuZCBTYWxhbnRpLCBHZW9yZ2lhfSwKICBqb3VybmFsdGl0bGUgPSB7UmVzZWFyY2ggc3ludGhlc2lzIG1ldGhvZHN9LAogIHB1Ymxpc2hlciA9IHtXaWxleX0sCiAgdm9sdW1lID0gezd9LAogIGlzc3VlID0gezF9LAogIHBhZ2VzID0gezU1LTc5fSwKICBkYXRlID0gezIwMTYtMDN9LAogIGRvaSA9IHsxMC4xMDAyL2pyc20uMTE2NH0sCiAgcG1jID0ge1BNQzQ5NTAwMzB9LAogIHBtaWQgPSB7MjYzMzIxNDR9LAogIGlzc24gPSB7MTc1OS0yODc5LDE3NTktMjg4N30sCiAgYWJzdHJhY3QgPSB7TWV0YS1hbmFseXNlcyBhcmUgdHlwaWNhbGx5IHVzZWQgdG8gZXN0aW1hdGUgdGhlIG92ZXJhbGwvbWVhbiBvZgogIGFuIG91dGNvbWUgb2YgaW50ZXJlc3QuIEhvd2V2ZXIsIGluZmVyZW5jZSBhYm91dCBiZXR3ZWVuLXN0dWR5IHZhcmlhYmlsaXR5LAogIHdoaWNoIGlzIHR5cGljYWxseSBtb2RlbGxlZCB1c2luZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgcGFyYW1ldGVyLCBpcwogIHVzdWFsbHkgYW4gYWRkaXRpb25hbCBhaW0uIFRoZSBEZXJTaW1vbmlhbiBhbmQgTGFpcmQgbWV0aG9kLCBjdXJyZW50bHkgd2lkZWx5CiAgdXNlZCBieSBkZWZhdWx0IHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLCBoYXMgYmVlbiBsb25nCiAgY2hhbGxlbmdlZC4gT3VyIGFpbSBpcyB0byBpZGVudGlmeSBrbm93biBtZXRob2RzIGZvciBlc3RpbWF0aW9uIG9mIHRoZQogIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyBjb3JyZXNwb25kaW5nIHVuY2VydGFpbnR5LCBhbmQgdG8gc3VtbWFyaXNlIHRoZQogIHNpbXVsYXRpb24gYW5kIGVtcGlyaWNhbCBldmlkZW5jZSB0aGF0IGNvbXBhcmVzIHRoZW0uIFdlIGlkZW50aWZpZWQgMTYKICBlc3RpbWF0b3JzIGZvciB0aGUgYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSwgc2V2ZW4gbWV0aG9kcyB0byBjYWxjdWxhdGUKICBjb25maWRlbmNlIGludGVydmFscywgYW5kIHNldmVyYWwgY29tcGFyYXRpdmUgc3R1ZGllcy4gU2ltdWxhdGlvbiBzdHVkaWVzCiAgc3VnZ2VzdCB0aGF0IGZvciBib3RoIGRpY2hvdG9tb3VzIGFuZCBjb250aW51b3VzIGRhdGEgdGhlIGVzdGltYXRvciBwcm9wb3NlZAogIGJ5IFBhdWxlIGFuZCBNYW5kZWwgYW5kIGZvciBjb250aW51b3VzIGRhdGEgdGhlIHJlc3RyaWN0ZWQgbWF4aW11bSBsaWtlbGlob29kCiAgZXN0aW1hdG9yIGFyZSBiZXR0ZXIgYWx0ZXJuYXRpdmVzIHRvIGVzdGltYXRlIHRoZSBiZXR3ZWVuLXN0dWR5IHZhcmlhbmNlLgogIEJhc2VkIG9uIHRoZSBzY2VuYXJpb3MgYW5kIHJlc3VsdHMgcHJlc2VudGVkIGluIHRoZSBwdWJsaXNoZWQgc3R1ZGllcywgd2UKICByZWNvbW1lbmQgdGhlIFEtcHJvZmlsZSBtZXRob2QgYW5kIHRoZSBhbHRlcm5hdGl2ZSBhcHByb2FjaCBiYXNlZCBvbiBhCiAgJ2dlbmVyYWxpc2VkIENvY2hyYW4gYmV0d2Vlbi1zdHVkeSB2YXJpYW5jZSBzdGF0aXN0aWMnIHRvIGNvbXB1dGUKICBjb3JyZXNwb25kaW5nIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGFyb3VuZCB0aGUgcmVzdWx0aW5nIGVzdGltYXRlcy4gT3VyCiAgcmVjb21tZW5kYXRpb25zIGFyZSBiYXNlZCBvbiBhIHF1YWxpdGF0aXZlIGV2YWx1YXRpb24gb2YgdGhlIGV4aXN0aW5nCiAgbGl0ZXJhdHVyZSBhbmQgZXhwZXJ0IGNvbnNlbnN1cy4gRXZpZGVuY2UtYmFzZWQgcmVjb21tZW5kYXRpb25zIHJlcXVpcmUgYW4KICBleHRlbnNpdmUgc2ltdWxhdGlvbiBzdHVkeSB3aGVyZSBhbGwgbWV0aG9kcyB3b3VsZCBiZSBjb21wYXJlZCB1bmRlciB0aGUgc2FtZQogIHNjZW5hcmlvcy59LAogIHVybCA9IHtodHRwczovL29ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS8xMC4xMDAyL2pyc20uMTE2NH0sCiAgZmlsZSA9IHtWZXJvbmlraSBldCBhbC4gMjAxNiAtIE1ldGhvZHMgdG8gZXN0aW1hdGUgdGhlIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UgYW5kIGl0cyB1bmNlcnRhaW50eSBpbiBtZXRhLWFuYWx5c2lzLnBkZn0sCiAga2V5d29yZHMgPSB7YmlhczsgY29uZmlkZW5jZSBpbnRlcnZhbDsgY292ZXJhZ2UgcHJvYmFiaWxpdHk7IGhldGVyb2dlbmVpdHk7CiAgbWVhbiBzcXVhcmVkIGVycm9yfSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQE1JU0N7Qm9yZW5zdGVpbjIwMDktbW8sCiAgdGl0bGUgPSB7SW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfX0sCiAgYXV0aG9yID0ge0JvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICBSb3Roc3RlaW4sIEhhbm5haCBSfSwKICBkYXRlID0gezIwMDl9LAogIGRvaSA9IHsxMC4xMDAyLzk3ODA0NzA3NDMzODZ9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyLzk3ODA0NzA3NDMzODZ9Cn0KCkBBUlRJQ0xFe1JpbGV5MjAxMS1ocCwKICB0aXRsZSA9IHtJbnRlcnByZXRhdGlvbiBvZiByYW5kb20gZWZmZWN0cyBtZXRhLWFuYWx5c2VzfSwKICBhdXRob3IgPSB7UmlsZXksIFJpY2hhcmQgRCBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQgRGVla3MsIEpvbmF0aGFuIEp9LAogIGpvdXJuYWx0aXRsZSA9IHtCTUp9LAogIHZvbHVtZSA9IHszNDJ9LAogIHBhZ2VzID0ge2Q1NDl9LAogIGRhdGUgPSB7MjAxMS0wMi0xMH0sCiAgZG9pID0gezEwLjExMzYvYm1qLmQ1NDl9LAogIHBtaWQgPSB7MjEzMTA3OTR9LAogIGlzc24gPSB7MDk1OS04MTM4LDE3NTYtMTgzM30sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qLmQ1NDl9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtJbnRIb3V0MjAxNi1zeiwKICB0aXRsZSA9IHtQbGVhIGZvciByb3V0aW5lbHkgcHJlc2VudGluZyBwcmVkaWN0aW9uIGludGVydmFscyBpbiBtZXRhLWFuYWx5c2lzfSwKICBhdXRob3IgPSB7SW50SG91dCwgSm9hbm5hIGFuZCBJb2FubmlkaXMsIEpvaG4gUCBBIGFuZCBSb3ZlcnMsIE1hcm9lc2thIE0gYW5kCiAgR29lbWFuLCBKZWxsZSBKfSwKICBqb3VybmFsdGl0bGUgPSB7Qk1KIG9wZW59LAogIHZvbHVtZSA9IHs2fSwKICBpc3N1ZSA9IHs3fSwKICBwYWdlcyA9IHtlMDEwMjQ3fSwKICBkYXRlID0gezIwMTYtMDctMTJ9LAogIGRvaSA9IHsxMC4xMTM2L2Jtam9wZW4tMjAxNS0wMTAyNDd9LAogIHBtYyA9IHtQTUM0OTQ3NzUxfSwKICBwbWlkID0gezI3NDA2NjM3fSwKICBpc3NuID0gezIwNDQtNjA1NX0sCiAgYWJzdHJhY3QgPSB7T0JKRUNUSVZFUzogRXZhbHVhdGluZyB0aGUgdmFyaWF0aW9uIGluIHRoZSBzdHJlbmd0aCBvZiB0aGUgZWZmZWN0CiAgYWNyb3NzIHN0dWRpZXMgaXMgYSBrZXkgZmVhdHVyZSBvZiBtZXRhLWFuYWx5c2VzLiBUaGlzIHZhcmlhYmlsaXR5IGlzCiAgcmVmbGVjdGVkIGJ5IG1lYXN1cmVzIGxpa2Ugz4QoMikgb3IgSSgyKSwgYnV0IHRoZWlyIGNsaW5pY2FsIGludGVycHJldGF0aW9uIGlzCiAgbm90IHN0cmFpZ2h0Zm9yd2FyZC4gQSBwcmVkaWN0aW9uIGludGVydmFsIGlzIGxlc3MgY29tcGxpY2F0ZWQ6IGl0IHByZXNlbnRzCiAgdGhlIGV4cGVjdGVkIHJhbmdlIG9mIHRydWUgZWZmZWN0cyBpbiBzaW1pbGFyIHN0dWRpZXMuIFdlIGFpbWVkIHRvIHNob3cgdGhlCiAgYWR2YW50YWdlcyBvZiBoYXZpbmcgdGhlIHByZWRpY3Rpb24gaW50ZXJ2YWwgcm91dGluZWx5IHJlcG9ydGVkIGluCiAgbWV0YS1hbmFseXNlcy4gREVTSUdOOiBXZSBzaG93IGhvdyB0aGUgcHJlZGljdGlvbiBpbnRlcnZhbCBjYW4gaGVscCB1bmRlcnN0YW5kCiAgdGhlIHVuY2VydGFpbnR5IGFib3V0IHdoZXRoZXIgYW4gaW50ZXJ2ZW50aW9uIHdvcmtzIG9yIG5vdC4gVG8gZXZhbHVhdGUgdGhlCiAgaW1wbGljYXRpb25zIG9mIHVzaW5nIHRoaXMgaW50ZXJ2YWwgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHRzLCB3ZSBzZWxlY3RlZCB0aGUKICBmaXJzdCBtZXRhLWFuYWx5c2lzIHBlciBpbnRlcnZlbnRpb24gcmV2aWV3IG9mIHRoZSBDb2NocmFuZSBEYXRhYmFzZSBvZgogIFN5c3RlbWF0aWMgUmV2aWV3cyBJc3N1ZXMgMjAwOS0yMDEzIHdpdGggYSBkaWNob3RvbW91cyAobj0yMDA5KSBvciBjb250aW51b3VzCiAgKG49MTI1NCkgb3V0Y29tZSwgYW5kIGdlbmVyYXRlZCA5NVwlIHByZWRpY3Rpb24gaW50ZXJ2YWxzIGZvciB0aGVtLiBSRVNVTFRTOgogIEluIDcyLjRcJSBvZiA0Nzkgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudCAocmFuZG9tLWVmZmVjdHMgcDApLCB0aGUgOTVcJQogIHByZWRpY3Rpb24gaW50ZXJ2YWwgc3VnZ2VzdGVkIHRoYXQgdGhlIGludGVydmVudGlvbiBlZmZlY3QgY291bGQgYmUgbnVsbCBvcgogIGV2ZW4gYmUgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbi4gSW4gMjAuM1wlIG9mIHRob3NlIDQ3OSBtZXRhLWFuYWx5c2VzLCB0aGUKICBwcmVkaWN0aW9uIGludGVydmFsIHNob3dlZCB0aGF0IHRoZSBlZmZlY3QgY291bGQgYmUgY29tcGxldGVseSBvcHBvc2l0ZSB0byB0aGUKICBwb2ludCBlc3RpbWF0ZSBvZiB0aGUgbWV0YS1hbmFseXNpcy4gV2UgZGVtb25zdHJhdGUgYWxzbyBob3cgdGhlIHByZWRpY3Rpb24KICBpbnRlcnZhbCBjYW4gYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIHByb2JhYmlsaXR5IHRoYXQgYSBuZXcgdHJpYWwgd2lsbCBzaG93IGEKICBuZWdhdGl2ZSBlZmZlY3QgYW5kIHRvIGltcHJvdmUgdGhlIGNhbGN1bGF0aW9ucyBvZiB0aGUgcG93ZXIgb2YgYSBuZXcgdHJpYWwuCiAgQ09OQ0xVU0lPTlM6IFRoZSBwcmVkaWN0aW9uIGludGVydmFsIHJlZmxlY3RzIHRoZSB2YXJpYXRpb24gaW4gdHJlYXRtZW50CiAgZWZmZWN0cyBvdmVyIGRpZmZlcmVudCBzZXR0aW5ncywgaW5jbHVkaW5nIHdoYXQgZWZmZWN0IGlzIHRvIGJlIGV4cGVjdGVkIGluCiAgZnV0dXJlIHBhdGllbnRzLCBzdWNoIGFzIHRoZSBwYXRpZW50cyB0aGF0IGEgY2xpbmljaWFuIGlzIGludGVyZXN0ZWQgdG8gdHJlYXQuCiAgUHJlZGljdGlvbiBpbnRlcnZhbHMgc2hvdWxkIGJlIHJvdXRpbmVseSByZXBvcnRlZCB0byBhbGxvdyBtb3JlIGluZm9ybWF0aXZlCiAgaW5mZXJlbmNlcyBpbiBtZXRhLWFuYWx5c2VzLn0sCiAgdXJsID0ge2h0dHA6Ly9keC5kb2kub3JnLzEwLjExMzYvYm1qb3Blbi0yMDE1LTAxMDI0N30sCiAga2V5d29yZHMgPSB7Q2xpbmljYWwgdHJpYWw7IENvY2hyYW5lIERhdGFiYXNlIG9mIFN5c3RlbWF0aWMgUmV2aWV3czsKICBIZXRlcm9nZW5laXR5OyBNZXRhLWFuYWx5c2lzOyBQcmVkaWN0aW9uIGludGVydmFsOyBSYW5kb20gZWZmZWN0cztCYXllc2lhbgogIFN0YXRpc3RpY3N9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtIaWdnaW5zMjAwMi1maCwKICB0aXRsZSA9IHtRdWFudGlmeWluZyBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpc30sCiAgYXV0aG9yID0ge0hpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHfSwKICBqb3VybmFsdGl0bGUgPSB7U3RhdGlzdGljcyBpbiBtZWRpY2luZX0sCiAgdm9sdW1lID0gezIxfSwKICBpc3N1ZSA9IHsxMX0sCiAgcGFnZXMgPSB7MTUzOS0xNTU4fSwKICBkYXRlID0gezIwMDItMDYtMTV9LAogIGRvaSA9IHsxMC4xMDAyL3NpbS4xMTg2fSwKICBwbWlkID0gezEyMTExOTE5fSwKICBpc3NuID0gezAyNzctNjcxNX0sCiAgYWJzdHJhY3QgPSB7VGhlIGV4dGVudCBvZiBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpcyBwYXJ0bHkgZGV0ZXJtaW5lcwogIHRoZSBkaWZmaWN1bHR5IGluIGRyYXdpbmcgb3ZlcmFsbCBjb25jbHVzaW9ucy4gVGhpcyBleHRlbnQgbWF5IGJlIG1lYXN1cmVkIGJ5CiAgZXN0aW1hdGluZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UsIGJ1dCBpbnRlcnByZXRhdGlvbiBpcyB0aGVuIHNwZWNpZmljIHRvIGEKICBwYXJ0aWN1bGFyIHRyZWF0bWVudCBlZmZlY3QgbWV0cmljLiBBIHRlc3QgZm9yIHRoZSBleGlzdGVuY2Ugb2YgaGV0ZXJvZ2VuZWl0eQogIGV4aXN0cywgYnV0IGRlcGVuZHMgb24gdGhlIG51bWJlciBvZiBzdHVkaWVzIGluIHRoZSBtZXRhLWFuYWx5c2lzLiBXZSBkZXZlbG9wCiAgbWVhc3VyZXMgb2YgdGhlIGltcGFjdCBvZiBoZXRlcm9nZW5laXR5IG9uIGEgbWV0YS1hbmFseXNpcywgZnJvbSBtYXRoZW1hdGljYWwKICBjcml0ZXJpYSwgdGhhdCBhcmUgaW5kZXBlbmRlbnQgb2YgdGhlIG51bWJlciBvZiBzdHVkaWVzIGFuZCB0aGUgdHJlYXRtZW50CiAgZWZmZWN0IG1ldHJpYy4gV2UgZGVyaXZlIGFuZCBwcm9wb3NlIHRocmVlIHN1aXRhYmxlIHN0YXRpc3RpY3M6IEggaXMgdGhlCiAgc3F1YXJlIHJvb3Qgb2YgdGhlIGNoaTIgaGV0ZXJvZ2VuZWl0eSBzdGF0aXN0aWMgZGl2aWRlZCBieSBpdHMgZGVncmVlcyBvZgogIGZyZWVkb207IFIgaXMgdGhlIHJhdGlvIG9mIHRoZSBzdGFuZGFyZCBlcnJvciBvZiB0aGUgdW5kZXJseWluZyBtZWFuIGZyb20gYQogIHJhbmRvbSBlZmZlY3RzIG1ldGEtYW5hbHlzaXMgdG8gdGhlIHN0YW5kYXJkIGVycm9yIG9mIGEgZml4ZWQgZWZmZWN0CiAgbWV0YS1hbmFseXRpYyBlc3RpbWF0ZSwgYW5kIEkyIGlzIGEgdHJhbnNmb3JtYXRpb24gb2YgKEgpIHRoYXQgZGVzY3JpYmVzIHRoZQogIHByb3BvcnRpb24gb2YgdG90YWwgdmFyaWF0aW9uIGluIHN0dWR5IGVzdGltYXRlcyB0aGF0IGlzIGR1ZSB0byBoZXRlcm9nZW5laXR5LgogIFdlIGRpc2N1c3MgaW50ZXJwcmV0YXRpb24sIGludGVydmFsIGVzdGltYXRlcyBhbmQgb3RoZXIgcHJvcGVydGllcyBvZiB0aGVzZQogIG1lYXN1cmVzIGFuZCBleGFtaW5lIHRoZW0gaW4gZml2ZSBleGFtcGxlIGRhdGEgc2V0cyBzaG93aW5nIGRpZmZlcmVudCBhbW91bnRzCiAgb2YgaGV0ZXJvZ2VuZWl0eS4gV2UgY29uY2x1ZGUgdGhhdCBIIGFuZCBJMiwgd2hpY2ggY2FuIHVzdWFsbHkgYmUgY2FsY3VsYXRlZAogIGZvciBwdWJsaXNoZWQgbWV0YS1hbmFseXNlcywgYXJlIHBhcnRpY3VsYXJseSB1c2VmdWwgc3VtbWFyaWVzIG9mIHRoZSBpbXBhY3QKICBvZiBoZXRlcm9nZW5laXR5LiBPbmUgb3IgYm90aCBzaG91bGQgYmUgcHJlc2VudGVkIGluIHB1Ymxpc2hlZCBtZXRhLWFuYWx5c2VzCiAgaW4gcHJlZmVyZW5jZSB0byB0aGUgdGVzdCBmb3IgaGV0ZXJvZ2VuZWl0eS59LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyL3NpbS4xMTg2fSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQEFSVElDTEV7SGVkZ2VzMTk4OS1pcCwKICB0aXRsZSA9IHtBbiB1bmJpYXNlZCBjb3JyZWN0aW9uIGZvciBzYW1wbGluZyBlcnJvciBpbiB2YWxpZGl0eSBnZW5lcmFsaXphdGlvbgogIHN0dWRpZXN9LAogIGF1dGhvciA9IHtIZWRnZXMsIExhcnJ5IFZ9LAogIGpvdXJuYWx0aXRsZSA9IHtUaGUgSm91cm5hbCBvZiBhcHBsaWVkIHBzeWNob2xvZ3l9LAogIHB1Ymxpc2hlciA9IHtBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpfSwKICB2b2x1bWUgPSB7NzR9LAogIGlzc3VlID0gezN9LAogIHBhZ2VzID0gezQ2OS00Nzd9LAogIGRhdGUgPSB7MTk4OS0wNn0sCiAgZG9pID0gezEwLjEwMzcvMDAyMS05MDEwLjc0LjMuNDY5fSwKICBpc3NuID0gezAwMjEtOTAxMCwxOTM5LTE4NTR9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDM3LzAwMjEtOTAxMC43NC4zLjQ2OX0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe0hlZGdlczIwMTktcnksCiAgdGl0bGUgPSB7U3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uOiBNZXRhLWFuYWx5dGljCiAgcGVyc3BlY3RpdmVzfSwKICBhdXRob3IgPSB7SGVkZ2VzLCBMYXJyeSBWIGFuZCBTY2hhdWVyLCBKYWNvYiBNfSwKICBqb3VybmFsdGl0bGUgPSB7UHN5Y2hvbG9naWNhbCBtZXRob2RzfSwKICBwdWJsaXNoZXIgPSB7QW1lcmljYW4gUHN5Y2hvbG9naWNhbCBBc3NvY2lhdGlvbiAoQVBBKX0sCiAgdm9sdW1lID0gezI0fSwKICBpc3N1ZSA9IHs1fSwKICBwYWdlcyA9IHs1NTctNTcwfSwKICBkYXRlID0gezIwMTktMTB9LAogIGRvaSA9IHsxMC4xMDM3L21ldDAwMDAxODl9LAogIHBtaWQgPSB7MzAwNzA1NDd9LAogIGlzc24gPSB7MTA4Mi05ODlYLDE5MzktMTQ2M30sCiAgYWJzdHJhY3QgPSB7Rm9ybWFsIGVtcGlyaWNhbCBhc3Nlc3NtZW50cyBvZiByZXBsaWNhdGlvbiBoYXZlIHJlY2VudGx5IGJlY29tZQogIG1vcmUgcHJvbWluZW50IGluIHNldmVyYWwgYXJlYXMgb2Ygc2NpZW5jZSwgaW5jbHVkaW5nIHBzeWNob2xvZ3kuIFRoZXNlCiAgYXNzZXNzbWVudHMgaGF2ZSB1c2VkIGRpZmZlcmVudCBzdGF0aXN0aWNhbCBhcHByb2FjaGVzIHRvIGRldGVybWluZSBpZiBhCiAgZmluZGluZyBoYXMgYmVlbiByZXBsaWNhdGVkLiBUaGUgcHVycG9zZSBvZiB0aGlzIGFydGljbGUgaXMgdG8gcHJvdmlkZSBzZXZlcmFsCiAgYWx0ZXJuYXRpdmUgY29uY2VwdHVhbCBmcmFtZXdvcmtzIHRoYXQgbGVhZCB0byBkaWZmZXJlbnQgc3RhdGlzdGljYWwgYW5hbHlzZXMKICB0byB0ZXN0IGh5cG90aGVzZXMgYWJvdXQgcmVwbGljYXRpb24uIEFsbCBvZiB0aGVzZSBhbmFseXNlcyBhcmUgYmFzZWQgb24KICBzdGF0aXN0aWNhbCBtZXRob2RzIHVzZWQgaW4gbWV0YS1hbmFseXNpcy4gVGhlIGRpZmZlcmVuY2VzIGFtb25nIHRoZSBtZXRob2RzCiAgZGVzY3JpYmVkIGludm9sdmUgd2hldGhlciB0aGUgYnVyZGVuIG9mIHByb29mIGlzIHBsYWNlZCBvbiByZXBsaWNhdGlvbiBvcgogIG5vbnJlcGxpY2F0aW9uLCB3aGV0aGVyIHJlcGxpY2F0aW9uIGlzIGV4YWN0IG9yIGFsbG93cyBmb3IgYSBzbWFsbCBhbW91bnQgb2YKICAibmVnbGlnaWJsZSBoZXRlcm9nZW5laXR5LCIgYW5kIHdoZXRoZXIgdGhlIHN0dWRpZXMgb2JzZXJ2ZWQgYXJlIGFzc3VtZWQgdG8gYmUKICBmaXhlZCAoY29uc3RpdHV0aW5nIHRoZSBlbnRpcmUgYm9keSBvZiByZWxldmFudCBldmlkZW5jZSkgb3IgYXJlIGEgc2FtcGxlIGZyb20KICBhIHVuaXZlcnNlIG9mIHBvc3NpYmx5IHJlbGV2YW50IHN0dWRpZXMuIFRoZSBzdGF0aXN0aWNhbCBwb3dlciBvZiBlYWNoIG9mCiAgdGhlc2UgdGVzdHMgaXMgY29tcHV0ZWQgYW5kIHNob3duIHRvIGJlIGxvdyBpbiBtYW55IGNhc2VzLCByYWlzaW5nIGlzc3VlcyBvZgogIHRoZSBpbnRlcnByZXRhYmlsaXR5IG9mIHRlc3RzIGZvciByZXBsaWNhdGlvbi4gKFBzeWNJTkZPIERhdGFiYXNlIFJlY29yZCAoYykKICAyMDE5IEFQQSwgYWxsIHJpZ2h0cyByZXNlcnZlZCkufSwKICB1cmwgPSB7aHR0cDovL2R4LmRvaS5vcmcvMTAuMTAzNy9tZXQwMDAwMTg5fSwKICBmaWxlID0ge0hlZGdlcyBhbmQgU2NoYXVlciAyMDE5IC0gU3RhdGlzdGljYWwgYW5hbHlzZXMgZm9yIHN0dWR5aW5nIHJlcGxpY2F0aW9uIC0gTWV0YS1hbmFseXRpYyBwZXJzcGVjdGl2ZXMucGRmfSwKICBrZXl3b3JkcyA9IHtyZXBsaWNhYmlsaXR5LWJvb2s7bWV0aG9kc30sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCg==" download="refs_to_download.bib"> Download .bib file</a></button>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Anderson2024-cx" class="csl-entry" role="listitem">
Anderson, S. F., &amp; Kelley, K. (2024). Sample size planning for
replication studies: The devil is in the design. <em>Psychological
Methods</em>, <em>29</em>, 844–867. <a href="https://doi.org/10.1037/met0000520">https://doi.org/10.1037/met0000520</a>
</div>
<div id="ref-Barba2018-ef" class="csl-entry" role="listitem">
Barba, L. A. (2018). Terminologies for reproducible research. <em>arXiv
[Cs.DL]</em>, arXiv:1802.03311. <a href="http://arxiv.org/abs/1802.03311">http://arxiv.org/abs/1802.03311</a>
</div>
<div id="ref-Borenstein2009-mo" class="csl-entry" role="listitem">
Borenstein, M., Hedges, L. V., Higgins, J. P. T., &amp; Rothstein, H. R.
(2009). <em>Introduction to <span>Meta-Analysis</span></em>. <a href="https://doi.org/10.1002/9780470743386">https://doi.org/10.1002/9780470743386</a>
</div>
<div id="ref-Brandt2014-da" class="csl-entry" role="listitem">
Brandt, M. J., IJzerman, H., Dijksterhuis, A., Farach, F. J., Geller,
J., Giner-Sorolla, R., Grange, J. A., Perugini, M., Spies, J. R., &amp;
Veer, A. van ’t. (2014). The replication recipe: What makes for a
convincing replication? <em>Journal of Experimental Social
Psychology</em>, <em>50</em>, 217–224. <a href="https://doi.org/10.1016/j.jesp.2013.10.005">https://doi.org/10.1016/j.jesp.2013.10.005</a>
</div>
<div id="ref-Broman2017-mv" class="csl-entry" role="listitem">
Broman, K., Cetinkaya-Rundel, M., Nussbaum, A., Paciorek, C., Peng, R.,
Turek, D., &amp; Wickham, H. (2017, January 18). <em>Recommendations to
funding agencies for supporting reproducible research</em>. <a href="https://www.amstat.org/asa/files/pdfs/POL-ReproducibleResearchRecommendations.pdf">https://www.amstat.org/asa/files/pdfs/POL-ReproducibleResearchRecommendations.pdf</a>
</div>
<div id="ref-Bushman2009-zv" class="csl-entry" role="listitem">
Bushman, B. J., &amp; Wang, M. C. (2009). Vote-counting procedures in
meta-analysis. In <em><em>The handbook of research synthesis and
meta-analysis</em></em> (pp. 207–220). Russell Sage Foundation.
</div>
<div id="ref-Clark2015-pz" class="csl-entry" role="listitem">
Clark, T. S., &amp; Linzer, D. A. (2015). Should i use fixed or random
effects? <em>Political Science Research and Methods</em>, <em>3</em>,
399–408. <a href="https://doi.org/10.1017/psrm.2014.32">https://doi.org/10.1017/psrm.2014.32</a>
</div>
<div id="ref-Collaboration2015-ep" class="csl-entry" role="listitem">
Collaboration, O. S., &amp; Open Science Collaboration. (2015).
Estimating the reproducibility of psychological science. In
<em>Science</em> (Vol. 349). <a href="https://doi.org/10.1126/science.aac4716">https://doi.org/10.1126/science.aac4716</a>
</div>
<div id="ref-Crandall2016-xg" class="csl-entry" role="listitem">
Crandall, C. S., &amp; Sherman, J. W. (2016). On the scientific
superiority of conceptual replications for scientific progress.
<em>Journal of Experimental Social Psychology</em>, <em>66</em>, 93–99.
<a href="https://doi.org/10.1016/j.jesp.2015.10.002">https://doi.org/10.1016/j.jesp.2015.10.002</a>
</div>
<div id="ref-Cronbach1982-kl" class="csl-entry" role="listitem">
Cronbach, L. J., &amp; Shapiro, K. (1982). <em>Designing evaluations of
educational and social programs</em>. <a href="https://eduq.info/xmlui/handle/11515/9106">https://eduq.info/xmlui/handle/11515/9106</a>
</div>
<div id="ref-Gelman2014-js" class="csl-entry" role="listitem">
Gelman, A., &amp; Carlin, J. (2014). Beyond power calculations. In
<em>Perspectives on Psychological Science</em> (Vol. 9, pp. 641–651). <a href="https://doi.org/10.1177/1745691614551642">https://doi.org/10.1177/1745691614551642</a>
</div>
<div id="ref-Goeman2010-nm" class="csl-entry" role="listitem">
Goeman, J. J., Solari, A., &amp; Stijnen, T. (2010). Three-sided
hypothesis testing: Simultaneous testing of superiority, equivalence and
inferiority. <em>Statistics in Medicine</em>, <em>29</em>, 2117–2125. <a href="https://doi.org/10.1002/sim.4002">https://doi.org/10.1002/sim.4002</a>
</div>
<div id="ref-Gollwitzer2022-at" class="csl-entry" role="listitem">
Gollwitzer, M., &amp; Schwabe, J. (2022). Context dependency as a
predictor of replicability. <em>Review of General Psychology: Journal of
Division 1, of the American Psychological Association</em>, <em>26</em>,
241–249. <a href="https://doi.org/10.1177/10892680211015635">https://doi.org/10.1177/10892680211015635</a>
</div>
<div id="ref-Goodman2016-yw" class="csl-entry" role="listitem">
Goodman, S. N., Fanelli, D., &amp; Ioannidis, J. P. A. (2016). What does
research reproducibility mean? <em>Science Translational Medicine</em>,
<em>8</em>, 341ps12. <a href="https://doi.org/10.1126/scitranslmed.aaf5027">https://doi.org/10.1126/scitranslmed.aaf5027</a>
</div>
<div id="ref-Harrer2021-go" class="csl-entry" role="listitem">
Harrer, M., Cuijpers, P., Furukawa, T., &amp; Ebert, D. (2021).
<em>Doing meta-analysis with r: A hands-on guide</em> (1st ed.). CRC
Press.
</div>
<div id="ref-Harrington2019-sw" class="csl-entry" role="listitem">
Harrington, D., D’Agostino, R. B., Sr, Gatsonis, C., Hogan, J. W.,
Hunter, D. J., Normand, S.-L. T., Drazen, J. M., &amp; Hamel, M. B.
(2019). New guidelines for statistical reporting in the journal. <em>The
New England Journal of Medicine</em>, <em>381</em>, 285–286. <a href="https://doi.org/10.1056/NEJMe1906559">https://doi.org/10.1056/NEJMe1906559</a>
</div>
<div id="ref-Hedges1989-ip" class="csl-entry" role="listitem">
Hedges, L. V. (1989). An unbiased correction for sampling error in
validity generalization studies. <em>The Journal of Applied
Psychology</em>, <em>74</em>, 469–477. <a href="https://doi.org/10.1037/0021-9010.74.3.469">https://doi.org/10.1037/0021-9010.74.3.469</a>
</div>
<div id="ref-Hedges1980-gd" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Olkin, I. (1980). Vote-counting methods in research
synthesis. <em>Psychological Bulletin</em>, <em>88</em>, 359–369. <a href="https://doi.org/10.1037/0033-2909.88.2.359">https://doi.org/10.1037/0033-2909.88.2.359</a>
</div>
<div id="ref-Hedges2019-pr" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019a). Consistency of effects is
important in replication: Rejoinder to mathur and VanderWeele (2019).
<em>Psychological Methods</em>, <em>24</em>, 576–577. <a href="https://doi.org/10.1037/met0000237">https://doi.org/10.1037/met0000237</a>
</div>
<div id="ref-Hedges2019-ar" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019b). More than one replication
study is needed for unambiguous tests of replication. <em>Journal of
Educational and Behavioral Statistics: A Quarterly Publication Sponsored
by the American Educational Research Association and the American
Statistical Association</em>, <em>44</em>, 543–570. <a href="https://doi.org/10.3102/1076998619852953">https://doi.org/10.3102/1076998619852953</a>
</div>
<div id="ref-Hedges2019-ry" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2019c). Statistical analyses for
studying replication: Meta-analytic perspectives. <em>Psychological
Methods</em>, <em>24</em>, 557–570. <a href="https://doi.org/10.1037/met0000189">https://doi.org/10.1037/met0000189</a>
</div>
<div id="ref-Hedges2021-of" class="csl-entry" role="listitem">
Hedges, L. V., &amp; Schauer, J. M. (2021). The design of replication
studies. <em>Journal of the Royal Statistical Society. Series A,
(Statistics in Society)</em>, <em>184</em>, 868–886. <a href="https://doi.org/10.1111/rssa.12688">https://doi.org/10.1111/rssa.12688</a>
</div>
<div id="ref-Heller2014-lr" class="csl-entry" role="listitem">
Heller, R., Bogomolov, M., &amp; Benjamini, Y. (2014). Deciding whether
follow-up studies have replicated findings in a preliminary large-scale
omics study. <em>Proceedings of the National Academy of Sciences of the
United States of America</em>, <em>111</em>, 16262–16267. <a href="https://doi.org/10.1073/pnas.1314814111">https://doi.org/10.1073/pnas.1314814111</a>
</div>
<div id="ref-Heyard2024-hv" class="csl-entry" role="listitem">
Heyard, R., Pawel, S., Frese, J., Voelkl, B., Würbel, H., McCann, S.,
Held, L., Wever, K. E., Hartmann, H., Townsin, L., &amp; Zellers, S.
(2024). <em>A scoping review on metrics to quantify reproducibility: A
multitude of questions leads to a multitude of metrics</em>. <a href="https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC">https://scholar.google.com/citations?view_op=view_citation&amp;hl=en&amp;citation_for_view=JAb7P1QAAAAJ:ldfaerwXgEUC</a>
</div>
<div id="ref-Higgins2002-fh" class="csl-entry" role="listitem">
Higgins, J. P. T., &amp; Thompson, S. G. (2002). Quantifying
heterogeneity in a meta-analysis. <em>Statistics in Medicine</em>,
<em>21</em>, 1539–1558. <a href="https://doi.org/10.1002/sim.1186">https://doi.org/10.1002/sim.1186</a>
</div>
<div id="ref-Inbar2016-ls" class="csl-entry" role="listitem">
Inbar, Y. (2016). Association between contextual dependence and
replicability in psychology may be spurious. <em>Proceedings of the
National Academy of Sciences of the United States of America</em>,
<em>113</em>, E4933–4. <a href="https://doi.org/10.1073/pnas.1608676113">https://doi.org/10.1073/pnas.1608676113</a>
</div>
<div id="ref-IntHout2016-sz" class="csl-entry" role="listitem">
IntHout, J., Ioannidis, J. P. A., Rovers, M. M., &amp; Goeman, J. J.
(2016). Plea for routinely presenting prediction intervals in
meta-analysis. <em>BMJ Open</em>, <em>6</em>, e010247. <a href="https://doi.org/10.1136/bmjopen-2015-010247">https://doi.org/10.1136/bmjopen-2015-010247</a>
</div>
<div id="ref-Ioannidis2005-em" class="csl-entry" role="listitem">
Ioannidis, J. P. A. (2005). Why most published research findings are
false. <em>PLoS Medicine</em>, <em>2</em>, e124. <a href="https://doi.org/10.1371/journal.pmed.0020124">https://doi.org/10.1371/journal.pmed.0020124</a>
</div>
<div id="ref-Jager2014-nq" class="csl-entry" role="listitem">
Jager, L. R., &amp; Leek, J. T. (2014). An estimate of the science-wise
false discovery rate and application to the top medical literature.
<em>Biostatistics</em>, <em>15</em>, 1–12. <a href="https://academic.oup.com/biostatistics/article-abstract/15/1/1/244509">https://academic.oup.com/biostatistics/article-abstract/15/1/1/244509</a>
</div>
<div id="ref-Jeffreys1973-bp" class="csl-entry" role="listitem">
Jeffreys, H. (1973). <em>Scientific inference</em>. Cambridge University
Press.
</div>
<div id="ref-Kenett2015-jm" class="csl-entry" role="listitem">
Kenett, R. S., &amp; Shmueli, G. (2015). Clarifying the terminology that
describes scientific reproducibility. <em>Nature Methods</em>,
<em>12</em>, 699. <a href="https://doi.org/10.1038/nmeth.3489">https://doi.org/10.1038/nmeth.3489</a>
</div>
<div id="ref-Kruschke2015-ew" class="csl-entry" role="listitem">
Kruschke, J. K. (2015). Bayesian approaches to testing a point
(<span>“null”</span>) hypothesis. In <em>Doing bayesian data
analysis</em> (pp. 335–358). Elsevier. <a href="https://doi.org/10.1016/b978-0-12-405888-0.00012-x">https://doi.org/10.1016/b978-0-12-405888-0.00012-x</a>
</div>
<div id="ref-Kruschke2018-sm" class="csl-entry" role="listitem">
Kruschke, J. K., &amp; Liddell, T. M. (2018). The bayesian new
statistics: Hypothesis testing, estimation, meta-analysis, and power
analysis from a bayesian perspective. <em>Psychonomic Bulletin &amp;
Review</em>, <em>25</em>, 178–206. <a href="https://doi.org/10.3758/s13423-016-1221-4">https://doi.org/10.3758/s13423-016-1221-4</a>
</div>
<div id="ref-Lakens2018-ri" class="csl-entry" role="listitem">
Lakens, D., Scheel, A. M., &amp; Isager, P. M. (2018). Equivalence
testing for psychological research: A tutorial. <em>Advances in Methods
and Practices in Psychological Science</em>, <em>1</em>, 259–269. <a href="https://doi.org/10.1177/2515245918770963">https://doi.org/10.1177/2515245918770963</a>
</div>
<div id="ref-Lindley1972-fa" class="csl-entry" role="listitem">
Lindley, D. V. (1972). Bayesian statistics a review. In <em>Bayesian
statistics</em> (pp. 1–74). <a href="https://doi.org/10.1137/1.9781611970654.ch1">https://doi.org/10.1137/1.9781611970654.ch1</a>
</div>
<div id="ref-Ly2019-ow" class="csl-entry" role="listitem">
Ly, A., Etz, A., Marsman, M., &amp; Wagenmakers, E.-J. (2019).
Replication bayes factors from evidence updating. <em>Behavior Research
Methods</em>, <em>51</em>, 2498–2508. <a href="https://doi.org/10.3758/s13428-018-1092-x">https://doi.org/10.3758/s13428-018-1092-x</a>
</div>
<div id="ref-Machery2020-sv" class="csl-entry" role="listitem">
Machery, E. (2020). What is a replication? <em>Philosophy of
Science</em>, <em>87</em>, 545–567. <a href="https://doi.org/10.1086/709701">https://doi.org/10.1086/709701</a>
</div>
<div id="ref-Mathur2019-vh" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2019). Challenges and
suggestions for defining replication "success" when effects may be
heterogeneous: Comment on hedges and schauer (2019). <em>Psychological
Methods</em>, <em>24</em>, 571–575. <a href="https://doi.org/10.1037/met0000223">https://doi.org/10.1037/met0000223</a>
</div>
<div id="ref-Mathur2020-nw" class="csl-entry" role="listitem">
Mathur, M. B., &amp; VanderWeele, T. J. (2020). New statistical metrics
for multisite replication projects. <em>Journal of the Royal Statistical
Society. Series A, (Statistics in Society)</em>, <em>183</em>,
1145–1166. <a href="https://doi.org/10.1111/rssa.12572">https://doi.org/10.1111/rssa.12572</a>
</div>
<div id="ref-Miller2009-hp" class="csl-entry" role="listitem">
Miller, J. (2009). What is the probability of replicating a
statistically significant effect? <em>Psychonomic Bulletin &amp;
Review</em>, <em>16</em>, 617–640. <a href="https://doi.org/10.3758/PBR.16.4.617">https://doi.org/10.3758/PBR.16.4.617</a>
</div>
<div id="ref-National-Academies-of-Sciences-Engineering-and-Medicine2019-ze" class="csl-entry" role="listitem">
National Academies of Sciences, Engineering, and Medicine, Policy and
Global Affairs, Committee on Science, Engineering, Medicine, and Public
Policy, Board on Research Data and Information, Division on Engineering
and Physical Sciences, Committee on Applied and Theoretical Statistics,
Board on Mathematical Sciences and Analytics, Division on Earth and Life
Studies, Nuclear and Radiation Studies Board, &amp; Division of
Behavioral and Social Sciences and Education. (2019).
<em>Reproducibility and replicability in science</em>. National
Academies Press. <a href="https://doi.org/10.17226/25303">https://doi.org/10.17226/25303</a>
</div>
<div id="ref-Nosek2017-an" class="csl-entry" role="listitem">
Nosek, B. A., &amp; Errington, T. M. (2017). Making sense of
replications. <em>eLife</em>, <em>6</em>, e23383. <a href="https://doi.org/10.7554/eLife.23383">https://doi.org/10.7554/eLife.23383</a>
</div>
<div id="ref-Nosek2020-vh" class="csl-entry" role="listitem">
Nosek, B. A., &amp; Errington, T. M. (2020). What is replication?
<em>PLoS Biology</em>, <em>18</em>, e3000691. <a href="https://doi.org/10.1371/journal.pbio.3000691">https://doi.org/10.1371/journal.pbio.3000691</a>
</div>
<div id="ref-Parmigiani2023-sg" class="csl-entry" role="listitem">
Parmigiani, G. (2023). Defining replicability of prediction rules.
<em>Statistical Science: A Review Journal of the Institute of
Mathematical Statistics</em>, <em>38</em>. <a href="https://doi.org/10.1214/23-sts891">https://doi.org/10.1214/23-sts891</a>
</div>
<div id="ref-Patil2016-vc" class="csl-entry" role="listitem">
Patil, P., Peng, R. D., &amp; Leek, J. T. (2016). What should
researchers expect when they replicate studies? A statistical view of
replicability in psychological science. <em>Perspectives on
Psychological Science: A Journal of the Association for Psychological
Science</em>, <em>11</em>, 539–544. <a href="https://doi.org/10.1177/1745691616646366">https://doi.org/10.1177/1745691616646366</a>
</div>
<div id="ref-Pawel2020-cm" class="csl-entry" role="listitem">
Pawel, S., &amp; Held, L. (2020). Probabilistic forecasting of
replication studies. <em>PloS One</em>, <em>15</em>, e0231416. <a href="https://doi.org/10.1371/journal.pone.0231416">https://doi.org/10.1371/journal.pone.0231416</a>
</div>
<div id="ref-Perugini2014-bx" class="csl-entry" role="listitem">
Perugini, M., Gallucci, M., &amp; Costantini, G. (2014). Safeguard power
as a protection against imprecise power estimates. <em>Perspectives on
Psychological Science: A Journal of the Association for Psychological
Science</em>, <em>9</em>, 319–332. <a href="https://doi.org/10.1177/1745691614528519">https://doi.org/10.1177/1745691614528519</a>
</div>
<div id="ref-Riley2011-hp" class="csl-entry" role="listitem">
Riley, R. D., Higgins, J. P. T., &amp; Deeks, J. J. (2011).
Interpretation of random effects meta-analyses. <em>BMJ</em>,
<em>342</em>, d549. <a href="https://doi.org/10.1136/bmj.d549">https://doi.org/10.1136/bmj.d549</a>
</div>
<div id="ref-Rosenthal1990-cq" class="csl-entry" role="listitem">
Rosenthal, R. (1990). Replication in behavioral research. <em>Journal of
Social Behavior and Personality</em>. <a href="https://search.proquest.com/openview/5ccc3a267139968c18c0d7ce1a1c09f6/1?pq-origsite=gscholar&amp;cbl=1819046">https://search.proquest.com/openview/5ccc3a267139968c18c0d7ce1a1c09f6/1?pq-origsite=gscholar&amp;cbl=1819046</a>
</div>
<div id="ref-Rouder2009-jh" class="csl-entry" role="listitem">
Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G.
(2009). Bayesian t tests for accepting and rejecting the null
hypothesis. <em>Psychonomic Bulletin &amp; Review</em>, <em>16</em>,
225–237. <a href="https://doi.org/10.3758/PBR.16.2.225">https://doi.org/10.3758/PBR.16.2.225</a>
</div>
<div id="ref-Schauer2022-mj" class="csl-entry" role="listitem">
Schauer, J. M. (2022). Replicability and meta-analysis. In W. O’Donohue,
A. Masuda, &amp; S. Lilienfeld (Eds.), <em>Avoiding questionable
research practices in applied psychology</em> (pp. 301–342). Springer
International Publishing. <a href="https://doi.org/10.1007/978-3-031-04968-2_14">https://doi.org/10.1007/978-3-031-04968-2_14</a>
</div>
<div id="ref-Schauer2020-tw" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2020). Assessing heterogeneity and
power in replications of psychological experiments. <em>Psychological
Bulletin</em>, <em>146</em>, 701–719. <a href="https://doi.org/10.1037/bul0000232">https://doi.org/10.1037/bul0000232</a>
</div>
<div id="ref-Schauer2021-ja" class="csl-entry" role="listitem">
Schauer, J. M., &amp; Hedges, L. V. (2021). Reconsidering statistical
methods for assessing replication. <em>Psychological Methods</em>,
<em>26</em>, 127–139. <a href="https://doi.org/10.1037/met0000302">https://doi.org/10.1037/met0000302</a>
</div>
<div id="ref-Schmidt2014-kw" class="csl-entry" role="listitem">
Schmidt, F. L., &amp; Hunter, J. E. (2014). <em>Methods of
meta-analysis: Correcting error and bias in research findings</em> (3rd
ed.). SAGE Publications. <a href="https://doi.org/10.4135/9781483398105">https://doi.org/10.4135/9781483398105</a>
</div>
<div id="ref-Schmidt2009-mq" class="csl-entry" role="listitem">
Schmidt, S. (2009). Shall we really do it again? The powerful concept of
replication is neglected in the social sciences. <em>Review of General
Psychology: Journal of Division 1, of the American Psychological
Association</em>, <em>13</em>, 90–100. <a href="https://doi.org/10.1037/a0015108">https://doi.org/10.1037/a0015108</a>
</div>
<div id="ref-Simons2014-cg" class="csl-entry" role="listitem">
Simons, D. J. (2014). The value of direct replication. <em>Perspectives
on Psychological Science: A Journal of the Association for Psychological
Science</em>, <em>9</em>, 76–80. <a href="https://doi.org/10.1177/1745691613514755">https://doi.org/10.1177/1745691613514755</a>
</div>
<div id="ref-Simonsohn2015-kg" class="csl-entry" role="listitem">
Simonsohn, U. (2015). Small telescopes: Detectability and the evaluation
of replication results: Detectability and the evaluation of replication
results. <em>Psychological Science</em>, <em>26</em>, 559–569. <a href="https://doi.org/10.1177/0956797614567341">https://doi.org/10.1177/0956797614567341</a>
</div>
<div id="ref-Spence2016-tz" class="csl-entry" role="listitem">
Spence, J. R., &amp; Stanley, D. J. (2016). Prediction interval: What to
expect when you’re expecting … a replication. <em>PloS One</em>,
<em>11</em>, e0162874. <a href="https://doi.org/10.1371/journal.pone.0162874">https://doi.org/10.1371/journal.pone.0162874</a>
</div>
<div id="ref-Stan_Development_Team2021-zw" class="csl-entry" role="listitem">
Stan Development Team. (2021). <em>Stan: A c++ library for probability
and sampling, version 2.26.0</em>. <a href="https://mc-stan.org/">https://mc-stan.org/</a>
</div>
<div id="ref-Steegen2016-lz" class="csl-entry" role="listitem">
Steegen, S., Tuerlinckx, F., Gelman, A., &amp; Vanpaemel, W. (2016).
Increasing transparency through a multiverse analysis. <em>Perspectives
on Psychological Science: A Journal of the Association for Psychological
Science</em>, <em>11</em>, 702–712. <a href="https://doi.org/10.1177/1745691616658637">https://doi.org/10.1177/1745691616658637</a>
</div>
<div id="ref-Steiger2004-wg" class="csl-entry" role="listitem">
Steiger, J. H. (2004). Beyond the f test: Effect size confidence
intervals and tests of close fit in the analysis of variance and
contrast analysis. <em>Psychological Methods</em>, <em>9</em>, 164–182.
<a href="https://doi.org/10.1037/1082-989X.9.2.164">https://doi.org/10.1037/1082-989X.9.2.164</a>
</div>
<div id="ref-Tal2020-ln" class="csl-entry" role="listitem">
Tal, E. (2020). <em>Measurement in science</em>. Metaphysics Research
Lab, Stanford University. <a href="https://plato.stanford.edu/archives/fall2020/entries/measurement-science/">https://plato.stanford.edu/archives/fall2020/entries/measurement-science/</a>
</div>
<div id="ref-Ulrich2020-rk" class="csl-entry" role="listitem">
Ulrich, R., &amp; Miller, J. (2020). Questionable research practices may
have little effect on replicability. <em>eLife</em>, <em>9</em>, e58237.
<a href="https://doi.org/10.7554/eLife.58237">https://doi.org/10.7554/eLife.58237</a>
</div>
<div id="ref-Valentine2011-yq" class="csl-entry" role="listitem">
Valentine, J. C., Biglan, A., Boruch, R. F., Castro, F. G., Collins, L.
M., Flay, B. R., Kellam, S., Mościcki, E. K., &amp; Schinke, S. P.
(2011). Replication in prevention science. <em>Prevention Science: The
Official Journal of the Society for Prevention Research</em>,
<em>12</em>, 103–117. <a href="https://doi.org/10.1007/s11121-011-0217-6">https://doi.org/10.1007/s11121-011-0217-6</a>
</div>
<div id="ref-Van-Bavel2016-eb" class="csl-entry" role="listitem">
Van Bavel, J. J., Mende-Siedlecki, P., Brady, W. J., &amp; Reinero, D.
A. (2016). Contextual sensitivity in scientific reproducibility.
<em>Proceedings of the National Academy of Sciences of the United States
of America</em>, <em>113</em>, 6454–6459. <a href="https://doi.org/10.1073/pnas.1521897113">https://doi.org/10.1073/pnas.1521897113</a>
</div>
<div id="ref-Verhagen2014-tx" class="csl-entry" role="listitem">
Verhagen, J., &amp; Wagenmakers, E.-J. (2014). Bayesian tests to
quantify the result of a replication attempt. <em>Journal of
Experimental Psychology. General</em>, <em>143</em>, 1457–1475. <a href="https://doi.org/10.1037/a0036731">https://doi.org/10.1037/a0036731</a>
</div>
<div id="ref-Veroniki2016-nw" class="csl-entry" role="listitem">
Veroniki, A. A., Jackson, D., Viechtbauer, W., Bender, R., Bowden, J.,
Knapp, G., Kuss, O., Higgins, J. P. T., Langan, D., &amp; Salanti, G.
(2016). Methods to estimate the between-study variance and its
uncertainty in meta-analysis. <em>Research Synthesis Methods</em>,
<em>7</em>, 55–79. <a href="https://doi.org/10.1002/jrsm.1164">https://doi.org/10.1002/jrsm.1164</a>
</div>
<div id="ref-Viechtbauer2005-zt" class="csl-entry" role="listitem">
Viechtbauer, W. (2005). Bias and efficiency of meta-analytic variance
estimators in the random-effects model. <em>Journal of Educational and
Behavioral Statistics: A Quarterly Publication Sponsored by the American
Educational Research Association and the American Statistical
Association</em>, <em>30</em>, 261–293. <a href="https://doi.org/10.3102/10769986030003261">https://doi.org/10.3102/10769986030003261</a>
</div>
<div id="ref-Wagenmakers2010-fj" class="csl-entry" role="listitem">
Wagenmakers, E.-J., Lodewyckx, T., Kuriyal, H., &amp; Grasman, R.
(2010). Bayesian hypothesis testing for psychologists: A tutorial on the
savage–dickey method. <em>Cognitive Psychology</em>, <em>60</em>,
158–189. <a href="https://doi.org/10.1016/j.cogpsych.2009.12.001">https://doi.org/10.1016/j.cogpsych.2009.12.001</a>
</div>
<div id="ref-Wasserstein2016-xv" class="csl-entry" role="listitem">
Wasserstein, R. L., &amp; Lazar, N. A. (2016). The ASA statement on
p-values: Context, process, and purpose. <em>The American
Statistician</em>, <em>70</em>, 129–133. <a href="https://doi.org/10.1080/00031305.2016.1154108">https://doi.org/10.1080/00031305.2016.1154108</a>
</div>
<div id="ref-Williams2018-wu" class="csl-entry" role="listitem">
Williams, D. R., Rast, P., &amp; Bürkner, P.-. C. (2018). Bayesian
meta-analysis with weakly informative prior distributions.
<em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/7tbrm">https://doi.org/10.31234/osf.io/7tbrm</a>
</div>
<div id="ref-Wilson2018-aa" class="csl-entry" role="listitem">
Wilson, B. M., &amp; Wixted, J. T. (2018). The prior odds of testing a
true effect in cognitive and social psychology. <em>Advances in Methods
and Practices in Psychological Science</em>, <em>1</em>, 186–197. <a href="https://doi.org/10.1177/2515245918767122">https://doi.org/10.1177/2515245918767122</a>
</div>
<div id="ref-Yarkoni2020-xf" class="csl-entry" role="listitem">
Yarkoni, T. (2020). The generalizability crisis. <em>The Behavioral and
Brain Sciences</em>, <em>45</em>, e1. <a href="https://doi.org/10.1017/S0140525X20001685">https://doi.org/10.1017/S0140525X20001685</a>
</div>
</div>


</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>There is a confusion about the <em>fixed-effects</em> vs <em>fixed-effect</em> (no <em>s</em>) and <em>equal-effects</em> models. See <a href="https://wviechtb.github.io/metafor/reference/misc-models.html">https://wviechtb.github.io/metafor/reference/misc-models.html</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The <code><a href="https://filippogambarota.github.io/filor/reference/compare_rma.html">filor::compare_rma()</a></code> function is similar to the <code><a href="https://rdrr.io/pkg/car/man/compareCoefs.html">car::compareCoefs()</a></code> function<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>See <span class="citation" data-cites="Harrer2021-go">Harrer et al. (<a href="chapter5.html#ref-Harrer2021-go" role="doc-biblioref">2021</a>)</span> (Chapter 5) and <span class="citation" data-cites="Hedges2019-ry">Hedges &amp; Schauer (<a href="chapter5.html#ref-Hedges2019-ry" role="doc-biblioref">2019</a>)</span> for an overview about the Q statistics<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>see <a href="https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf">https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Notice that the equation, in particular the usage of <span class="math inline">\(t\)</span> vs <span class="math inline">\(z\)</span> depends on assuming <span class="math inline">\(s_x\)</span> to be known or estimated. See <a href="https://online.stat.psu.edu/stat501/lesson/3/3.3">https://online.stat.psu.edu/stat501/lesson/3/3.3</a>, <a href="https://en.wikipedia.org/wiki/Prediction_interval">https://en.wikipedia.org/wiki/Prediction_interval</a> and <a href="https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/">https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>When a <span class="math inline">\(t\)</span> distribution is assumed, the quantiles are calculated using <span class="math inline">\(k - 2\)</span> degrees of freedom<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/chapter4.html" class="pagination-link" aria-label="Statistical methods for replication assessment">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical methods for replication assessment</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter6.html" class="pagination-link" aria-label="Improving study robustness">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Improving study robustness</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>